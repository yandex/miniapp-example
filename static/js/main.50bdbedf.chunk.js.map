{"version":3,"sources":["redux/helpers/persist.ts","lib/error.ts","components/Skeletons/index.tsx","lib/request.ts","lib/api/index.ts","lib/js-api/auth.ts","lib/oauth.ts","redux/slices/user.ts","screens/EventScreen/Skeleton/styles.module.css","redux/slices/event.ts","lib/metrika/index.ts","components/PageHeader/styles.module.css","lib/payment.ts","lib/metrika/event.ts","lib/js-api/push.ts","lib/checkout/index.ts","redux/slices/order.ts","lib/url-builder.ts","lib/lazy.ts","lib/js-api/utils.ts","components/StackNavigator/Screen/styles.module.css","screens/OrdersScreen/Order/Skeleton/styles.module.css","components/MenuModal/style.module.css","components/CityChange/styles.module.css","redux/slices/menu.ts","redux/actions.ts","components/EventCard/style.module.css","components/EventsList/Skeleton/index.tsx","lib/is-ios.ts","components/PageHeader/index.tsx","components/MenuNavigation/style.module.css","screens/EventScreen/components/EventsFeed/Skeleton/styles.module.css","components/StackNavigator/hooks.ts","redux/slices/selections.ts","components/StackNavigator/context.ts","components/EventCard/Skeleton/styles.module.css","components/CitySelect/styles.module.css","components/ClearButton/index.tsx","lib/js-api/metrika.ts","lib/metrika/ecommerce.ts","components/EventsList/constants.ts","components/EventCardVertical/Skeleton/styles.module.css","components/Image/styles.module.css","screens/SearchScreen/PopularResult/styles.module.css","components/Image/index.tsx","components/EventCard/Skeleton/index.tsx","components/StackNavigator/Screen/index.tsx","components/StackNavigator/StackNavigator.tsx","components/StackNavigator/index.tsx","redux/slices/actual-events.ts","redux/slices/rubric-events.ts","redux/slices/selection-events.ts","redux/slices/recommended-events.ts","components/TextInput/index.tsx","lib/geolocation.ts","components/BackwardButton/index.tsx","components/BackwardButton/styles.module.css","screens/MainScreen/Skeleton/styles.module.css","components/AuthBox/styles.module.css","components/Skeletons/styles.module.css","components/DateFilter/Skeleton/styles.module.css","components/SelectionList/Skeleton/styles.module.css","screens/SelectionScreen/Skeleton/styles.module.css","components/EventsList/style.module.css","components/PriceLabel/styles.module.css","screens/SearchScreen/SearchResult/styles.module.css","screens/SearchScreen/PopularResult/Skeleton/styles.module.css","screens/SearchScreen/styles.module.css","components/LoginButton/styles.module.css","components/MenuGeoLabel/styles.module.css","components/Checkbox/styles.module.css","components/ActionButton/styles.module.css","components/CityModal/styles.module.css","hooks/useMetrikaHit.ts","redux/slices/date-filter.ts","lib/date.ts","hooks/useInfiniteScroll.ts","hooks/useVisible.ts","components/EventsList/index.tsx","hooks/usePaginatedList.ts","components/EventCard/index.tsx","components/PriceLabel/index.tsx","components/TicketPrice/index.tsx","components/ActionButton/index.tsx","components/EventCardMain/Skeleton/index.tsx","components/SelectionList/Skeleton/index.tsx","lib/price.ts","lib/js-api/autofill.ts","lib/autofill.ts","redux/slices/autofill.ts","components/EventCardVertical/Skeleton/index.tsx","screens/EventScreen/components/EventsFeed/Skeleton/index.tsx","screens/EventScreen/components/RecommendedEvents/Skeleton/index.tsx","components/ClearButton/styles.module.css","components/EventsList/Skeleton/styles.module.css","components/EventCardMain/Skeleton/styles.module.css","components/TextInput/styles.module.css","screens/SearchScreen/Input/styles.module.css","screens/SearchScreen/SearchResult/Skeleton/styles.module.css","redux/slices/city.ts","redux/slices/city-list.ts","redux/slices/search.ts","redux/index.ts","components/DateFilter/Skeleton/index.tsx","screens/MainScreen/Skeleton/index.tsx","screens/MainScreen/index.tsx","screens/EventScreen/Skeleton/index.tsx","screens/EventScreen/index.tsx","screens/SelectionScreen/Skeleton/index.tsx","screens/RubricScreen/index.tsx","screens/SelectionScreen/index.tsx","screens/SearchScreen/Input/index.tsx","screens/SearchScreen/SearchResult/Skeleton/index.tsx","screens/SearchScreen/SearchResult/index.tsx","hooks/useThrottleLoading.ts","screens/SearchScreen/PopularResult/Skeleton/index.tsx","screens/SearchScreen/PopularResult/index.tsx","screens/SearchScreen/index.tsx","screens/OrdersScreen/Order/Skeleton/index.tsx","screens/OrdersScreen/Skeleton/index.tsx","screens/OrdersScreen/index.tsx","components/MenuNavigation/index.tsx","components/LoginButton/index.tsx","components/AuthBox/index.tsx","components/MenuGeoLabel/index.tsx","components/MenuModal/index.tsx","components/Checkbox/index.tsx","components/CityChange/index.tsx","components/CitySelect/index.tsx","components/CityModal/index.tsx","hooks/usePrevious.ts","App.tsx","hooks/useWatchAuth.ts","PolyfillApp.tsx","index.tsx"],"names":["createPersistKeyByFilter","filter","JSON","stringify","Object","keys","sort","restoreFilterFromPersistKey","key","parse","stateReconcilerByDate","inboundState","today","Date","setHours","nowTime","getTime","reduce","result","inboundResult","inboundKey","date","keyTime","getPersistConfig","options","storage","createIdbStorage","name","storeName","serialize","deserialize","version","migrate","persistedState","currentVersion","migratedState","_persist","undefined","Promise","resolve","timeout","getTransformUIPersistance","defaultUIState","createTransform","state","AppErrorCode","AppError","code","message","Error","Rect","className","width","height","mix","styles","rect","style","Text","size","text","classNames","Boolean","join","defaultRetryOptions","retryCount","retryDelay","queryParams","params","URLSearchParams","entries","forEach","value","Array","isArray","valueItem","append","toString","fetchRetry","url","init","a","retryOptions","attempt","Math","max","fetch","setTimeout","reject","request","response","ok","json","get","host","path","query","post","method","headers","MOSCOW","geoid","longitude","latitude","API_HOST","process","PAYMENT_API_HOST","fetchEvent","id","fetchRubricEvents","tag","fetchActualEvents","fetchSelections","fetchCityInfo","fetchCityList","cityList","citiesWithDistance","cities","map","city","distance","getDistanceBetweenPoints","minDistance","Infinity","nearestCity","restCity","eventsMenu","cityInfo","fetchSelectionEvents","fetchSuggest","signal","fetchRecommendedEvents","buildHeaders","authOptions","jwtToken","oauthToken","Authorization","createOrder","orderData","body","saveUserInfo","orderUserInfo","fetchOrdersHistory","fetchUserInfo","YandexAuthErrorName","YandexAuthScope","OauthErrorCodes","CLIENT_ID","identify","callJsApi","args","scope","window","yandex","app","auth","NotLoggedIn","JsApiCancelled","authorize","scopes","AuthorizationDenied","JsApiDenied","AuthorizationCancelled","includes","getCurrentUserId","parsedOauthToken","location","hash","slice","token","error","errorDescription","URL","href","history","replaceState","document","title","getOauthToken","withError","errorReason","decodeURIComponent","AccessDenied","OauthAccessDenied","UnauthorizedClient","OauthUnauthorizedClient","redirectToOauthAuthorize","search","origin","pathname","initialState","persist","currentUser","nonpersist","user","createSlice","reducers","authenticated","action","payload","psuid","loggedOutPsuid","isSessionLoggedOut","authorized","logout","extraReducers","builder","addCase","cleanup","actions","oauthTokenSelector","isSessionLoggedOutSelector","userSelector","psuidSelector","isAuthorizedSelector","uid","authOptionsSelector","createSelector","isAuthenticatedSelector","SCOPES","Avatar","Info","Email","oauthUpdateUserAndOrders","dispatch","fetchOrders","userInfo","console","alert","authenticate","afterLogin","getState","jsApiIdentify","psuidInfo","JsApiMethodNotAvailable","warn","jsApiAuthorize","login","checkUser","oldPsuid","oldOauthToken","persistConfig","whitelist","persistReducer","reducer","module","exports","data","ui","fetchStart","event","schedule","updatedAt","isLoading","isUpdating","fetchSuccess","scheduleInfo","now","fetchError","setEvents","events","eventPageSelector","loadEvent","transforms","MetrikaGoals","initialOptions","defer","clickmap","trackLinks","trackHash","accurateTrackBounce","ecommerce","initMetrika","dataLayer","ym","hit","reachGoal","processNativePayment","orderInfo","paymentToken","cost","userEmail","email","yandexMethodData","supportedMethods","details","total","label","amount","currency","PaymentRequest","canMakePayment","show","complete","JsApiAlreadyShown","buildMetrikaOrderParams","order_id","price","price_without_discount","logOrderInitiated","metrikaParams","OrderInitiated","reportGoalReached","logOrderCompleted","OrderCompleted","logOrderError","OrderError","getPushTokenForTransaction","push","PaymentOption","ShippingOption","PUBLIC_URL","DEFAULT_SHIPPING_ID","Courier","CHECKOUT_SEARCH_POSITIVE_PARAMS","Set","isCheckoutRequestAvailable","checkoutSearchParam","checkoutSearchParamCached","localStorage","getItem","checkoutParam","isCheckoutEnable","has","isCheckoutAvailable","YandexCheckoutRequest","setItem","getShippingOption","shippingOptionId","Mail","datetimeEstimate","getSelectedShippingAddress","orderId","checkoutState","order","orders","find","shippingAddress","getSelectedShippingOption","selectedShippingOptionId","shippingOption","getCheckoutTotalAmount","eventTickets","tickets","eventValue","min","deliveryValue","totalAmount","isOnlineExternalPaymentsAvailable","getCheckoutPaymentOptions","yandexPaymentsData","checkoutPaymentOptions","type","OfflineCash","OfflineCard","YandexPayments","OnlineExternalPayments","paymentFormUrl","getCheckoutDetails","defaultShippingOptionId","eventTitle","eventImage","image","touchPrimary","paymentOptions","shippingOptions","selected","requestCity","requestShippingAddress","cartItems","count","payerDetails","require","getCheckoutRequest","checkoutDetails","checkoutOptions","shopName","shopIcon","createCheckoutRequest","err","isTypeError","isOnlineExternalPaymentsValidationError","orderCreationStart","isCheckoutInProgress","isOrderCreationInProgress","orderCreationSuccess","activeOrder","orderCreationEnd","paymentStart","isPaymentInProgress","paymentEnd","checkoutEnd","paymentInProgressSelector","checkoutInProgressSelector","orderCreationInProgressSelector","activeOrderSelector","ordersSelector","orderEventIdsSelector","payments","from","ordersLoadingSelector","orderEventIds","orderUi","eventsUi","isEventLoading","some","onOrderCreated","retry","buyTicketByCheckout","createOrderAPI","eventId","status","buyTicket","logProductAdd","processPayment","logProductPurchase","nanoid","checkoutRequest","addEventListener","checkoutEvent","updateWith","getCheckoutUpdateDetails","deliveryId","validationErrors","rawAddress","address","phone","fetchPushToken","pushToken","paymentId","saveUserInfoAPI","getMainPageUrl","getEventUrl","getRubricUrl","encodeURIComponent","getSelectionUrl","getSearchUrl","getOrdersUrl","lazyDeferred","importCallback","lazy","all","then","func","apply","menu","visible","items","activeItem","setItems","setVisible","createAction","EventsListSkeleton","itemsGap","DEFAULT_ITEMS_GAP","Card","card","gridGap","fill","_","index","isIOS","test","navigator","platform","userAgent","maxTouchPoints","MSStream","Logo","to","logo","SuggestIcon","setMods","mods","memo","props","hasMenu","hasLogo","backward","useHistory","useDispatch","onSearchClick","useCallback","onMenuClick","setMenuVisible","onClick","useBackward","onBackward","useContext","StackNavigatorContext","useMemo","bind","useScreenVisible","isVisible","useScreenRef","ref","length","selections","selection","eventPreview","selectionsSelector","persistKey","currentCity","dateFilter","selectionsUISelector","loadSelections","stateReconciler","createContext","createRef","ClearButton","children","cls","clear","goal","getProductFromEvent","category","getEventCurrency","toUpperCase","logProductView","currencyCode","detail","products","add","purchase","actionField","Image","color","bgColor","useState","isLoaded","setLoaded","onLoad","src","stubClassNames","stub","containerClassNames","container","srcSet","src2x","alt","backgroundColor","EventCardSkeleton","right","description","Screen","transitions","screen","hidden","useRef","context","Provider","component","enter","screenEnter","enterActive","screenEnterActive","exit","screenExit","exitActive","screenExitActive","transitionCallbacks","onEnter","node","previousElementSibling","classList","offset","onExit","remove","transitionTimeouts","StackNavigator","screens","maxDepth","stack","setStack","useLocation","iOS","callback","useEffect","useLocationChange","scrollTo","isBackward","isReplace","match","item","matchPath","newStackItem","newStack","splice","fallback","goBack","replace","TransitionGroup","CSSTransition","createStackNavigator","scrollRestoration","actualEventsSelector","actualEvents","actualEventsUISelector","loadActualEvents","prefetchItems","paging","hasMoreItems","isLoadingMore","fetchMoreStart","fetchMoreSuccess","fetchMoreError","rubricEventsSelector","rubricEvents","rubricEventsUISelector","loadRubricEvents","limit","loadMoreRubricEvents","selectionsFetchSuccess","eventsKey","selectionEventsSelector","selectionEvents","selectionEventsUISelector","loadSelectionEvents","loadMoreSelectionEvents","top","concert","cinema","theatre","recommendedEventsSelector","recommendedEvents","recommendedEventsUISelector","loadRecommendedEvents","TextInput","forwardRef","input","GEOLOCATIONS_OPTIONS","maximumAge","getCurrentPosition","geolocation","position","coords","deg2rad","deg","PI","lat1","lon1","lat2","lon2","tmp","sin","cos","asin","sqrt","BackwardIcon","Backward","useMetrikaHit","dateToString","period","setDate","format","parseDate","useInfiniteScroll","threshold","loadMore","hasMore","needLoadMore","optionsRef","useLayoutEffect","current","observer","IntersectionObserver","entry","isIntersecting","observe","disconnect","useVisible","rootMargin","EventsListLoadable","loadMoreRef","pageSize","setLimit","wrappedLoadMore","usePaginatedList","list","skeleton","EventsListItems","actualEvent","onItemClick","EventsList","argument","ticket","eventListCard","eventListCard2x","preview","annotation","PriceLabel","space","TicketPrice","exact","getCurrencySymbol","ActionButton","disabled","formInvalid","invalid","EventCardMainSkeleton","SelectionListSkeleton","block","currencySymbol","rub","usd","YandexProfileField","getProfileData","profileFields","autofill","autofillReadyPromise","script","createElement","firstScript","getElementsByTagName","async","onload","onerror","parentNode","insertBefore","jsApiGetProfileData","Name","Phone","Address","setAutofilledUser","isAutofilledSelector","autofilledUserSelector","lastName","firstName","middleName","phoneNumber","streetAddress","EventCardVerticalSkeleton","EventsFeedSkeleton","feed","RecommendedEventsSkeleton","useGeolocation","isFetchingLocation","setCity","setGeolocation","locationFetchStart","locationFetchSuccess","locationFetchFailed","loadCityInfoByLocation","showError","setMenuItems","loadCityInfo","cityState","toggleGeolocation","isActive","setLoading","setCityListResult","blacklist","results","groups","popularEvents","fetchPopularStart","fetchPopularSuccess","fetchPopularError","searchStart","searchSuccess","group","documents","doc","object","minPrice","tags","contentRating","userRating","placesTotal","transformSearchDocumentToList","searchError","resetResults","activeRequest","filterGroupsByText","toLowerCase","trim","rest","PERSIST_ACTIONS","PERSIST_CONTSTANS","rootReducer","combineReducers","eventReducer","autofillReducer","actualEventsReducer","rubricEventsReducer","selectionsReducer","selectionEventsReducer","cityReducer","cityListReducer","searchReducer","menuReducer","dateFilterReducer","recommendedReducer","userReducer","orderReducer","store","configureStore","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","persistor","persistStore","DateFilterSkeleton","MainScreenSkeleton","content","Component","MainScreen","useSelector","PageHeader","EventSkeleton","button","gallery","recommended","EventScreen","SelectionScreenSkeleton","RubricScreen","SelectionScreen","SuggestInput","inputRef","setValue","onChange","e","target","focus","defaultValue","placeholder","SearchResultSkeleton","SearchResult","isThrottleLoading","time","setThrottleLoading","newTimerId","clearTimeout","useThrottleLoading","EventCard","notFound","PopularResultSkeleton","showTitle","Index","onLinkClick","i","link","SearchScreen","hasQuery","setHasQuery","onInputChange","throttle","abort","AbortController","suggest","loadSearchResults","onSearchClose","header","BackwardButton","PopularResult","OrderSkeleton","short","OrdersScreenSkeleton","OrdersScreen","eventIds","MenuItem","activeClassName","MenuList","isAuthenticated","LoginButton","onLoginClick","getAvatarImage","avatarId","getAvatarImage2x","AuthBox","isAuthorized","display_name","avatar_id","username","MenuGeoLabel","setCityModalVisibleCallback","onCitySelectLabelClickHandle","wrapper","select","MenuModal","onClose","onModalContentClick","stopPropagation","onLogoutClick","modal","profile","footer","Checkbox","checkbox","CityChange","openCityModal","wasClosed","onSaveClick","onGeolocationChanged","selectedCity","wrapper_loading","checked","CityOption","onCityClick","onCitySelectHandler","CitySelectContent","CitySelect","onCitySelect","suggestedItems","onSuggestChangeHandler","indexOf","CityModal","isModalVisible","setModalVisible","contentRef","previousCity","previousValue","usePrevious","selectCity","setWasClosed","wasClosedModalChange","setWasClosedModalChange","wasClosedModalSelect","setWasClosedModalSelect","visibleModalChange","setVisibleModalChange","visibleModalSelect","setVisibleModalSelect","isChecked","saveCity","useClickAway","Navigator","App","cityModalVisible","setCityModalVisible","overflow","onVisibilityChange","visibilityState","removeEventListener","useWatchAuth","polyfillPromises","PolyfillApp","canRender","setCanRender","ReactDOM","render","loading","getElementById"],"mappings":"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","file":"static/js/main.50bdbedf.chunk.js","sourcesContent":["import { PersistConfig, createTransform } from 'redux-persist';\nimport { StateReconciler } from 'redux-persist/es/types';\nimport { parse } from 'date-fns';\n// @ts-ignore\nimport createIdbStorage from '@piotr-cz/redux-persist-idb-storage/src';\n\nexport type Filter = {\n    [key: string]: string | number;\n};\nexport function createPersistKeyByFilter(filter: Filter) {\n    return JSON.stringify(filter, Object.keys(filter).sort());\n}\n\nexport function restoreFilterFromPersistKey<T>(key: keyof T): Filter {\n    return JSON.parse(key as string);\n}\n\ntype State = { [key: string]: Record<string, unknown> };\n\nexport function stateReconcilerByDate<T extends State>(inboundState: T): T {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const nowTime = today.getTime();\n\n    return Object.keys(inboundState)\n        .filter(key => key !== '_persist')\n        .reduce<T>((result, key: keyof T) => {\n            result[key] = Object.keys(inboundState[key]).reduce((inboundResult, inboundKey: keyof T[keyof T]) => {\n                const { date } = restoreFilterFromPersistKey(inboundKey);\n\n                // Если фильтра по дате нет, то данные не зависят от времени\n                if (!date) {\n                    inboundResult[inboundKey] = inboundState[key][inboundKey];\n                    return inboundResult;\n                }\n\n                const keyTime = parse(date).getTime();\n\n                // Оставляем только актуальные данные\n                if (nowTime <= keyTime) {\n                    inboundResult[inboundKey] = inboundState[key][inboundKey];\n                }\n\n                return inboundResult;\n            }, {} as T[keyof T]);\n\n            return result;\n        }, {} as T);\n}\n\ntype PersistOptions<S> = Omit<PersistConfig<S>, 'key' | 'storage'> & {\n    stateReconciler?: StateReconciler<S>;\n};\nexport function getPersistConfig<S>(key: string, options?: PersistOptions<S>): PersistConfig<S> {\n    return {\n        ...options,\n        storage: createIdbStorage({\n            name: 'miniapp-example',\n            storeName: 'redux-persist',\n        }),\n        key,\n        serialize: false,\n        // @ts-ignore\n        deserialize: false,\n        version: 7,\n        migrate: (persistedState, currentVersion) => {\n            // Достаем версию сохраненных в кэше данных.\n            const persistedVersion = persistedState && persistedState._persist.version;\n            // Если версия сохраненных данных совпадает с текущей версией обрабатываемых данных,\n            // оставляем данные неизменными, иначе - сбрасываем данные.\n            const migratedState = persistedVersion === currentVersion ? persistedState : undefined;\n\n            return Promise.resolve(migratedState);\n        },\n        timeout: 10000, // 10 секунд может быть полезно для low-end устройств\n    };\n}\n\nexport function getTransformUIPersistance<T>(defaultUIState: T) {\n    return createTransform((state: State[keyof State], key) => {\n        if (key === 'ui') {\n            return defaultUIState;\n        }\n\n        return state;\n    });\n}\n","export enum AppErrorCode {\n    OauthAccessDenied = 'oauth_access_denied',\n    OauthUnauthorizedClient = 'oauth_unauthorized_client',\n    JsApiDenied = 'js_api_denied',\n    JsApiCancelled = 'js_api_cancelled',\n    JsApiAlreadyShown = 'js_api_already_shown',\n    JsApiMethodNotAvailable = 'js_api_method_not_available',\n}\n\nexport class AppError extends Error {\n    public code: AppErrorCode;\n\n    constructor(code: AppErrorCode, message: string) {\n        super(message);\n\n        this.code = code;\n        this.name = 'AppError';\n    }\n}\n","import React from 'react';\n\nimport styles from './styles.module.css';\n\ntype RectProps = {\n    className?: string;\n    width?: number | string;\n    height?: number | string;\n    borderRadius?: number;\n};\n\nexport const Rect: React.FC<RectProps> = ({ className, width, height }) => {\n    return <div className={mix(styles.rect, className)} style={{ width, height }} />;\n};\n\ntype TextProps = {\n    className?: string;\n    width?: number | string;\n    size?: number;\n};\n\nexport const Text: React.FC<TextProps> = ({ className, width, size }) => {\n    return <div className={mix(styles.text, className)} style={{ width, height: size }} />;\n};\n\nfunction mix(...classNames: Array<string | null | undefined>) {\n    return classNames.filter(Boolean).join(' ');\n}\n","type QueryParams = {\n    [key: string]: string | number | string[] | undefined;\n};\n\ntype RetryOptions = {\n    retryCount: number;\n    retryDelay: number;\n};\n\nconst defaultRetryOptions: RetryOptions = {\n    retryCount: 2,\n    retryDelay: 2000,\n};\n\nfunction queryParams(params?: QueryParams) {\n    if (!params) {\n        return '';\n    }\n\n    const result = new URLSearchParams();\n\n    Object.entries(params).forEach(([key, value]) => {\n        if (typeof value === 'undefined') {\n            return;\n        }\n\n        if (Array.isArray(value)) {\n            return value.forEach(valueItem => result.append(key, valueItem));\n        }\n\n        result.append(key, value.toString());\n    });\n\n    return result.toString();\n}\n\nasync function fetchRetry(url: string, init?: RequestInit, retryOptions: RetryOptions = defaultRetryOptions) {\n    const { retryCount, retryDelay } = retryOptions;\n\n    for (let attempt = 0; attempt <= Math.max(retryCount, 0); attempt++) {\n        try {\n            return await fetch(url, init);\n        } catch (err) {\n            if (attempt === retryCount) {\n                throw err;\n            }\n\n            if (retryDelay) {\n                await new Promise(resolve => setTimeout(resolve, retryDelay));\n            }\n        }\n    }\n\n    return Promise.reject('Unable to fetch. Check retryOptions values');\n}\n\nasync function request<T extends object>(url: string, options?: RequestInit): Promise<T> {\n    const response = await fetchRetry(url, options);\n\n    if (response.ok) {\n        return response.json();\n    }\n\n    return Promise.reject(response);\n}\n\nexport async function get<T extends object>(\n    host: string,\n    path: string,\n    query?: QueryParams,\n    options?: RequestInit\n): Promise<T> {\n    return request(`${host}${path}${queryParams(query) ? `?${queryParams(query)}` : ''}`, options);\n}\n\nexport async function post<T extends object>(host: string, path: string, options: RequestInit): Promise<T> {\n    return request(`${host}${path}`, {\n        ...options,\n        method: 'POST',\n        headers: {\n            ...options.headers,\n            'Content-Type': 'application/json',\n        },\n    });\n}\n","import { getDistanceBetweenPoints } from '../geolocation';\nimport { get, post } from '../request';\nimport {\n    RubricEventsResponse,\n    ActualEventsResponse,\n    EventResponse,\n    SelectionsResponse,\n    SelectionEventsResponse,\n    CityInfoResponse,\n    CityListResponse,\n    SuggestResponse,\n    RecommendedEventsResponse,\n    CreateOrderResponse,\n    OrderResponse,\n    UserInfo,\n    UserInfoResponse,\n} from './types';\nimport { City } from './fragments/city';\n\nexport const MOSCOW = {\n    name: 'Москва',\n    geoid: 213,\n    longitude: 37.611347,\n    latitude: 55.760241,\n} as const;\n\ntype DateFilter = {\n    date: string;\n    period: number;\n};\n\nexport type GetEventsOptions = {\n    geoid: number;\n    offset?: number;\n    limit?: number;\n} & Partial<DateFilter>;\n\ntype GetCityInfoOptions = {\n    longitude: number;\n    latitude: number;\n};\n\nexport type GetSelectionsOptions = DateFilter & { geoid: number };\n\nconst API_HOST = process.env.REACT_APP_API_HOST ?? '';\nconst PAYMENT_API_HOST = process.env.REACT_APP_PAYMENT_API_HOST ?? '';\n\nexport function fetchEvent(id: string) {\n    return get<EventResponse>(API_HOST, `/api/event/${id}.json`);\n}\n\nexport function fetchRubricEvents(tag: string, options?: GetEventsOptions) {\n    return get<RubricEventsResponse>(API_HOST, `/api/rubric-events/${tag}.json`, options);\n}\n\nexport function fetchActualEvents(options?: GetEventsOptions) {\n    return get<ActualEventsResponse>(API_HOST, '/api/actual-events.json', options);\n}\n\nexport function fetchSelections(options?: GetSelectionsOptions) {\n    return get<SelectionsResponse>(API_HOST, '/api/selections.json', options);\n}\n\nexport async function fetchCityInfo(options: GetCityInfoOptions): Promise<CityInfoResponse> {\n    const cityList = await fetchCityList();\n\n    const citiesWithDistance = cityList.cities.map(city => {\n        const distance = getDistanceBetweenPoints(options.latitude, options.longitude, city.latitude, city.longitude);\n\n        return {\n            ...city,\n            distance,\n        };\n    });\n\n    let minDistance = Infinity;\n\n    const nearestCity: City = citiesWithDistance.reduce<City>(\n        (nearestCity, city) => {\n            const { distance, ...restCity } = city;\n\n            if (distance < minDistance) {\n                minDistance = distance;\n\n                return restCity;\n            }\n\n            return nearestCity;\n        },\n        {\n            ...MOSCOW,\n            eventsMenu: [],\n        }\n    );\n\n    return {\n        cityInfo: nearestCity,\n    };\n}\n\nexport function fetchCityList() {\n    return get<CityListResponse>(API_HOST, '/api/city-list.json');\n}\n\nexport function fetchSelectionEvents(code: string, options?: GetEventsOptions) {\n    return get<SelectionEventsResponse>(API_HOST, `/api/selection-events/${code}.json`, options);\n}\n\nexport function fetchSuggest(text: string, geoid: number, signal: AbortSignal) {\n    return get<SuggestResponse>(API_HOST, '/api/suggest.json', { text, geoid }, { signal });\n}\n\nexport function fetchRecommendedEvents(options?: GetEventsOptions) {\n    return get<RecommendedEventsResponse>(API_HOST, '/api/recommended-events.json', options);\n}\n\ntype OrderData = {\n    amount: number;\n    eventId: string;\n    deliveryId?: string;\n};\n\ntype OrderUserInfo = {\n    userInfo: UserInfo;\n    paymentId: number;\n    pushToken?: string;\n};\n\nexport type AuthOptions = {\n    jwtToken?: string;\n    oauthToken?: string;\n};\n\nfunction buildHeaders(authOptions: AuthOptions): Record<string, string> | undefined {\n    const { jwtToken, oauthToken } = authOptions;\n\n    if (jwtToken) {\n        return {\n            Authorization: jwtToken,\n        };\n    }\n\n    if (oauthToken) {\n        return {\n            Authorization: `OAuth ${oauthToken}`,\n        };\n    }\n}\n\nexport function createOrder(orderData: OrderData, authOptions: AuthOptions) {\n    return post<CreateOrderResponse>(PAYMENT_API_HOST, '/payment', {\n        body: JSON.stringify(orderData),\n        headers: buildHeaders(authOptions),\n    });\n}\n\nexport function saveUserInfo(orderUserInfo: OrderUserInfo, authOptions: AuthOptions) {\n    return post(PAYMENT_API_HOST, '/payment/user-info', {\n        body: JSON.stringify(orderUserInfo),\n        headers: buildHeaders(authOptions),\n    });\n}\n\nexport function fetchOrdersHistory(authOptions: AuthOptions) {\n    return get<OrderResponse[]>(PAYMENT_API_HOST, '/payments', undefined, {\n        headers: buildHeaders(authOptions),\n    });\n}\n\nexport function fetchUserInfo(oauthToken: string) {\n    return get<UserInfoResponse>(PAYMENT_API_HOST, '/user-info', undefined, {\n        headers: buildHeaders({ oauthToken }),\n    });\n}\n","import { AppError, AppErrorCode } from '../error';\nimport { callJsApi } from './utils';\n\nenum YandexAuthErrorName {\n    NotLoggedIn = 'AuthErrorCode::ERROR_NOT_LOGGED_IN',\n    AuthorizationDenied = 'AuthErrorCode::ERROR_AUTHORIZATION_DENIED',\n    AuthorizationCancelled = 'AuthErrorCode::ERROR_AUTHORIZATION_CANCELLED',\n}\n\nexport enum YandexAuthScope {\n    Info = 'login:info',\n    Email = 'login:email',\n    Avatar = 'login:avatar',\n}\n\nexport type UserInfo = {\n    uid?: string | number;\n    name?: string;\n    login?: string;\n    email?: string;\n    avatar_id?: string;\n    display_name?: string;\n}\n\ntype PSUIDPayload = {\n    psuid: string;\n}\n\ntype JWTPayload = {\n    iss: string;\n    iat: number;\n    jti: string;\n    exp: number;\n}\n\nexport type YandexAuthUserInfo = {\n    payload: JWTPayload & PSUIDPayload & UserInfo;\n    jwtToken: string;\n}\n\nexport type YandexAuthPSUIDInfo = {\n    payload: JWTPayload & PSUIDPayload;\n    jwtToken: string;\n}\n\nexport type YandexAuthInfo = {\n    userInfo: YandexAuthUserInfo;\n    tokenInfo: {\n        authToken: string;\n        authorizedScopes: Array<YandexAuthScope>;\n    };\n}\n\nexport const CLIENT_ID = '9e445c9aacec4266bf265302facb8293';\n\nexport async function identify(): Promise<YandexAuthPSUIDInfo> {\n    try {\n        return await callJsApi({\n            name: 'window.yandex.app.auth.identify',\n            args: [CLIENT_ID],\n            scope: window?.yandex?.app?.auth,\n            method: 'identify',\n        });\n    } catch (err) {\n        const { name } = err;\n\n        if (name === YandexAuthErrorName.NotLoggedIn) {\n            throw new AppError(AppErrorCode.JsApiCancelled, 'User not logged.');\n        }\n\n        throw err;\n    }\n}\n\nexport async function authorize(scopes?: Array<YandexAuthScope>): Promise<YandexAuthInfo> {\n    try {\n        return await callJsApi({\n            name: 'window.yandex.app.auth.authorize',\n            args: [CLIENT_ID, scopes],\n            scope: window?.yandex?.app?.auth,\n            method: 'authorize',\n        });\n    } catch (err) {\n        const { name } = err;\n\n        if (name === YandexAuthErrorName.AuthorizationDenied) {\n            throw new AppError(AppErrorCode.JsApiDenied, 'Authorization denied.');\n        }\n\n        if ([YandexAuthErrorName.NotLoggedIn, YandexAuthErrorName.AuthorizationCancelled].includes(name)) {\n            throw new AppError(AppErrorCode.JsApiCancelled, 'Authorization cancelled.');\n        }\n\n        throw err;\n    }\n}\n\nexport async function getCurrentUserId(): Promise<YandexAuthPSUIDInfo | null> {\n    try {\n        return await callJsApi({\n            name: 'window.yandex.app.auth.getCurrentUserId',\n            args: [CLIENT_ID],\n            scope: window?.yandex?.app?.auth,\n            method: 'getCurrentUserId',\n        });\n    } catch (err) {\n        const { name } = err;\n\n        if (name === YandexAuthErrorName.NotLoggedIn) {\n            throw new AppError(AppErrorCode.JsApiCancelled, 'User not logged.');\n        }\n\n        throw err;\n    }\n}\n","import { CLIENT_ID } from './js-api/auth';\nimport { AppError, AppErrorCode } from './error';\n\nenum OauthErrorCodes {\n    AccessDenied = 'access_denied',\n    UnauthorizedClient = 'unauthorized_client',\n}\n\nconst parsedOauthToken = (function() {\n    const params = new URLSearchParams(window.location.hash.slice(1));\n\n    const token = params.get('access_token');\n    const error = params.get('error');\n    const errorDescription = params.get('error_description');\n\n    // Нужно очистить hash от данных OAuth, т.к. роутинг страниц завязан на нём\n    if (token || error) {\n        const url = new URL(window.location.href);\n\n        url.hash = '';\n\n        window.history.replaceState(window.history.state, document.title, url.toString());\n    }\n\n    return { token, error, errorDescription };\n})();\n\nexport function getOauthToken(options: { withError?: boolean } = {}): string | null {\n    const { withError } = options;\n    const { token, error, errorDescription } = parsedOauthToken;\n\n    if (error && withError) {\n        const errorReason = errorDescription ? decodeURIComponent(errorDescription) : 'unknown reason';\n\n        switch (error) {\n            case OauthErrorCodes.AccessDenied:\n                throw new AppError(AppErrorCode.OauthAccessDenied, `OAuth access denied: ${errorReason}`);\n            case OauthErrorCodes.UnauthorizedClient:\n                throw new AppError(AppErrorCode.OauthUnauthorizedClient, `OAuth unauthorized client: ${errorReason}`);\n        }\n    }\n\n    return token;\n}\n\nexport function redirectToOauthAuthorize(): void {\n    const search = new URLSearchParams();\n\n    search.append('client_id', CLIENT_ID);\n    search.append('redirect_uri', `${window.location.origin}${window.location.pathname}`);\n    search.append('response_type', 'token');\n\n    window.location.href = `https://oauth.yandex.ru/authorize?${search.toString()}`;\n}\n","import { createSlice, createSelector, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { cleanup } from '../actions';\nimport { AppErrorCode } from '../../lib/error';\nimport { fetchUserInfo } from '../../lib/api';\nimport { getPersistConfig } from '../helpers/persist';\nimport { getOauthToken, redirectToOauthAuthorize } from '../../lib/oauth';\nimport {\n    identify as jsApiIdentify,\n    authorize as jsApiAuthorize,\n    UserInfo,\n    YandexAuthScope,\n    getCurrentUserId,\n} from '../../lib/js-api/auth';\nimport { fetchOrders } from './order';\nimport { AppThunk, RootState } from '..';\n\nexport type User = {\n    persist: {\n        currentUser: UserInfo;\n        psuid?: string;\n        jwtToken?: string;\n        oauthToken?: string;\n        loggedOutPsuid?: string;\n    },\n    nonpersist: {\n        isSessionLoggedOut?: boolean;\n    },\n};\n\nconst initialState: User = {\n    persist: {\n        currentUser: {},\n    },\n    nonpersist: {},\n};\n\nconst user = createSlice({\n    name: 'user',\n    initialState,\n    reducers: {\n        authenticated(state, action: PayloadAction<{ oauthToken: string } | { psuid: string; jwtToken: string }>) {\n            const payload = action.payload;\n\n            if ('psuid' in payload) {\n                state.persist.psuid = payload.psuid;\n                state.persist.jwtToken = payload.jwtToken;\n            } else {\n                state.persist.oauthToken = payload.oauthToken;\n            }\n\n            delete state.persist.loggedOutPsuid;\n            delete state.nonpersist.isSessionLoggedOut;\n        },\n        authorized(state, action: PayloadAction<{ user: UserInfo }>) {\n            state.persist.currentUser = action.payload.user;\n        },\n        logout(state) {\n            return {\n                persist: {\n                    ...initialState.persist,\n                    loggedOutPsuid: state.persist.psuid,\n                },\n                nonpersist: {\n                    ...initialState.nonpersist,\n                    isSessionLoggedOut: true,\n                },\n            };\n        },\n    },\n    extraReducers: builder => {\n        builder.addCase(cleanup, () => initialState);\n    },\n});\n\nexport const { authenticated, authorized, logout } = user.actions;\n\nconst jwtTokenSelector = (state: RootState) => state.user.persist.jwtToken;\nconst oauthTokenSelector = (state: RootState) => state.user.persist.oauthToken;\nconst loggedOutPsuidSelector = (state: RootState) => state.user.persist.loggedOutPsuid;\nconst isSessionLoggedOutSelector = (state: RootState) => Boolean(state.user.nonpersist.isSessionLoggedOut);\nexport const userSelector = (state: RootState) => state.user.persist.currentUser;\nexport const psuidSelector = (state: RootState) => state.user.persist.psuid;\nexport const isAuthorizedSelector = (state: RootState) => Boolean(state.user.persist.currentUser.uid);\nexport const authOptionsSelector = createSelector(\n    jwtTokenSelector,\n    oauthTokenSelector,\n    (jwtToken, oauthToken) => ({ jwtToken, oauthToken })\n);\nexport const isAuthenticatedSelector = createSelector(\n    authOptionsSelector,\n    authOptions => Boolean(authOptions.jwtToken ?? authOptions.oauthToken)\n);\n\nconst SCOPES = [YandexAuthScope.Avatar, YandexAuthScope.Info, YandexAuthScope.Email];\n\nconst oauthUpdateUserAndOrders = (oauthToken: string): AppThunk => async dispatch => {\n    dispatch(authenticated({ oauthToken }));\n    dispatch(fetchOrders());\n\n    try {\n        const userInfo = await fetchUserInfo(oauthToken);\n\n        dispatch(authorized({ user: userInfo }));\n    } catch (err) {\n        console.error(err);\n        alert('Не удалось получить информацию о пользователе');\n    }\n};\n\nconst oauthCheckUser = (): AppThunk => async(dispatch, getState) => {\n    const state = getState();\n\n    const oldOauthToken = oauthTokenSelector(state);\n    const isSessionLoggedOut = isSessionLoggedOutSelector(state);\n\n    // Если пользователь разлогинился, то не логиним его автоматически\n    if (isSessionLoggedOut) {\n        return;\n    }\n\n    try {\n        const oauthToken = getOauthToken({ withError: true });\n\n        if (!oauthToken) {\n            if (oldOauthToken) {\n                dispatch(oauthUpdateUserAndOrders(oldOauthToken));\n            }\n\n            return;\n        }\n\n        const isUserChanged = oldOauthToken && oldOauthToken !== oauthToken;\n\n        if (isUserChanged) {\n            dispatch(cleanup());\n        }\n\n        dispatch(oauthUpdateUserAndOrders(oauthToken));\n    } catch (err) {\n        const { code } = err;\n\n        if (oldOauthToken) {\n            dispatch(cleanup());\n        }\n\n        switch (code) {\n            case AppErrorCode.OauthAccessDenied:\n                return console.warn(err);\n            default:\n                console.error(err);\n        }\n    }\n};\n\nexport const authenticate = (afterLogin?: () => void): AppThunk => async(dispatch, getState) => {\n    try {\n        const psuid = psuidSelector(getState());\n        const psuidInfo = await jsApiIdentify();\n\n        if (psuid && psuid !== psuidInfo.payload.psuid) {\n            dispatch(cleanup());\n        }\n\n        dispatch(authenticated({ jwtToken: psuidInfo.jwtToken, psuid: psuidInfo.payload.psuid }));\n\n        afterLogin?.();\n    } catch (err) {\n        const { code } = err;\n\n        switch (code) {\n            case AppErrorCode.JsApiCancelled:\n                return console.warn(err);\n            case AppErrorCode.JsApiMethodNotAvailable:\n                return redirectToOauthAuthorize();\n        }\n\n        console.error(err);\n        alert('Не удалось войти. Попробуйте ещё раз');\n    }\n};\n\nexport const authorize = (): AppThunk => async dispatch => {\n    try {\n        const { userInfo } = await jsApiAuthorize(SCOPES);\n\n        dispatch(authorized({ user: userInfo.payload }));\n    } catch (err) {\n        const { code } = err;\n\n        switch (code) {\n            case AppErrorCode.JsApiDenied:\n            case AppErrorCode.JsApiCancelled:\n                return console.warn(err);\n            case AppErrorCode.JsApiMethodNotAvailable:\n                return redirectToOauthAuthorize();\n        }\n\n        console.error(err);\n        alert('Не удалось получить информацию о пользователе');\n    }\n};\n\nexport const login = (): AppThunk => async dispatch => {\n    await dispatch(\n        authenticate(() => {\n            dispatch(fetchOrders());\n        })\n    );\n};\n\nexport const checkUser = (): AppThunk => async(dispatch, getState) => {\n    const oldPsuid = psuidSelector(getState());\n\n    try {\n        const user = await getCurrentUserId();\n        const isUserChanged = oldPsuid && user?.payload.psuid !== oldPsuid;\n\n        if (isUserChanged) {\n            dispatch(cleanup());\n        }\n\n        if (!user) {\n            return;\n        }\n\n        const psuid = user.payload.psuid;\n        const loggedOutPsuid = loggedOutPsuidSelector(getState());\n\n        // Если пользователь разлогинился, то не логиним его автоматически\n        if (psuid === loggedOutPsuid) {\n            return;\n        }\n\n        dispatch(authenticated({ jwtToken: user.jwtToken, psuid }));\n        dispatch(fetchOrders());\n    } catch (err) {\n        const { code } = err;\n\n        if (oldPsuid) {\n            dispatch(cleanup());\n        }\n\n        switch (code) {\n            case AppErrorCode.JsApiCancelled:\n                return console.warn(err);\n            case AppErrorCode.JsApiMethodNotAvailable:\n                return dispatch(oauthCheckUser());\n            default:\n                console.error(err);\n        }\n    }\n};\n\nconst persistConfig = getPersistConfig<User>('user', { whitelist: ['persist'] });\nexport default persistReducer(persistConfig, user.reducer);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"image\":\"styles_image__Xibal\",\"button-wrapper\":\"styles_button-wrapper__1xmRh\",\"button\":\"styles_button__3ugFI\",\"date-1\":\"styles_date-1__1KrEV\",\"date-2\":\"styles_date-2__u1uuX\",\"map\":\"styles_map__1GZMr\",\"place-1\":\"styles_place-1__2BRJQ\",\"place-2\":\"styles_place-2__1cKpq\",\"gallery\":\"styles_gallery__33Vja\",\"gallery-header\":\"styles_gallery-header__2mb0M\",\"gallery-content\":\"styles_gallery-content__3RMTY\",\"gallery-card\":\"styles_gallery-card__1qkm9\",\"description\":\"styles_description__hdSqE\",\"description-line-1\":\"styles_description-line-1__26Xb3\",\"description-line-2\":\"styles_description-line-2__20hRv\",\"description-line-3\":\"styles_description-line-3__1VXVh\",\"description-line-4\":\"styles_description-line-4__2BYM0\",\"description-line-5\":\"styles_description-line-5__3aCps\",\"recommended\":\"styles_recommended__3JCFj\"};","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { fetchEvent } from '../../lib/api';\nimport { EventResponse } from '../../lib/api/types';\nimport { getPersistConfig, getTransformUIPersistance } from '../helpers/persist';\nimport { AppThunk, RootState } from '..';\n\nexport type Event = EventResponse['event'];\nexport type ScheduleInfo = EventResponse['scheduleInfo'];\n\nexport type EventPage = {\n    event: Event | null;\n    schedule: ScheduleInfo | null;\n    updatedAt: number;\n};\nexport type EventPageState = {\n    data: { [id: string]: EventPage };\n    ui: { [id: string]: { isLoading: boolean; isUpdating: boolean } };\n};\n\nconst initialState: EventPageState = {\n    data: {},\n    ui: {},\n};\nconst updateInterval = 300 * 1000;\n\nconst slice = createSlice({\n    name: 'event',\n    initialState,\n    reducers: {\n        fetchStart(state, action: PayloadAction<{ id: string }>) {\n            const { id } = action.payload;\n\n            if (!state.data[id]) {\n                state.data[id] = {\n                    event: null,\n                    schedule: null,\n                    updatedAt: 0,\n                };\n            }\n            if (!state.ui[id]) {\n                state.ui[id] = {\n                    isLoading: false,\n                    isUpdating: false,\n                };\n            }\n\n            if (!state.data[id].event) {\n                state.ui[id].isLoading = true;\n            } else {\n                state.ui[id].isUpdating = true;\n            }\n        },\n        fetchSuccess(state, action: PayloadAction<{ id: string; event: EventResponse }>) {\n            const { id, event } = action.payload;\n\n            state.data[id].event = event.event;\n            state.data[id].schedule = event.scheduleInfo;\n            state.data[id].updatedAt = Date.now();\n            state.ui[id].isLoading = false;\n            state.ui[id].isUpdating = false;\n        },\n        fetchError(state, action: PayloadAction<{ id: string; error: Error }>) {\n            const { id } = action.payload;\n\n            state.ui[id].isLoading = false;\n            state.ui[id].isUpdating = false;\n        },\n        setEvents(state, action: PayloadAction<{ events: EventResponse[] }>) {\n            const { events } = action.payload;\n\n            events.forEach(event => {\n                if (!event) {\n                    return;\n                }\n\n                const { id } = event.event;\n\n                if (!state.data[id]) {\n                    state.data[id] = {\n                        event: null,\n                        schedule: null,\n                        updatedAt: 0,\n                    };\n                }\n                if (!state.ui[id]) {\n                    state.ui[id] = {\n                        isLoading: false,\n                        isUpdating: false,\n                    };\n                }\n\n                state.data[id].event = event.event;\n                state.data[id].schedule = event.scheduleInfo;\n                state.data[id].updatedAt = Date.now();\n            });\n        },\n    },\n});\n\nexport const { fetchStart, fetchSuccess, fetchError, setEvents } = slice.actions;\n\nexport const eventPageSelector = (id: string) => (state: RootState) => state.event.data[id] ?? {};\n\nexport const loadEvent = (id: string): AppThunk => async(dispatch, getState) => {\n    const event = getState().event.data[id];\n\n    if (event && event.updatedAt + updateInterval > Date.now()) {\n        return;\n    }\n\n    dispatch(fetchStart({ id }));\n\n    try {\n        const event = await fetchEvent(id);\n        dispatch(fetchSuccess({ id, event }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchError({ id, error: err }));\n    }\n};\n\nconst persistConfig = getPersistConfig<EventPageState>('events', {\n    transforms: [getTransformUIPersistance<EventPageState['ui']>(initialState.ui)],\n});\nexport default persistReducer(persistConfig, slice.reducer);\n","import { reportGoalReached as jsApiReportGoalReached } from '../js-api/metrika';\nimport { YMetrikaInitParams, YMetrikaVisitParams } from './types';\n\nconst METRIKA_COUNTER_ID = 62405404;\n\nexport const initialOptions: YMetrikaInitParams = {\n    defer: true,\n    clickmap: true,\n    trackLinks: true,\n    trackHash: true,\n    accurateTrackBounce: true,\n    ecommerce: 'dataLayer'\n};\n\nexport enum MetrikaGoals {\n    OrderInitiated = 'order_initiated',\n    OrderCompleted = 'order_completed',\n    OrderError = 'order_error',\n}\n\nexport type MetrikaOrderParams = {\n    price: number;\n    order_id: number;\n    price_without_discount: number;\n}\n\nexport function initMetrika() {\n    window.dataLayer = window.dataLayer ?? [];\n    window.ym?.(METRIKA_COUNTER_ID, 'init', initialOptions);\n}\n\nexport function hit(url: string, options?: { params?: YMetrikaVisitParams }) {\n    window.ym?.(METRIKA_COUNTER_ID, 'hit', url, options);\n}\n\nexport function reachGoal(name: MetrikaGoals, params: MetrikaOrderParams) {\n    window.ym?.(METRIKA_COUNTER_ID, 'reachGoal', name, params);\n}\n\nexport function reportGoalReached(goal: MetrikaGoals, params: MetrikaOrderParams) {\n    jsApiReportGoalReached(goal, params);\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page-header\":\"styles_page-header__3SRj-\",\"page-header_clear\":\"styles_page-header_clear__1-0qG\",\"menu-button\":\"styles_menu-button__27a1S\",\"backward-button\":\"styles_backward-button__1gLVd\",\"burger-menu-icon\":\"styles_burger-menu-icon__30H4q\",\"logo\":\"styles_logo__3HQmN\",\"text\":\"styles_text__2t8C3\",\"suggest-button\":\"styles_suggest-button__jwrxc\",\"suggest-icon\":\"styles_suggest-icon__YMWw5\",\"icon-white\":\"styles_icon-white__3C4HZ\",\"icon-black\":\"styles_icon-black__3s7hW\"};","import { AppError, AppErrorCode } from './error';\nimport { UserInfo, CreateOrderResponse } from './api/types';\n\ninterface YandexPaymentMethodData extends PaymentMethodData {\n    supportedMethods: 'yandex',\n    data: {\n        userEmail?: string;\n        paymentToken: string;\n    };\n}\n\nexport async function processNativePayment(orderInfo: CreateOrderResponse, userInfo: UserInfo) {\n    const { paymentToken, cost, id } = orderInfo;\n    const { email: userEmail } = userInfo;\n\n    const yandexMethodData: YandexPaymentMethodData = {\n        supportedMethods: 'yandex',\n        data: {\n            userEmail,\n            paymentToken,\n        }\n    };\n\n    const details: PaymentDetailsInit = {\n        id: id.toString(),\n        total: {\n            label: 'Покупка билета',\n            amount: {\n                value: cost.toString(),\n                currency: 'RUB',\n            }\n        }\n    };\n\n    if (!window.PaymentRequest) {\n        throw new AppError(\n            AppErrorCode.JsApiMethodNotAvailable,\n            'window.PaymentRequest is not available in this browser version.'\n        );\n    }\n\n    try {\n        const request = new PaymentRequest([yandexMethodData], details);\n        const canMakePayment = await request.canMakePayment();\n\n        if (!canMakePayment) {\n            throw new AppError(AppErrorCode.JsApiMethodNotAvailable, 'request.canMakePayment() returns false.');\n        }\n\n        const response = await request.show();\n        await response.complete('success');\n    } catch (err) {\n        const { message } = err;\n\n        if (message.includes('[NOT_STARTED]')) {\n            throw new AppError(AppErrorCode.JsApiCancelled, 'window.PaymentRequest canceled.');\n        }\n\n        if (message.includes('Already called show')) {\n            throw new AppError(AppErrorCode.JsApiAlreadyShown, 'window.PaymentRequest already shown.');\n        }\n\n        throw err;\n    }\n}\n","import { reportGoalReached } from '../js-api/metrika';\nimport { CreateOrderResponse } from '../api/types';\nimport { reachGoal, MetrikaGoals, MetrikaOrderParams } from '.';\n\nfunction buildMetrikaOrderParams(response: CreateOrderResponse): MetrikaOrderParams {\n    return {\n        order_id: response.id,\n        price: response.cost,\n        price_without_discount: response.cost,\n    };\n}\n\nexport async function logOrderInitiated(response: CreateOrderResponse): Promise<void> {\n    const metrikaParams = buildMetrikaOrderParams(response);\n\n    reachGoal(MetrikaGoals.OrderInitiated, metrikaParams);\n    await reportGoalReached(MetrikaGoals.OrderInitiated, metrikaParams);\n}\n\nexport async function logOrderCompleted(response: CreateOrderResponse): Promise<void> {\n    const metrikaParams = buildMetrikaOrderParams(response);\n\n    reachGoal(MetrikaGoals.OrderCompleted, metrikaParams);\n    await reportGoalReached(MetrikaGoals.OrderCompleted, metrikaParams);\n}\n\nexport function logOrderError(response: CreateOrderResponse): void {\n    const metrikaParams = buildMetrikaOrderParams(response);\n\n    reachGoal(MetrikaGoals.OrderError, metrikaParams);\n}\n","import { callJsApi } from './utils';\n\nexport type YandexPushTokenForTransaction = {\n    jwtToken: string;\n    pushToken: string;\n};\n\nexport function getPushTokenForTransaction(paymentToken: string): Promise<YandexPushTokenForTransaction | null> {\n    return callJsApi({\n        name: 'window.yandex.app.push.getPushTokenForTransaction',\n        args: [paymentToken],\n        scope: window?.yandex?.app?.push,\n        method: 'getPushTokenForTransaction',\n    });\n}\n","import { Event } from '../api/fragments/event';\nimport { AppError, AppErrorCode } from '../error';\nimport {\n    YandexCheckoutState,\n    YandexCheckoutRequest,\n    YandexCheckoutDetails,\n    YandexCheckoutOptions,\n    YandexCheckoutTotalAmount,\n    YandexCheckoutPaymentOption,\n    YandexCheckoutShippingOption,\n    YandexCheckoutOrderShippingAddressState,\n} from './types';\n\nenum PaymentOption {\n    OfflineCash = 'offline-cash',\n    OfflineCard = 'offline-card',\n    YandexPayments = 'yandex-payments',\n    OnlineExternalPayments = 'online-external-payments',\n}\n\nenum ShippingOption {\n    Mail = 'mail',\n    Courier = 'courier',\n}\n\nconst CURRENCY = 'RUB';\nconst PUBLIC_URL = process.env.PUBLIC_URL ?? '';\nconst DEFAULT_SHIPPING_ID = ShippingOption.Courier;\nconst DEFAULT_PAYMENT_FORM_URL =\n    'https://sdelano.net/browser/cards/with3ds?redirect_url=https%3A%2F%2Fcheckout.tap.yandex.ru%2Fonline-external-payments%2Fsuccess';\n\nconst CHECKOUT_STORAGE_KEY = 'miniapp_example_native_checkout';\nconst CHECKOUT_SEARCH_PARAM = 'native_checkout';\nconst CHECKOUT_SEARCH_POSITIVE_PARAMS = new Set(['1', 'on', 'true']);\n\nexport const isCheckoutRequestAvailable = (function() {\n    const searchParams = new URLSearchParams(window.location.search);\n\n    const checkoutSearchParam = searchParams.get(CHECKOUT_SEARCH_PARAM);\n    const checkoutSearchParamCached = window.localStorage.getItem(CHECKOUT_STORAGE_KEY);\n    const checkoutParam = checkoutSearchParam ?? checkoutSearchParamCached ?? '';\n\n    const isCheckoutEnable = CHECKOUT_SEARCH_POSITIVE_PARAMS.has(checkoutParam);\n    const isCheckoutAvailable = Boolean(window.YandexCheckoutRequest);\n\n    if (checkoutSearchParam) {\n        window.localStorage.setItem(CHECKOUT_STORAGE_KEY, checkoutSearchParam);\n    }\n\n    return isCheckoutEnable && isCheckoutAvailable;\n})();\n\nfunction getShippingOption(shippingOptionId: ShippingOption): YandexCheckoutShippingOption;\nfunction getShippingOption(shippingOptionId: string): YandexCheckoutShippingOption | undefined;\nfunction getShippingOption(shippingOptionId: string): YandexCheckoutShippingOption | undefined {\n    switch (shippingOptionId) {\n        case ShippingOption.Mail:\n            return {\n                id: ShippingOption.Mail,\n                label: 'Почта России',\n                datetimeEstimate: '6-7 дней',\n                amount: {\n                    value: 0,\n                    currency: CURRENCY,\n                },\n            };\n        case ShippingOption.Courier:\n            return {\n                id: ShippingOption.Courier,\n                label: 'Курьер',\n                datetimeEstimate: '3-4 дня',\n                amount: {\n                    value: 10000,\n                    currency: CURRENCY,\n                },\n            };\n    }\n}\n\nexport function getSelectedShippingAddress(\n    orderId: string,\n    checkoutState: YandexCheckoutState\n): YandexCheckoutOrderShippingAddressState | undefined {\n    const order = checkoutState.orders.find(({ id }) => id === orderId);\n    const selectedShippingAddress = order?.shippingAddress;\n\n    return selectedShippingAddress;\n}\n\nexport function getSelectedShippingOption(\n    orderId: string,\n    checkoutState: YandexCheckoutState\n): YandexCheckoutShippingOption | undefined {\n    const order = checkoutState.orders.find(({ id }) => id === orderId);\n    const selectedShippingOptionId = order?.shippingOption?.id;\n\n    if (selectedShippingOptionId) {\n        return getShippingOption(selectedShippingOptionId);\n    }\n}\n\nexport function getCheckoutTotalAmount(shippingOptionId: string, event: Event): YandexCheckoutTotalAmount {\n    const { tickets: eventTickets } = event;\n\n    const eventValue = eventTickets?.[0]?.price?.min ?? 0;\n    const deliveryValue = getShippingOption(shippingOptionId)?.amount.value ?? 0;\n\n    const totalAmount: YandexCheckoutTotalAmount = {\n        amount: {\n            value: eventValue + deliveryValue,\n            currency: CURRENCY,\n        },\n        details: null,\n    };\n\n    if (deliveryValue > 0) {\n        totalAmount.details = [\n            {\n                label: 'Билеты',\n                amount: {\n                    value: eventValue,\n                    currency: CURRENCY,\n                },\n            },\n            {\n                label: 'Доставка',\n                amount: {\n                    value: deliveryValue,\n                    currency: CURRENCY,\n                },\n            },\n        ];\n    }\n\n    return totalAmount;\n}\n\nexport function getCheckoutShippingOptions(defaultShippingOptionId: string): Array<YandexCheckoutShippingOption> {\n    return [ShippingOption.Mail, ShippingOption.Courier].map(id => {\n        const shippingOption = getShippingOption(id);\n\n        if (shippingOption.id === defaultShippingOptionId) {\n            shippingOption.selected = true;\n        }\n\n        return shippingOption;\n    });\n}\n\n// Модульная переменная, в которой хранится информация о доступности внешних онлайн оплат\nlet isOnlineExternalPaymentsAvailable: boolean = true;\n\nexport function getCheckoutPaymentOptions(paymentToken?: string): Array<YandexCheckoutPaymentOption> {\n    const yandexPaymentsData = typeof paymentToken === 'string' ? { paymentToken } : undefined;\n    const checkoutPaymentOptions: Array<YandexCheckoutPaymentOption> = [\n        { type: PaymentOption.OfflineCash },\n        { type: PaymentOption.OfflineCard },\n        { type: PaymentOption.YandexPayments, data: yandexPaymentsData },\n    ];\n\n    if (isOnlineExternalPaymentsAvailable) {\n        checkoutPaymentOptions.push({\n            type: PaymentOption.OnlineExternalPayments,\n            data: { paymentFormUrl: DEFAULT_PAYMENT_FORM_URL },\n        });\n    }\n\n    return checkoutPaymentOptions;\n}\n\nfunction getCheckoutDetails(orderId: string, event: Event): YandexCheckoutDetails {\n    const { title: eventTitle, image: eventImage } = event;\n    const { touchPrimary } = eventImage ?? {};\n\n    const total = getCheckoutTotalAmount(DEFAULT_SHIPPING_ID, event);\n    const paymentOptions = getCheckoutPaymentOptions();\n    const shippingOptions = getCheckoutShippingOptions(DEFAULT_SHIPPING_ID);\n\n    return {\n        total,\n        orders: [\n            {\n                id: orderId,\n                requestCity: true,\n                requestShippingAddress: true,\n                cartItems: [\n                    {\n                        title: eventTitle,\n                        count: 1,\n                        image: touchPrimary && [\n                            {\n                                url: touchPrimary.url,\n                                width: touchPrimary.width,\n                                height: touchPrimary.height,\n                            },\n                        ],\n                        amount: total.amount,\n                    },\n                ],\n                shippingOptions,\n            },\n        ],\n        payerDetails: [\n            { type: 'name', require: true },\n            { type: 'phone', require: true },\n            { type: 'email', require: true },\n        ],\n        paymentOptions,\n    };\n}\n\nfunction getCheckoutOptions(): YandexCheckoutOptions {\n    return {\n        shopName: 'MiniApp Example',\n        shopIcon: `${PUBLIC_URL}/logo192.png`,\n    };\n}\n\nfunction getCheckoutRequest(orderId: string, event: Event): YandexCheckoutRequest {\n    if (!window.YandexCheckoutRequest) {\n        throw new AppError(AppErrorCode.JsApiMethodNotAvailable, 'window.YandexCheckoutRequest is undefined.');\n    }\n\n    const checkoutDetails = getCheckoutDetails(orderId, event);\n    const checkoutOptions = getCheckoutOptions();\n\n    return new window.YandexCheckoutRequest(checkoutDetails, checkoutOptions);\n}\n\nexport function createCheckoutRequest(orderId: string, event: Event): YandexCheckoutRequest {\n    try {\n        return getCheckoutRequest(orderId, event);\n    } catch (err) {\n        const { name, message } = err;\n\n        const isTypeError = name === 'TypeError';\n        const isOnlineExternalPaymentsValidationError = message.includes(\n            \"'online-external-payments' is not a valid enum\"\n        );\n\n        // Если реализация внешних оплат недоступна, тогда пытаемся открыть Чекаут без них\n        if (isTypeError && isOnlineExternalPaymentsValidationError) {\n            isOnlineExternalPaymentsAvailable = false;\n\n            return getCheckoutRequest(orderId, event);\n        }\n\n        throw err;\n    }\n}\n","import { createSelector, createSlice, PayloadAction, nanoid } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { Event } from '../../lib/api/fragments/event';\nimport { cleanup } from '../actions';\nimport { AppErrorCode } from '../../lib/error';\nimport { processNativePayment } from '../../lib/payment';\nimport { logProductAdd, logProductPurchase } from '../../lib/metrika/ecommerce';\nimport { getPersistConfig, getTransformUIPersistance } from '../helpers/persist';\nimport { CreateOrderResponse, OrderResponse, UserInfo } from '../../lib/api/types';\nimport { logOrderInitiated, logOrderCompleted, logOrderError } from '../../lib/metrika/event';\nimport { getPushTokenForTransaction, YandexPushTokenForTransaction } from '../../lib/js-api/push';\nimport {\n    AuthOptions,\n    fetchOrdersHistory,\n    createOrder as createOrderAPI,\n    saveUserInfo as saveUserInfoAPI,\n} from '../../lib/api';\nimport {\n    createCheckoutRequest,\n    getCheckoutTotalAmount,\n    getCheckoutPaymentOptions,\n    getSelectedShippingOption,\n    getSelectedShippingAddress,\n    isCheckoutRequestAvailable,\n} from '../../lib/checkout';\nimport { authenticate, authOptionsSelector } from './user';\nimport { AppThunk, RootState } from '..';\n\nexport type Order = {\n    data: {\n        activeOrder?: CreateOrderResponse;\n        orders: OrderResponse[];\n    };\n    ui: {\n        isLoading?: boolean;\n        isOrderCreationInProgress?: boolean;\n        isPaymentInProgress?: boolean;\n        isCheckoutInProgress?: boolean;\n    };\n};\n\nconst initialState: Order = {\n    data: {\n        orders: [],\n    },\n    ui: {},\n};\n\nconst order = createSlice({\n    name: 'order',\n    initialState,\n    reducers: {\n        fetchStart(state) {\n            state.ui.isLoading = true;\n        },\n        fetchSuccess(state, action: PayloadAction<OrderResponse[]>) {\n            state.ui.isLoading = false;\n            state.data.orders = action.payload;\n        },\n        fetchError(state) {\n            state.ui.isLoading = false;\n        },\n        orderCreationStart(state) {\n            state.ui.isCheckoutInProgress = true;\n            state.ui.isOrderCreationInProgress = true;\n        },\n        orderCreationSuccess(state, action: PayloadAction<CreateOrderResponse>) {\n            state.data.activeOrder = action.payload;\n            state.ui.isOrderCreationInProgress = false;\n        },\n        orderCreationEnd(state) {\n            state.ui.isOrderCreationInProgress = false;\n        },\n        paymentStart(state) {\n            state.ui.isPaymentInProgress = true;\n        },\n        paymentEnd(state) {\n            state.ui.isPaymentInProgress = false;\n        },\n        checkoutEnd(state) {\n            state.ui.isCheckoutInProgress = false;\n            delete state.data.activeOrder;\n        },\n    },\n    extraReducers: builder => {\n        builder.addCase(cleanup, () => initialState);\n    },\n});\n\nexport const {\n    fetchStart,\n    fetchSuccess,\n    fetchError,\n    paymentStart,\n    paymentEnd,\n    checkoutEnd,\n    orderCreationStart,\n    orderCreationSuccess,\n    orderCreationEnd,\n} = order.actions;\n\nexport const paymentInProgressSelector = (state: RootState) => Boolean(state.order.ui.isPaymentInProgress);\nexport const checkoutInProgressSelector = (state: RootState) => Boolean(state.order.ui.isCheckoutInProgress);\nexport const orderCreationInProgressSelector = (state: RootState) => Boolean(state.order.ui.isOrderCreationInProgress);\nexport const activeOrderSelector = (state: RootState) => state.order.data.activeOrder;\nexport const ordersSelector = (state: RootState) => state.order.data.orders;\n\nexport const orderEventIdsSelector = createSelector(ordersSelector, payments =>\n    Array.from(new Set(payments.map(order => order.event.id)))\n);\n\nexport const ordersLoadingSelector = createSelector(\n    orderEventIdsSelector,\n    (state: RootState) => state.order.ui,\n    (state: RootState) => state.event.ui,\n    (orderEventIds, orderUi, eventsUi) => {\n        const isEventLoading = orderEventIds.some(event => eventsUi[event]?.isLoading);\n\n        return orderUi.isLoading || isEventLoading;\n    }\n);\n\nexport const fetchOrders = (): AppThunk => async(dispatch, getState) => {\n    const authOptions = authOptionsSelector(getState());\n\n    if (!authOptions.jwtToken && !authOptions.oauthToken) {\n        return;\n    }\n\n    dispatch(fetchStart());\n\n    try {\n        const orders = await fetchOrdersHistory(authOptions);\n        dispatch(fetchSuccess(orders));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchError());\n    }\n};\n\nexport const createOrder = (\n    event: Event,\n    onOrderCreated: () => void = () => {},\n    retry: boolean = true\n): AppThunk => async(dispatch, getState) => {\n    if (isCheckoutRequestAvailable) {\n        return dispatch(buyTicketByCheckout(event));\n    }\n\n    const authOptions = authOptionsSelector(getState());\n\n    dispatch(orderCreationStart());\n\n    let response: CreateOrderResponse;\n\n    try {\n        response = await createOrderAPI(\n            {\n                eventId: event.id,\n                amount: 1,\n            },\n            authOptions\n        );\n\n        await logOrderInitiated(response);\n\n        dispatch(orderCreationSuccess(response));\n\n        onOrderCreated();\n    } catch (err) {\n        dispatch(orderCreationEnd());\n\n        if (err.status === 401 && retry) {\n            return dispatch(authenticate(() => dispatch(createOrder(event, onOrderCreated, false))));\n        }\n    }\n};\n\nexport const buyTicket = (event: Event, userInfo: UserInfo): AppThunk => async(\n    dispatch,\n    getState\n) => {\n    const state = getState();\n\n    const authOptions = authOptionsSelector(state);\n    const activeOrder = activeOrderSelector(state);\n\n    dispatch(paymentStart());\n\n    if (orderCreationInProgressSelector(getState())) {\n        throw new Error('Payment is not available. Order creating now');\n    }\n\n    // Если нет активного заказа, сначала создаем его\n    if (!activeOrder) {\n        return dispatch(createOrder(event, () => buyTicket(event, userInfo)));\n    }\n\n    logProductAdd(event);\n\n    try {\n        await processPayment(activeOrder, userInfo);\n        await saveUserInfo(activeOrder, userInfo, authOptions);\n\n        await logOrderCompleted(activeOrder);\n        logProductPurchase(event, activeOrder.id);\n\n        dispatch(checkoutEnd());\n    } catch (err) {\n        const { code } = err;\n\n        logOrderError(activeOrder);\n\n        switch (code) {\n            case AppErrorCode.JsApiCancelled:\n            case AppErrorCode.JsApiAlreadyShown:\n                return;\n            default:\n                console.error(err);\n                alert('Произошла ошибка при покупке билета. Попробуйте ещё раз');\n        }\n    } finally {\n        dispatch(paymentEnd());\n        dispatch(fetchOrders());\n    }\n};\n\nexport function buyTicketByCheckout(event: Event): AppThunk {\n    return async(dispatch, getState) => {\n        const orderId = nanoid();\n        const authOptions = authOptionsSelector(getState());\n\n        let response: CreateOrderResponse;\n\n        try {\n            const checkoutRequest = createCheckoutRequest(orderId, event);\n\n            checkoutRequest.addEventListener('shippingOptionChange', checkoutEvent => {\n                const shippingOption = getSelectedShippingOption(orderId, checkoutEvent.checkoutState);\n\n                if (shippingOption) {\n                    const total = getCheckoutTotalAmount(shippingOption.id, event);\n\n                    return checkoutEvent.updateWith({ total });\n                }\n            });\n\n            checkoutRequest.addEventListener('paymentStart', checkoutEvent => {\n                const getCheckoutUpdateDetails = async() => {\n                    const shippingOption = getSelectedShippingOption(orderId, checkoutEvent.checkoutState);\n\n                    try {\n                        response = await createOrderAPI(\n                            {\n                                amount: 1,\n                                eventId: event.id,\n                                deliveryId: shippingOption?.id,\n                            },\n                            authOptions\n                        );\n\n                        await logOrderInitiated(response);\n\n                        return {\n                            paymentOptions: getCheckoutPaymentOptions(response.paymentToken),\n                        };\n                    } catch (err) {\n                        console.error(err);\n\n                        return {\n                            validationErrors: {\n                                error: 'Ошибка оплаты. Не удалось получить токен оплаты. Попробуйте снова',\n                            },\n                        };\n                    }\n                };\n\n                checkoutEvent.updateWith(getCheckoutUpdateDetails());\n            });\n\n            logProductAdd(event);\n\n            const checkoutState = await checkoutRequest.show();\n            const { rawAddress: address = '' } = getSelectedShippingAddress(orderId, checkoutState) ?? {};\n            const { name = '', phone = '', email = '' } = checkoutState.payerDetails ?? {};\n\n            response = response!;\n\n            await saveUserInfo(response, { name, phone, email, address }, authOptions);\n\n            await logOrderCompleted(response);\n            logProductPurchase(event, response.id);\n        } catch (err) {\n            const { name } = err;\n\n            if (name === 'AbortError') {\n                return;\n            }\n\n            console.error(err);\n            alert('Произошла ошибка при покупке билета. Попробуйте ещё раз');\n        } finally {\n            dispatch(fetchOrders());\n        }\n    };\n}\n\nasync function processPayment(response: CreateOrderResponse, userInfo: UserInfo) {\n    try {\n        await processNativePayment(response, userInfo);\n    } catch (err) {\n        const { code } = err;\n\n        switch (code) {\n            case AppErrorCode.JsApiMethodNotAvailable:\n                return;\n            default:\n                throw err;\n        }\n    }\n}\n\nasync function fetchPushToken(paymentToken: string) {\n    let pushToken: YandexPushTokenForTransaction | null = null;\n\n    try {\n        pushToken = await getPushTokenForTransaction(paymentToken);\n    } catch (err) {\n        console.warn(err);\n    }\n\n    return pushToken;\n}\n\nasync function saveUserInfo(response: CreateOrderResponse, userInfo: UserInfo, authOptions: AuthOptions) {\n    const { pushToken } = (await fetchPushToken(response.paymentToken)) ?? {};\n    const { id: paymentId } = response;\n\n    try {\n        saveUserInfoAPI({ userInfo, paymentId, pushToken }, authOptions);\n    } catch (err) {\n        console.error(err);\n    }\n}\n\nconst persistConfig = getPersistConfig<Order>('order', {\n    transforms: [getTransformUIPersistance<Order['ui']>(initialState.ui)],\n});\nexport default persistReducer(persistConfig, order.reducer);\n","type QueryParams = Record<string, string>;\n\nexport function getMainPageUrl() {\n    return '/';\n}\n\nexport function getEventUrl(id: string) {\n    return `/event/${id}`;\n}\n\nexport function getEventGalleryUrl(id: string, query: QueryParams) {\n    const params = query ? `?${new URLSearchParams(query)}` : '';\n\n    return `/event/${id}/gallery${params}`;\n}\n\nexport function getRubricUrl(code: string) {\n    return `/events/${encodeURIComponent(code)}`;\n}\n\nexport function getSelectionUrl(code: string) {\n    return `/selection/${encodeURIComponent(code)}`;\n}\n\nexport function getSearchUrl() {\n    return '/search';\n}\n\nexport function getOrdersUrl() {\n    return '/orders';\n}\n","import { lazy } from 'react';\n\ntype LazyDeferred = typeof lazy;\n\n// Минимальное время перед импортом, чтобы дать отрисоваться скелетону\nconst LAZY_DEFFERED_SLEEP = 50;\n// Минимальное время импорта компонента\nconst LAZY_DEFFERED_DELAY = 500;\n\nexport const lazyDeferred: LazyDeferred = importCallback => {\n    type LazyImportType = ReturnType<typeof importCallback>;\n\n    return lazy(() =>\n        Promise.all<LazyImportType, void>([\n            new Promise<LazyImportType>(resolve => setTimeout(() => resolve(importCallback()), LAZY_DEFFERED_SLEEP)),\n            new Promise<void>(resolve => setTimeout(resolve, LAZY_DEFFERED_DELAY)),\n        ]).then(([module]) => module)\n    );\n};\n","import { AppError, AppErrorCode } from '../error';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype YandexJsApiObject = Record<string, any> | undefined;\n\nexport function callJsApi<T extends YandexJsApiObject, K extends keyof NonNullable<T>>({\n    name,\n    args,\n    scope,\n    method,\n}: {\n    name: string;\n    args: Parameters<NonNullable<NonNullable<T>[K]>>;\n    scope: T;\n    method: K,\n}): ReturnType<NonNullable<NonNullable<T>[K]>> {\n    const func = scope ? scope![method] : null;\n\n    if (!func) {\n        throw new AppError(AppErrorCode.JsApiMethodNotAvailable, `${name} is not available in this browser version.`);\n    }\n\n    return func.apply(scope, args);\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"screen\":\"styles_screen__3Xc2f\",\"hidden\":\"styles_hidden__319gL\",\"screenEnter\":\"styles_screenEnter__1cDTX\",\"screenEnterActive\":\"styles_screenEnterActive__3Aipd\",\"screenExit\":\"styles_screenExit__16_m_\",\"screenExitActive\":\"styles_screenExitActive__9q_ED\",\"offset\":\"styles_offset__3ZkO6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"styles_card__2fC7e\",\"image\":\"styles_image__2rNd-\",\"content\":\"styles_content__3r_Ib\",\"right\":\"styles_right__39u8P\",\"short\":\"styles_short__5IaPF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"style_modal__ArKGM\",\"content\":\"style_content__36rzf\",\"hidden\":\"style_hidden__153Qs\",\"visible\":\"style_visible__2ITxB\",\"body\":\"style_body__3TOLT\",\"profile\":\"style_profile__4Kle_\",\"psuid\":\"style_psuid__32HpM\",\"logout\":\"style_logout__1unjr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"styles_wrapper__1LBcn\",\"wrapper_loading\":\"styles_wrapper_loading__3wiy0\",\"wrapper-visible_yes\":\"styles_wrapper-visible_yes__1gZE6\",\"slideUp\":\"styles_slideUp__ugjBN\",\"wrapper-visible_no\":\"styles_wrapper-visible_no__3CTrI\",\"slideDown\":\"styles_slideDown__1-rC7\",\"title\":\"styles_title__2H0i0\",\"auto-select-box\":\"styles_auto-select-box__1KSTl\",\"selected\":\"styles_selected__3i7jO\",\"selected-city-label\":\"styles_selected-city-label__107bE\",\"selected-city-name\":\"styles_selected-city-name__3y9wk\",\"button\":\"styles_button__32WSn\"};","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { getPersistConfig } from '../helpers/persist';\n\nimport { MenuTag } from '../../lib/api/fragments/city';\n\nexport type Menu = {\n    visible: boolean;\n    items: Array<MenuTag>;\n    activeItem: MenuTag['code'];\n};\n\nconst initialState: Menu = {\n    visible: false,\n    items: [],\n    activeItem: '',\n};\n\nconst menu = createSlice({\n    name: 'menu',\n    initialState,\n    reducers: {\n        setItems(state, action: PayloadAction<MenuTag[]>) {\n            state.items = action.payload;\n        },\n        setVisible(state, action: PayloadAction<boolean>) {\n            state.visible = action.payload;\n        },\n    },\n});\n\nexport const { setItems, setVisible } = menu.actions;\n\nconst persistConfig = getPersistConfig<Menu>('menu');\nexport default persistReducer(persistConfig, menu.reducer);\n","import { createAction } from '@reduxjs/toolkit';\n\nexport const cleanup = createAction('cleanup');\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"style_card__2T-VX\",\"title\":\"style_title__RuqCf\",\"annotation\":\"style_annotation__n8doS\",\"image-wrapper\":\"style_image-wrapper__3JJK-\",\"image-overlay\":\"style_image-overlay__29ffx\",\"image\":\"style_image__Lux1b\",\"preview\":\"style_preview__3loTl\"};","import React, { ComponentType } from 'react';\n\nimport { DEFAULT_ITEMS_GAP } from '../constants';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    count: number;\n    card: ComponentType;\n    itemsGap?: number;\n};\n\nconst EventsListSkeleton: React.FC<Props> = ({ itemsGap = DEFAULT_ITEMS_GAP, count, card: Card }) => (\n    <div className={styles.events} style={{ gridGap: `${itemsGap}px` }}>\n        {Array(count)\n            .fill(0)\n            .map((_, index) => (\n                <Card key={index} />\n            ))}\n    </div>\n);\n\nexport default EventsListSkeleton;\n","export const isIOS = (): boolean =>\n    (/iPad|iPhone|iPod/.test(navigator.platform) ||\n        /iPad|iPhone|iPod/.test(navigator.userAgent) ||\n        (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) &&\n    !window.MSStream;\n","import React, { memo, useCallback } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory, Link } from 'react-router-dom';\n\nimport { setVisible as setMenuVisible } from '../../redux/slices/menu';\nimport { getMainPageUrl, getSearchUrl } from '../../lib/url-builder';\n\nimport BackwardButton from '../BackwardButton';\nimport ClearButton from '../ClearButton';\n\nimport styles from './styles.module.css';\n\nconst Logo: React.FC = () => (\n    <Link to={getMainPageUrl()} className={styles.logo}>\n        MiniApp Example\n    </Link>\n);\n\ntype IconProps = {\n    fill?: 'white' | 'black';\n};\n\nconst SuggestIcon: React.FC<IconProps> = ({ fill = 'black' }) => {\n    const className = [styles['suggest-icon'], styles[`icon-${fill}`]].join(' ');\n\n    return <span className={className} />;\n};\n\nfunction setMods(className: string, mods?: string) {\n    if (!mods) {\n        return styles[className];\n    }\n\n    return `${styles[className]} ${styles[`${className}_${mods}`]}`;\n}\n\nexport type Props = {\n    hasMenu?: boolean;\n    hasLogo?: boolean;\n    backward?: 'white' | 'black' | '';\n    mods?: 'clear' | '';\n    text?: string;\n};\n\nconst PageHeader: React.FC<Props> = props => {\n    const { hasMenu, hasLogo, backward, mods, text } = props;\n\n    const history = useHistory();\n    const dispatch = useDispatch();\n\n    const onSearchClick = useCallback(() => {\n        history.push(getSearchUrl());\n    }, [history]);\n\n    const onMenuClick = useCallback(() => {\n        dispatch(setMenuVisible(true));\n    }, [dispatch]);\n\n    return (\n        <header className={setMods('page-header', mods)}>\n            {Boolean(backward) && <BackwardButton className={styles['backward-button']} fill={backward || 'black'} />}\n            {Boolean(hasMenu) && (\n                <ClearButton className={styles['menu-button']} onClick={onMenuClick}>\n                    <span className={styles['burger-menu-icon']} />\n                </ClearButton>\n            )}\n            {hasLogo && <Logo />}\n            {text && <span className={styles.text}>{text}</span>}\n            <ClearButton className={styles['suggest-button']} onClick={onSearchClick}>\n                <SuggestIcon fill={mods ? 'white' : 'black'} />\n            </ClearButton>\n        </header>\n    );\n};\n\nexport default memo(PageHeader);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"style_list__1E8sL\",\"item\":\"style_item__2Gtnq\",\"orders-text\":\"style_orders-text__2Hcw-\",\"link\":\"style_link__5kR7b\",\"active-item\":\"style_active-item__1n702\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"feed\":\"styles_feed__RntQS\",\"title\":\"styles_title__2JRen\",\"events\":\"styles_events___mJxb\",\"item\":\"styles_item__2O9gA\"};","import { useContext, useMemo } from 'react';\n\nimport { StackNavigatorContext } from './context';\nimport { BackwardProps } from './StackNavigator';\n\nexport function useBackward(params?: BackwardProps) {\n    const onBackward = useContext(StackNavigatorContext).onBackward;\n\n    return useMemo(() => onBackward.bind(null, params), [onBackward, params]);\n}\n\nexport function useScreenVisible() {\n    return useContext(StackNavigatorContext).isVisible;\n}\n\nexport function useScreenRef() {\n    return useContext(StackNavigatorContext).ref;\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { fetchSelections } from '../../lib/api';\nimport { SelectionsResponse } from '../../lib/api/types';\nimport { EventPreview } from '../../lib/api/fragments/event-preview';\n\nimport {\n    createPersistKeyByFilter,\n    stateReconcilerByDate,\n    getPersistConfig,\n    getTransformUIPersistance,\n} from '../helpers/persist';\nimport { AppThunk, RootState } from '../index';\nimport { DateFilter } from './date-filter';\n\nexport type SelectionsState = {\n    data: {\n        [key: string]: {\n            items: Selection[];\n            updatedAt: number;\n        };\n    };\n    ui: {\n        [key: string]: {\n            isLoading: boolean;\n            isUpdating: boolean;\n        };\n    };\n};\n\nexport type Selection = {\n    code: string;\n    title: string;\n    count: number;\n    image: EventPreview['image'];\n};\n\nconst initialState: SelectionsState = {\n    data: {},\n    ui: {},\n};\nconst updateInterval = 300 * 1000;\n\nconst slice = createSlice({\n    name: 'selections',\n    initialState,\n    reducers: {\n        fetchStart(state, action: PayloadAction<{ key: string }>) {\n            const { key } = action.payload;\n\n            if (!state.data[key]) {\n                state.data[key] = {\n                    items: [],\n                    updatedAt: 0,\n                };\n            }\n            if (!state.ui[key]) {\n                state.ui[key] = {\n                    isLoading: false,\n                    isUpdating: false,\n                };\n            }\n\n            if (!state.data[key].items.length) {\n                state.ui[key].isLoading = true;\n            } else {\n                state.ui[key].isUpdating = true;\n            }\n        },\n        fetchSuccess(state, action: PayloadAction<{ key: string; items: SelectionsResponse['selections'] }>) {\n            const { key, items } = action.payload;\n\n            const selections: Selection[] = [];\n\n            for (const selection of items) {\n                if (!selection) {\n                    continue;\n                }\n\n                selections.push({\n                    code: selection.code,\n                    title: selection.title,\n                    count: selection.count,\n                    image:\n                        selection.events &&\n                        selection.events[0] &&\n                        selection.events[0].eventPreview &&\n                        selection.events[0].eventPreview.image,\n                });\n            }\n\n            state.data[key].items = selections;\n            state.data[key].updatedAt = Date.now();\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n        fetchError(state, action: PayloadAction<{ key: string; error: Error }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n    },\n});\n\nexport const { fetchStart, fetchSuccess, fetchError } = slice.actions;\n\nexport const selectionsSelector = (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.selections.data[persistKey];\n};\n\nexport const selectionsUISelector = (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.selections.ui[persistKey];\n};\n\nexport const loadSelections = (dateFilter: DateFilter, geoid: number): AppThunk => async(dispatch, getState) => {\n    const key = createPersistKeyByFilter({ geoid, ...dateFilter });\n    const selections = getState().selections.data[key];\n\n    if (selections && selections.updatedAt + updateInterval > Date.now()) {\n        return;\n    }\n\n    dispatch(fetchStart({ key: key }));\n\n    try {\n        const data = await fetchSelections({ ...dateFilter, geoid });\n        dispatch(fetchSuccess({ key, items: data.selections }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchError({ key: key, error: err }));\n    }\n};\n\nconst persistConfig = getPersistConfig<SelectionsState>('selections', {\n    stateReconciler: stateReconcilerByDate,\n    transforms: [getTransformUIPersistance<SelectionsState['ui']>(initialState.ui)],\n});\nexport default persistReducer(persistConfig, slice.reducer);\n","import { createRef, createContext, RefObject } from 'react';\n\ntype StackNavigatorContextType = {\n    onBackward: () => void;\n    isVisible: boolean;\n    ref: RefObject<HTMLDivElement>;\n};\n\nexport const StackNavigatorContext = createContext<StackNavigatorContextType>({\n    onBackward: () => {},\n    isVisible: false,\n    ref: createRef(),\n});\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"styles_card__2krq5\",\"image\":\"styles_image__3rHyi\",\"right\":\"styles_right__3yAG9\",\"title\":\"styles_title__1qP6K\",\"description\":\"styles_description__2Ze_3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"styles_input__ldYiA\",\"wrapper\":\"styles_wrapper__1qFlf\",\"wrapper-visible_yes\":\"styles_wrapper-visible_yes__3Xlii\",\"slideUp\":\"styles_slideUp__2GPyJ\",\"wrapper-visible_no\":\"styles_wrapper-visible_no__2Kq0Z\",\"slideDown\":\"styles_slideDown__3yIqZ\",\"city-list\":\"styles_city-list__2FmDB\",\"city-item\":\"styles_city-item__TNmcc\"};","import React from 'react';\n\nimport styles from './styles.module.css';\n\nexport type Props = {\n    className?: string;\n    onClick: () => void;\n};\nconst ClearButton: React.FC<Props> = ({ className, children, onClick }) => {\n    const cls = [styles.clear, className].filter(Boolean).join(' ');\n    return (\n        <button className={cls} onClick={onClick}>\n            {children}\n        </button>\n    );\n};\n\nexport default ClearButton;\n","import { AppErrorCode } from '../error';\nimport { callJsApi } from './utils';\n\nexport async function reportGoalReached(goal: string, params: object): Promise<void> {\n    try {\n        await callJsApi({\n            name: 'window.yandex.app.reportGoalReached',\n            args: [goal, params],\n            scope: window?.yandex?.app,\n            method: 'reportGoalReached',\n        });\n    } catch (err) {\n        const { code } = err;\n\n        if (code === AppErrorCode.JsApiMethodNotAvailable) {\n            return;\n        }\n\n        console.error(err);\n    }\n}\n","import { Event } from '../api/fragments/event';\n\nimport { CurrencyCode } from './types';\n\nfunction getProductFromEvent(event: Event) {\n    const price = event.tickets?.[0]?.price?.min;\n\n    return {\n        id: event.id,\n        name: event.title,\n        category: event.type.name,\n        price: price ? price / 100 : undefined\n    };\n}\n\nfunction getEventCurrency(event: Event) {\n    return event.tickets?.[0]?.price?.currency.toUpperCase() as CurrencyCode | undefined;\n}\n\nexport function logProductView(event: Event) {\n    window.dataLayer.push({\n        ecommerce: {\n            currencyCode: getEventCurrency(event),\n            detail: {\n                products: [getProductFromEvent(event)]\n            }\n        }\n    });\n}\n\nexport function logProductAdd(event: Event) {\n    window.dataLayer.push({\n        ecommerce: {\n            currencyCode: getEventCurrency(event),\n            add: {\n                products: [getProductFromEvent(event)]\n            }\n        }\n    });\n}\n\nexport function logProductPurchase(event: Event, orderId: number) {\n    window.dataLayer.push({\n        ecommerce: {\n            currencyCode: getEventCurrency(event),\n            purchase: {\n                actionField: {\n                    id: orderId.toString(),\n                },\n                products: [getProductFromEvent(event)]\n            }\n        }\n    });\n}\n","export const DEFAULT_ITEMS_GAP = 18;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"styles_card__eFyRm\",\"image\":\"styles_image__1XdLR\",\"title\":\"styles_title__2aX7M\",\"description\":\"styles_description__hf2zy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__2ZLnU\",\"image\":\"styles_image__1OXdh\",\"stub\":\"styles_stub__2rGlh\",\"stub-hidden\":\"styles_stub-hidden__wNOO_\",\"fadeIn\":\"styles_fadeIn__Wb4n6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"styles_title__1IJnF\",\"events\":\"styles_events__3m_nB\",\"event\":\"styles_event__15ocv\",\"link\":\"styles_link__OwBgq\"};","import React, { useCallback, useState } from 'react';\n\nimport { MediaImageSize } from '../../lib/api/fragments/image-size';\n\nimport styles from './styles.module.css';\n\nconst emptyImage = 'data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=';\n\nexport type ImageProps = {\n    className?: string;\n    src?: MediaImageSize | null;\n    src2x?: MediaImageSize | null;\n    bgColor?: string | null;\n    alt?: string;\n};\n\nconst Image: React.FC<ImageProps> = props => {\n    const color = props.bgColor || '#555';\n    const [isLoaded, setLoaded] = useState(false);\n\n    const onLoad = useCallback(() => {\n        if (props.src) {\n            setLoaded(true);\n        }\n    }, [setLoaded, props.src]);\n    const stubClassNames = [styles.stub, isLoaded && styles['stub-hidden']].filter(Boolean).join(' ');\n    const containerClassNames = [props.className, styles.container].filter(Boolean).join(' ');\n\n    return (\n        <div className={containerClassNames}>\n            <img\n                className={styles.image}\n                onLoad={onLoad}\n                src={props.src ? props.src.url : emptyImage}\n                srcSet={props.src2x ? `${props.src2x.url} 2x` : undefined}\n                alt={props.alt}\n            />\n            <div className={stubClassNames} style={{ backgroundColor: color }} />\n        </div>\n    );\n};\n\nexport default Image;\n","import React from 'react';\n\nimport { Rect, Text } from '../../Skeletons';\n\nimport styles from './styles.module.css';\n\nconst EventCardSkeleton: React.FC = () => {\n    return (\n        <div className={styles.card}>\n            <Rect className={styles.image} />\n            <div className={styles.right}>\n                <Text className={styles.title} />\n                <Text className={styles.description} />\n            </div>\n        </div>\n    );\n};\n\nexport default EventCardSkeleton;\n","import React, { useMemo, useRef } from 'react';\n\nimport { StackNavigatorContext } from '../context';\nimport { Location, Params, ScreenComponent } from '../index';\n\nimport { isIOS } from '../../../lib/is-ios';\nimport styles from './styles.module.css';\n\nexport type ScreenType = {\n    id: string;\n    params: Params;\n    component: ScreenComponent;\n    location: Location;\n};\n\ntype Props = {\n    isVisible: boolean;\n    onBackward: () => void;\n    screen: ScreenType;\n    transitions?: boolean;\n};\n\nconst Screen: React.FC<Props> = ({ isVisible, transitions, screen, onBackward }) => {\n    const className = isIOS() ? '' : [styles.screen, !isVisible && !transitions && styles.hidden].filter(Boolean).join(' ');\n    const ref = useRef<HTMLDivElement>(null);\n\n    const context = useMemo(() => {\n        return {\n            onBackward,\n            isVisible,\n            ref,\n        };\n    }, [onBackward, isVisible, ref]);\n\n    return (\n        <StackNavigatorContext.Provider value={context}>\n            <div className={className} ref={ref}>\n                <screen.component params={screen.params} location={screen.location} />\n            </div>\n        </StackNavigatorContext.Provider>\n    );\n};\n\nexport default Screen;\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useLocation, matchPath, useHistory } from 'react-router-dom';\nimport { TransitionGroup, CSSTransition } from 'react-transition-group';\n\nimport { isIOS } from '../../lib/is-ios';\nimport Screen, { ScreenType } from './Screen';\nimport styles from './Screen/styles.module.css';\nimport { Screens, Params, ScreenConfig } from './index';\n\nconst classNames = {\n    enter: styles.screenEnter,\n    enterActive: styles.screenEnterActive,\n    exit: styles.screenExit,\n    exitActive: styles.screenExitActive,\n};\nconst transitionCallbacks = {\n    onEnter: (node: HTMLElement) => {\n        if (node.previousElementSibling) {\n            node.previousElementSibling.classList.add(styles.offset);\n        }\n    },\n\n    onExit: (node: HTMLElement) => {\n        if (node.previousElementSibling) {\n            node.previousElementSibling.classList.remove(styles.offset);\n        }\n    },\n};\nconst transitionTimeouts = {\n    enter: 600, // Сама анимация 300ms + поправка на медленные девайсы\n    exit: 500, // Сама анимация 250ms + поправка на медленные девайсы\n};\n\ntype ScreenStack = Array<ScreenType>;\n\ntype Props = {\n    screens: Screens;\n    maxDepth?: number;\n    transitions?: boolean;\n};\n\nexport type BackwardProps = { fallback?: string };\n\nconst StackNavigator: React.FC<Props> = ({ screens, maxDepth = 10, transitions = false }) => {\n    const [stack, setStack] = useState<ScreenStack>([]);\n    const location = useLocation();\n    const history = useHistory();\n    const iOS = isIOS();\n\n    useLocationChange(() => {\n        if (iOS) {\n            window.scrollTo(0, 0);\n        }\n\n        const isBackward = history.action === 'POP';\n        const isReplace = history.action === 'REPLACE';\n\n        // Если навигация «назад» и в стеке есть отрисованный предыдущий экран, то просто удаляем последний экран\n        if (isBackward && stack.length > 1) {\n            setStack(stack.slice(0, -1));\n            return;\n        }\n\n        let screen: ScreenConfig | null = null;\n        let match: ReturnType<typeof matchPath> = null;\n\n        for (const item of screens) {\n            match = matchPath(location.pathname, item);\n\n            if (match) {\n                screen = item;\n                break;\n            }\n        }\n\n        if (!screen || !match) {\n            console.warn('No screen matched for route', location.pathname);\n            return;\n        }\n\n        const newStackItem: ScreenStack[0] = {\n            id: location.key || Date.now().toString(),\n            component: screen.component,\n            params: match.params as Params,\n            location: { ...location },\n        };\n\n        // Если навигация «назад», то просто заменяем единственный экран в стеке\n        if (isBackward && stack.length === 1) {\n            setStack([newStackItem]);\n            return;\n        }\n\n        // Если делается замена текущего урла, то просто перерисовываем текущий экран\n        if (isReplace) {\n            if (screen.component === stack[stack.length - 1].component) {\n                const newStack = [...stack];\n\n                newStack[stack.length - 1] = {\n                    ...newStack[stack.length - 1],\n                    params: newStackItem.params,\n                    location: newStackItem.location,\n                };\n\n                setStack(newStack);\n            } else {\n                setStack([...stack.slice(0, -1), newStackItem]);\n            }\n            return;\n        }\n\n        // Навигация «вперед», добавляем новый экран в стек\n        const newStack = [...stack, newStackItem];\n\n        // При достижении лимита количенства одновременно отрисованных экранов начинаем удалять старые экраны\n        if (newStack.length > maxDepth) {\n            newStack.splice(0, stack.length - maxDepth + 1);\n        }\n\n        setStack(newStack);\n    });\n\n    const onBackward = useCallback(\n        ({ fallback }: BackwardProps = {}) => {\n            if (iOS) {\n                window.scrollTo(0, 0);\n            }\n\n            if (history.length > 1) {\n                history.goBack();\n            } else if (fallback) {\n                history.replace(fallback);\n            }\n        },\n        [history, iOS]\n    );\n\n    if (transitions && !iOS) {\n        return (\n            <TransitionGroup component={null}>\n                {stack.map((screen, index) => {\n                    return (\n                        <CSSTransition\n                            key={screen.id}\n                            timeout={transitionTimeouts}\n                            classNames={classNames}\n                            enter={stack.length !== 1}\n                            exit={stack.length !== 1}\n                            onEnter={transitionCallbacks.onEnter}\n                            onExit={transitionCallbacks.onExit}\n                        >\n                            <Screen\n                                key={screen.id}\n                                isVisible={index === stack.length - 1}\n                                transitions\n                                onBackward={onBackward}\n                                screen={screen}\n                            />\n                        </CSSTransition>\n                    );\n                })}\n            </TransitionGroup>\n        );\n    }\n\n    if (iOS) {\n        const screen = stack[stack.length - 1];\n\n        return screen ? <Screen isVisible onBackward={onBackward} screen={screen} /> : null;\n    }\n\n    return (\n        <>\n            {stack.map((screen, index) => {\n                return (\n                    <Screen\n                        key={screen.id}\n                        isVisible={index === stack.length - 1}\n                        onBackward={onBackward}\n                        screen={screen}\n                    />\n                );\n            })}\n        </>\n    );\n};\n\n// Хак с useEffect, который вызывается только при изменении Location\n// Позволяет обойти линтинг зависимостией в хуке useEffect\nfunction useLocationChange(callback: () => void) {\n    const location = useLocation();\n\n    useEffect(callback, [location]);\n}\n\nexport default StackNavigator;\n","import React from 'react';\nimport { RouteProps, useLocation } from 'react-router-dom';\n\nimport { isIOS } from '../../lib/is-ios';\nimport StackNavigator from './StackNavigator';\n\nexport { useBackward, useScreenRef, useScreenVisible } from './hooks';\n\nexport type Params = Record<string, string>;\nexport type Location = ReturnType<typeof useLocation>;\n\nexport type ScreenProps = {\n    params: Params;\n    location: Location;\n};\n\nexport type ScreenComponent = React.FC<ScreenProps>;\n\nexport type ScreenConfig = RouteProps & {\n    component: ScreenComponent;\n};\n\nexport type Screens = ScreenConfig[];\nexport type Options = {\n    maxDepth?: number;\n    transitions?: boolean;\n};\n\nexport function createStackNavigator(screens: Screens, options: Options = {}) {\n    if (isIOS() && 'scrollRestoration' in window.history) {\n        window.history.scrollRestoration = 'manual';\n    }\n\n    return () => <StackNavigator screens={screens} maxDepth={options.maxDepth} transitions={options.transitions} />;\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { ActualEvent } from '../../lib/api/fragments/actual-event';\n\nimport { fetchActualEvents } from '../../lib/api';\nimport {\n    createPersistKeyByFilter,\n    stateReconcilerByDate,\n    getPersistConfig,\n    getTransformUIPersistance,\n} from '../helpers/persist';\nimport { setEvents } from './event';\nimport { DateFilter } from './date-filter';\nimport { AppThunk, RootState } from '..';\n\nexport type ActualEventsListState = {\n    data: {\n        [key: string]: {\n            items: Array<ActualEvent | null>;\n            updatedAt: number;\n        };\n    };\n    ui: {\n        [key: string]: {\n            isLoading: boolean;\n            isUpdating: boolean;\n        };\n    };\n};\n\nconst initialState: ActualEventsListState = {\n    data: {},\n    ui: {},\n};\nconst updateInterval = 300 * 1000;\n\nconst slice = createSlice({\n    name: 'actual-events',\n    initialState,\n    reducers: {\n        fetchStart(state, action: PayloadAction<{ key: string }>) {\n            const { key } = action.payload;\n\n            if (!state.data[key]) {\n                state.data[key] = {\n                    items: [],\n                    updatedAt: 0,\n                };\n            }\n            if (!state.ui[key]) {\n                state.ui[key] = {\n                    isLoading: false,\n                    isUpdating: false,\n                };\n            }\n\n            if (!state.data[key].items.length) {\n                state.ui[key].isLoading = true;\n            } else {\n                state.ui[key].isUpdating = true;\n            }\n        },\n        fetchSuccess(state, action: PayloadAction<{ key: string; items: Array<ActualEvent | null> }>) {\n            const { key, items } = action.payload;\n\n            state.data[key].items = items;\n            state.data[key].updatedAt = Date.now();\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n        fetchError(state, action: PayloadAction<{ key: string; error: Error }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n    },\n});\n\nexport const { fetchStart, fetchSuccess, fetchError } = slice.actions;\n\nexport const actualEventsSelector = (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.actualEvents.data[persistKey];\n};\n\nexport const actualEventsUISelector = (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.actualEvents.ui[persistKey];\n};\n\nexport const loadActualEvents = (dateFilter: DateFilter, geoid: number): AppThunk => async(dispatch, getState) => {\n    const key = createPersistKeyByFilter({ geoid, ...dateFilter });\n    const events = getState().actualEvents.data[key];\n\n    if (events && events.updatedAt + updateInterval > Date.now()) {\n        return;\n    }\n\n    dispatch(fetchStart({ key }));\n\n    try {\n        const { events } = await fetchActualEvents({ ...dateFilter, geoid });\n\n        if (events.prefetchItems) {\n            dispatch(setEvents({ events: events.prefetchItems }));\n            delete events.prefetchItems;\n        }\n\n        dispatch(fetchSuccess({ key, items: events.items }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchError({ key, error: err }));\n    }\n};\n\nconst persistConfig = getPersistConfig<ActualEventsListState>('actual-events', {\n    stateReconciler: stateReconcilerByDate,\n    transforms: [getTransformUIPersistance<ActualEventsListState['ui']>(initialState.ui)],\n});\nexport default persistReducer(persistConfig, slice.reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { ActualEvents } from '../../lib/api/fragments/actual-events';\n\nimport { fetchRubricEvents } from '../../lib/api';\nimport {\n    createPersistKeyByFilter,\n    stateReconcilerByDate,\n    getPersistConfig,\n    getTransformUIPersistance,\n} from '../helpers/persist';\n\nimport { AppThunk, RootState } from '../index';\nimport { setEvents } from './event';\nimport { DateFilter } from './date-filter';\n\nexport type RubricEventsState = {\n    data: {\n        [key: string]: {\n            title: string;\n            events: ActualEvents;\n            hasMoreItems: boolean;\n            updatedAt: number;\n        };\n    };\n    ui: {\n        [key: string]: {\n            isLoading: boolean;\n            isLoadingMore: boolean;\n            isUpdating: boolean;\n        };\n    };\n};\n\nconst initialState: RubricEventsState = {\n    data: {},\n    ui: {},\n};\n\nconst loadMoreLimit = 10;\nconst updateInterval = 300 * 1000;\n\nconst slice = createSlice({\n    name: 'rubric-events',\n    initialState,\n    reducers: {\n        fetchStart(state, action: PayloadAction<{ key: string }>) {\n            const { key } = action.payload;\n\n            if (!state.data[key]) {\n                state.data[key] = {\n                    title: '',\n                    events: {\n                        items: [],\n                        paging: { offset: 0, total: 0 },\n                    },\n                    hasMoreItems: false,\n                    updatedAt: 0,\n                };\n            }\n            if (!state.ui[key]) {\n                state.ui[key] = {\n                    isLoading: false,\n                    isLoadingMore: false,\n                    isUpdating: false,\n                };\n            }\n\n            if (!state.data[key].events.items.length) {\n                state.ui[key].isLoading = true;\n            } else {\n                state.ui[key].isUpdating = true;\n            }\n        },\n        fetchSuccess(state, action: PayloadAction<{ key: string; events: ActualEvents; title: string }>) {\n            const { key, events, title } = action.payload;\n\n            state.data[key].title = title;\n            state.data[key].events = events;\n            state.data[key].hasMoreItems = Boolean(events.paging.total > events.paging.offset + loadMoreLimit);\n            state.data[key].updatedAt = Date.now();\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n        fetchError(state, action: PayloadAction<{ key: string; error: Error }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n        fetchMoreStart(state, action: PayloadAction<{ key: string }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoadingMore = true;\n        },\n        fetchMoreSuccess(state, action: PayloadAction<{ key: string; events: ActualEvents }>) {\n            const { key, events } = action.payload;\n\n            state.data[key].events.items.push(...events.items);\n            state.data[key].events.paging = events.paging;\n            state.data[key].hasMoreItems = Boolean(events.paging.total > events.paging.offset + loadMoreLimit);\n            state.data[key].updatedAt = Date.now();\n            state.ui[key].isLoadingMore = false;\n        },\n        fetchMoreError(state, action: PayloadAction<{ key: string; error: Error }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoadingMore = false;\n        },\n    },\n});\n\nexport const { fetchStart, fetchSuccess, fetchError, fetchMoreStart, fetchMoreSuccess, fetchMoreError } = slice.actions;\n\nexport const rubricEventsSelector = (code: string) => (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        code,\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.rubricEvents.data[persistKey];\n};\n\nexport const rubricEventsUISelector = (code: string) => (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        code,\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.rubricEvents.ui[persistKey];\n};\n\nexport const loadRubricEvents = (code: string, dateFilter?: DateFilter): AppThunk => async(dispatch, getState) => {\n    const { geoid } = getState().city.currentCity;\n    const key = createPersistKeyByFilter({ geoid, code, ...dateFilter });\n    const events = getState().rubricEvents.data[key];\n\n    if (events && events.updatedAt + updateInterval > Date.now()) {\n        return;\n    }\n\n    dispatch(fetchStart({ key }));\n\n    try {\n        const { title, events } = await fetchRubricEvents(code, {\n            geoid,\n            offset: 0,\n            limit: loadMoreLimit,\n            ...dateFilter,\n        });\n\n        if (events.prefetchItems) {\n            dispatch(setEvents({ events: events.prefetchItems }));\n            delete events.prefetchItems;\n        }\n\n        dispatch(fetchSuccess({ key, title, events }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchError({ key, error: err }));\n    }\n};\n\nexport const loadMoreRubricEvents = (code: string, dateFilter?: DateFilter): AppThunk => async(dispatch, getState) => {\n    const { geoid } = getState().city.currentCity;\n    const key = createPersistKeyByFilter({ geoid, code, ...dateFilter });\n\n    dispatch(fetchMoreStart({ key }));\n\n    try {\n        const { offset } = getState().rubricEvents.data[key].events.paging;\n        const { events } = await fetchRubricEvents(code, {\n            geoid,\n            offset: offset + loadMoreLimit,\n            limit: loadMoreLimit,\n            ...dateFilter,\n        });\n\n        if (events.prefetchItems) {\n            dispatch(setEvents({ events: events.prefetchItems }));\n            delete events.prefetchItems;\n        }\n\n        dispatch(fetchMoreSuccess({ key, events }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchMoreError({ key, error: err }));\n    }\n};\n\nconst persistConfig = getPersistConfig<RubricEventsState>('rubric-events', {\n    stateReconciler: stateReconcilerByDate,\n    transforms: [getTransformUIPersistance<RubricEventsState['ui']>(initialState.ui)],\n});\nexport default persistReducer(persistConfig, slice.reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { fetchSelectionEvents } from '../../lib/api';\nimport { SelectionsResponse } from '../../lib/api/types';\nimport { ActualEvents } from '../../lib/api/fragments/actual-events';\n\nimport {\n    createPersistKeyByFilter,\n    restoreFilterFromPersistKey,\n    stateReconcilerByDate,\n    getPersistConfig,\n    getTransformUIPersistance,\n} from '../helpers/persist';\n\nimport { AppThunk, RootState } from '../index';\nimport { setEvents } from './event';\nimport { DateFilter } from './date-filter';\nimport { fetchSuccess as selectionsFetchSuccess } from './selections';\n\nexport type SelectionEventsState = {\n    data: {\n        [key: string]: {\n            title: string;\n            events: ActualEvents;\n            hasMoreItems: boolean;\n\n            updatedAt: number;\n        };\n    };\n    ui: { [key: string]: { isLoading: boolean; isLoadingMore: boolean; isUpdating: boolean } };\n};\n\nconst initialState: SelectionEventsState = {\n    data: {},\n    ui: {},\n};\n\nconst loadMoreLimit = 10;\nconst updateInterval = 300 * 1000;\n\nconst slice = createSlice({\n    name: 'selection-events',\n    initialState,\n    reducers: {\n        fetchStart(state, action: PayloadAction<{ key: string }>) {\n            const { key } = action.payload;\n\n            if (!state.data[key]) {\n                state.data[key] = {\n                    title: '',\n                    events: {\n                        items: [],\n                        paging: { offset: 0, total: 0 },\n                    },\n                    hasMoreItems: false,\n\n                    updatedAt: 0,\n                };\n            }\n            if (!state.ui[key]) {\n                state.ui[key] = {\n                    isLoading: false,\n                    isLoadingMore: false,\n                    isUpdating: false,\n                };\n            }\n\n            if (!state.data[key].events.items.length) {\n                state.ui[key].isLoading = true;\n            } else {\n                state.ui[key].isUpdating = true;\n            }\n        },\n        fetchSuccess(state, action: PayloadAction<{ key: string; events: ActualEvents; title: string }>) {\n            const { key, events, title } = action.payload;\n\n            state.data[key].title = title;\n            state.data[key].events = events;\n            state.data[key].hasMoreItems = Boolean(events.paging.total > events.paging.offset + loadMoreLimit);\n            state.data[key].updatedAt = Date.now();\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n        fetchError(state, action: PayloadAction<{ key: string; error: Error }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n        fetchMoreStart(state, action: PayloadAction<{ key: string }>) {\n            const { key } = action.payload;\n\n            if (!state.data[key]) {\n                state.data[key] = {\n                    title: '',\n                    events: {\n                        items: [],\n                        paging: { offset: 0, total: 0 },\n                    },\n                    hasMoreItems: false,\n\n                    updatedAt: 0,\n                };\n            }\n            if (!state.ui[key]) {\n                state.ui[key] = {\n                    isLoading: false,\n                    isLoadingMore: false,\n                    isUpdating: false,\n                };\n            }\n\n            state.ui[key].isLoadingMore = true;\n        },\n        fetchMoreSuccess(state, action: PayloadAction<{ key: string; events: ActualEvents }>) {\n            const { key, events } = action.payload;\n\n            state.data[key].events.items.push(...events.items);\n            state.data[key].events.paging = events.paging;\n            state.data[key].hasMoreItems = Boolean(events.paging.total > events.paging.offset + loadMoreLimit);\n            state.data[key].updatedAt = Date.now();\n            state.ui[key].isLoadingMore = false;\n        },\n        fetchMoreError(state, action: PayloadAction<{ key: string; error: Error }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoadingMore = false;\n        },\n    },\n    extraReducers: builder => {\n        // Предзаполнение списка событий для всех подборок, загруженных на главной странице\n        builder.addCase(\n            selectionsFetchSuccess,\n            (state, action: PayloadAction<{ key: string; items: SelectionsResponse['selections'] }>) => {\n                const { key, items } = action.payload;\n                const filter = restoreFilterFromPersistKey(key);\n\n                for (const selection of items) {\n                    if (!selection) {\n                        continue;\n                    }\n\n                    const eventsKey = createPersistKeyByFilter({ code: selection.code, ...filter });\n                    const events = {\n                        items: selection.events,\n                        paging: { offset: 0, total: selection.count },\n                    };\n\n                    if (!state.data[eventsKey]) {\n                        state.data[eventsKey] = {\n                            title: selection.title,\n                            events,\n                            hasMoreItems: Boolean(selection.count > loadMoreLimit),\n                            // При переходе в подборку нужно обновить заголовок, поэтому считаем что данные не загружены\n                            updatedAt: 0,\n                        };\n                        state.ui[eventsKey] = {\n                            isLoading: false,\n                            isLoadingMore: false,\n                            isUpdating: false,\n                        };\n                    } else {\n                        state.data[eventsKey].events = events;\n                        state.data[eventsKey].hasMoreItems = Boolean(selection.count > loadMoreLimit);\n                        state.data[eventsKey].updatedAt = Date.now();\n                    }\n                }\n            }\n        );\n    },\n});\n\nexport const { fetchStart, fetchSuccess, fetchError, fetchMoreStart, fetchMoreSuccess, fetchMoreError } = slice.actions;\n\nexport const selectionEventsSelector = (code: string) => (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        code,\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.selectionEvents.data[persistKey];\n};\n\nexport const selectionEventsUISelector = (code: string) => (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        code,\n        geoid: state.city.currentCity.geoid,\n        ...state.dateFilter,\n    });\n\n    return state.selectionEvents.ui[persistKey];\n};\n\nexport const loadSelectionEvents = (code: string, dateFilter?: DateFilter): AppThunk => async(dispatch, getState) => {\n    const { geoid } = getState().city.currentCity;\n    const key = createPersistKeyByFilter({ geoid, code, ...dateFilter });\n    const events = getState().selectionEvents.data[key];\n\n    if (events && events.updatedAt + updateInterval > Date.now()) {\n        return;\n    }\n\n    dispatch(fetchStart({ key }));\n\n    try {\n        const { title, events } = await fetchSelectionEvents(code, {\n            geoid,\n            offset: 0,\n            limit: loadMoreLimit,\n            ...dateFilter,\n        });\n\n        if (events.prefetchItems) {\n            dispatch(setEvents({ events: events.prefetchItems }));\n            delete events.prefetchItems;\n        }\n\n        dispatch(fetchSuccess({ key, title, events }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchError({ key, error: err }));\n    }\n};\n\nexport const loadMoreSelectionEvents = (code: string, dateFilter?: DateFilter): AppThunk => async(\n    dispatch,\n    getState\n) => {\n    const { geoid } = getState().city.currentCity;\n    const key = createPersistKeyByFilter({ geoid, code, ...dateFilter });\n\n    dispatch(fetchMoreStart({ key }));\n\n    try {\n        const { offset } = getState().selectionEvents.data[key].events.paging;\n        const { events } = await fetchSelectionEvents(code, {\n            geoid,\n            offset: offset + loadMoreLimit,\n            limit: loadMoreLimit,\n            ...dateFilter,\n        });\n\n        if (events.prefetchItems) {\n            dispatch(setEvents({ events: events.prefetchItems }));\n            delete events.prefetchItems;\n        }\n\n        dispatch(fetchMoreSuccess({ key, events }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchMoreError({ key, error: err }));\n    }\n};\n\nconst persistConfig = getPersistConfig<SelectionEventsState>('selection-events', {\n    stateReconciler: stateReconcilerByDate,\n    transforms: [getTransformUIPersistance<SelectionEventsState['ui']>(initialState.ui)],\n});\nexport default persistReducer(persistConfig, slice.reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { ActualEvents } from '../../lib/api/fragments/actual-events';\n\nimport { fetchRecommendedEvents } from '../../lib/api';\nimport {\n    createPersistKeyByFilter,\n    stateReconcilerByDate,\n    getPersistConfig,\n    getTransformUIPersistance,\n} from '../helpers/persist';\nimport { setEvents } from './event';\nimport { AppThunk, RootState } from '..';\n\nexport type RecommendedEvents = {\n    top?: ActualEvents;\n    concert?: ActualEvents;\n    cinema?: ActualEvents;\n    theatre?: ActualEvents;\n    updatedAt: number;\n};\nexport type RecommendedEventsState = {\n    data: { [key: string]: RecommendedEvents };\n    ui: { [key: string]: { isLoading: boolean; isUpdating: boolean } };\n};\n\nconst initialState: RecommendedEventsState = {\n    data: {},\n    ui: {},\n};\nconst updateInterval = 300 * 1000;\n\nconst slice = createSlice({\n    name: 'recommended-events',\n    initialState,\n    reducers: {\n        fetchStart(state, action: PayloadAction<{ key: string }>) {\n            const { key } = action.payload;\n\n            if (!state.data[key]) {\n                state.data[key] = { updatedAt: 0 };\n            }\n            if (!state.ui[key]) {\n                state.ui[key] = { isLoading: false, isUpdating: false };\n            }\n\n            if (!state.data[key].updatedAt) {\n                state.ui[key].isLoading = true;\n            } else {\n                state.ui[key].isUpdating = true;\n            }\n        },\n        fetchSuccess(\n            state,\n            action: PayloadAction<{\n                key: string;\n                data: Pick<RecommendedEvents, 'top' | 'concert' | 'cinema' | 'theatre'>;\n            }>\n        ) {\n            const { key, data } = action.payload;\n\n            state.data[key].top = data.top;\n            state.data[key].concert = data.concert;\n            state.data[key].cinema = data.cinema;\n            state.data[key].theatre = data.theatre;\n            state.data[key].updatedAt = Date.now();\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n        fetchError(state, action: PayloadAction<{ key: string; error: Error }>) {\n            const { key } = action.payload;\n\n            state.ui[key].isLoading = false;\n            state.ui[key].isUpdating = false;\n        },\n    },\n});\n\nexport const { fetchStart, fetchSuccess, fetchError } = slice.actions;\n\nexport const recommendedEventsSelector = (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        geoid: state.city.currentCity.geoid,\n    });\n\n    return state.recommendedEvents.data[persistKey];\n};\n\nexport const recommendedEventsUISelector = (state: RootState) => {\n    const persistKey = createPersistKeyByFilter({\n        geoid: state.city.currentCity.geoid,\n    });\n\n    return state.recommendedEvents.ui[persistKey];\n};\n\nexport const loadRecommendedEvents = (): AppThunk => async(dispatch, getState) => {\n    const { geoid } = getState().city.currentCity;\n    const key = createPersistKeyByFilter({ geoid });\n    const events = getState().recommendedEvents.data[key];\n\n    if (events && events.updatedAt + updateInterval > Date.now()) {\n        return;\n    }\n\n    dispatch(fetchStart({ key }));\n\n    try {\n        const data = await fetchRecommendedEvents({ geoid });\n\n        dispatch(\n            setEvents({\n                events: [\n                    ...(data.top?.prefetchItems || []),\n                    ...(data.cinema?.prefetchItems || []),\n                    ...(data.concert?.prefetchItems || []),\n                    ...(data.theatre?.prefetchItems || []),\n                ],\n            })\n        );\n\n        if (data.top?.prefetchItems) delete data.top.prefetchItems;\n        if (data.cinema?.prefetchItems) delete data.cinema.prefetchItems;\n        if (data.concert?.prefetchItems) delete data.concert.prefetchItems;\n        if (data.theatre?.prefetchItems) delete data.theatre.prefetchItems;\n\n        dispatch(fetchSuccess({ key, data }));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchError({ key, error: err }));\n    }\n};\n\nconst persistConfig = getPersistConfig<RecommendedEventsState>('recommended-events', {\n    stateReconciler: stateReconcilerByDate,\n    transforms: [getTransformUIPersistance<RecommendedEventsState['ui']>(initialState.ui)],\n});\nexport default persistReducer(persistConfig, slice.reducer);\n","import React, { forwardRef } from 'react';\n\nimport styles from './styles.module.css';\n\ntype Props = JSX.IntrinsicElements['input'];\nconst TextInput = forwardRef<HTMLInputElement, Props>(({ className, type, ...props }, ref) => {\n    const cls = [styles.input, className].filter(Boolean).join(' ');\n\n    return <input ref={ref} type={type || 'text'} className={cls} {...props} />;\n});\n\nexport default TextInput;\n","const GEOLOCATIONS_OPTIONS = {\n    timeout: 10000,\n    maximumAge: 60 * 60 * 1000,\n};\n\nexport async function getCurrentPosition(): Promise<Coordinates> {\n    return new Promise((resolve, reject) => {\n        const resolveCallback = (position: Position) => resolve(position.coords);\n\n        window.navigator.geolocation.getCurrentPosition(resolveCallback, reject, GEOLOCATIONS_OPTIONS);\n    });\n}\n\nfunction deg2rad(deg: number) {\n    return deg * (Math.PI / 180);\n}\n\n// http://en.wikipedia.org/wiki/Haversine_formula\nexport function getDistanceBetweenPoints(lat1: number, lon1: number, lat2: number, lon2: number): number {\n    const R = 6371; // Радиус земли в КМ\n\n    const tmp =\n        Math.sin(deg2rad(lat2 - lat1) / 2) * Math.sin(deg2rad(lat2 - lat1) / 2) +\n        Math.cos(deg2rad(lat1)) *\n            Math.cos(deg2rad(lat2)) *\n            Math.sin(deg2rad(lon2 - lon1) / 2) *\n            Math.sin(deg2rad(lon2 - lon1) / 2);\n\n    return 2 * R * Math.asin(Math.sqrt(tmp));\n}\n","import React from 'react';\n\nimport Button from '../ClearButton';\nimport { useBackward } from '../StackNavigator/hooks';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    fill?: 'white' | 'black';\n    className?: string;\n};\n\nconst BackwardIcon: React.FC<Props> = ({ fill = 'white' }) => {\n    const classNames = [styles['backward-icon'], styles[`icon-${fill}`]].join(' ');\n\n    return <span className={classNames} />;\n};\n\nconst Backward: React.FC<Props> = props => {\n    const onClick = useBackward();\n\n    return (\n        <Button className={[styles['backward-button'], props.className].filter(Boolean).join(' ')} onClick={onClick}>\n            <BackwardIcon fill={props.fill} />\n        </Button>\n    );\n};\n\nexport default Backward;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"backward-icon\":\"styles_backward-icon__3EK-Q\",\"icon-white\":\"styles_icon-white__30Xrl\",\"icon-black\":\"styles_icon-black__1FNaZ\",\"backward-button\":\"styles_backward-button__d5kZC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"styles_content__2Cnjx\",\"title\":\"styles_title__XAM43\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__2LqZR\",\"image\":\"styles_image__9Aiab\",\"username\":\"styles_username__MPrq4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading\":\"styles_loading__l2xXc\",\"rect\":\"styles_rect__39Mf0\",\"text\":\"styles_text__O_35F\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"styles_block__fQZVR\",\"filter\":\"styles_filter__2Vym1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"styles_block__10trK\",\"item\":\"styles_item__2uVU7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"styles_content__3nFVw\",\"title\":\"styles_title__2inpl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"style_list__3pVg_\",\"wrapper\":\"style_wrapper__IWliN\",\"button\":\"style_button__2GIxG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"price\":\"styles_price__1D8ax\",\"left\":\"styles_left__3RisO\",\"right\":\"styles_right__3KXqq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"styles_title__3XLML\",\"notFound\":\"styles_notFound__2R52E\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"styles_title__3xg9O\",\"event\":\"styles_event__3FTWc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"styles_header__2L4R0\",\"content\":\"styles_content__1NmrT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__2CjIh\",\"button\":\"styles_button__1zNzf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"styles_wrapper__15WSd\",\"select\":\"styles_select__1BaqC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"checkbox\":\"styles_checkbox__3iL51\",\"label\":\"styles_label__3hGrm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"action\":\"styles_action__13iH4\",\"invalid\":\"styles_invalid__1yKSC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"city-modal\":\"styles_city-modal__1AgdR\",\"city-modal-visible_yes\":\"styles_city-modal-visible_yes__3Ub-H\",\"fadeIn\":\"styles_fadeIn__26BAg\",\"city-modal-visible_no\":\"styles_city-modal-visible_no__1NmRJ\",\"fadeOut\":\"styles_fadeOut__1X9f5\"};","import { useEffect } from 'react';\n\nimport { useScreenVisible } from '../components/StackNavigator';\nimport { hit } from '../lib/metrika';\nimport { YMetrikaVisitParams } from '../lib/metrika/types';\n\nexport function useMetrikaHit(params?: YMetrikaVisitParams) {\n    const isVisible = useScreenVisible();\n\n    useEffect(() => {\n        if (isVisible) {\n            hit(window.location.href, { params });\n        }\n    }, [isVisible, params]);\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { dateToString } from '../../lib/date';\n\nexport type DateFilter = {\n    date: string;\n    period: number;\n};\n\nconst initialState: DateFilter = {\n    date: dateToString(new Date()).toString(),\n    period: 1,\n};\n\nconst dateFilter = createSlice({\n    name: 'date-filter',\n    initialState,\n    reducers: {\n        setDate(state, action: PayloadAction<{ date: string; period?: number }>) {\n            state.date = action.payload.date;\n            state.period = action.payload.period || 1;\n        },\n    },\n});\n\nexport const { setDate } = dateFilter.actions;\n\nexport default dateFilter.reducer;\n","import { format, parse } from 'date-fns';\n\nexport const dateToString = (date: Date) => format(date, 'YYYY-MM-DD').toString();\nexport const parseDate = (date: string) => parse(date);\n","import { RefObject, useEffect, useMemo } from 'react';\n\nimport { useVisible } from './useVisible';\n\ntype InfiniteScrollOptions = {\n    ref: RefObject<HTMLElement>;\n    isLoading: boolean;\n    hasMore: boolean;\n    loadMore: () => void;\n    threshold?: number;\n};\n\nexport function useInfiniteScroll({ threshold, ref, isLoading, loadMore, hasMore }: InfiniteScrollOptions) {\n    const options = useMemo<IntersectionObserverInit>(() => {\n        return {\n            rootMargin: `0px 0px ${threshold || 0}px 0px`,\n        };\n    }, [threshold]);\n\n    const needLoadMore = useVisible(ref, options) || false;\n\n    useEffect(() => {\n        if (!hasMore) return;\n        if (isLoading) return;\n\n        if (needLoadMore) {\n            loadMore();\n        }\n    }, [needLoadMore, loadMore, hasMore, isLoading]);\n}\n","import { RefObject, useLayoutEffect, useState, useRef } from 'react';\n\nexport function useVisible(ref: RefObject<HTMLElement>, options?: IntersectionObserverInit) {\n    // Пока не навешан обработчик на элемент, мы точно не можем сказать видим он или нет,\n    // поэтому начальное значение undefined\n    const [isVisible, setVisible] = useState<boolean>();\n    const optionsRef = useRef(options);\n\n    useLayoutEffect(() => {\n        if (!ref.current) {\n            return;\n        }\n\n        if (options !== optionsRef.current && process.env.NODE_ENV === 'development') {\n            optionsRef.current = options;\n\n            console.warn(\n                '[useVisible] Изменились опции для IntersectionObserver. Это может приводить к существенному падению производительности при скролле.'\n            );\n        }\n\n        const observer = new IntersectionObserver(([entry]) => {\n            setVisible(entry.isIntersecting);\n        }, options);\n\n        observer.observe(ref.current);\n\n        return () => {\n            observer.disconnect();\n        };\n    }, [ref, options]);\n\n    return isVisible;\n}\n","import React, { ReactElement, useRef } from 'react';\n\nimport { ActualEvent } from '../../lib/api/fragments/actual-event';\nimport { useInfiniteScroll } from '../../hooks/useInfiniteScroll';\nimport { usePaginatedList } from '../../hooks/usePaginatedList';\n\nimport { DEFAULT_ITEMS_GAP } from './constants';\n\nimport styles from './style.module.css';\n\ntype BaseProps = {\n    items: Array<ActualEvent | null>;\n    component: React.FC<{ event: ActualEvent; onClick?: () => void }>;\n    onItemClick?: () => void;\n    itemsGap?: number;\n};\n\ntype StaticProps = BaseProps & {\n    type?: 'static';\n};\n\ntype LoadableProps = BaseProps & {\n    type: 'loadable';\n    pageSize: number;\n    loadMore: () => void;\n    hasMore: boolean;\n    isLoadingMore: boolean;\n    skeleton: ReactElement;\n};\n\ntype Props = StaticProps | LoadableProps;\n\nconst EventsList: React.FC<Props> = props => {\n    const { itemsGap = DEFAULT_ITEMS_GAP } = props;\n\n    if (props.type === 'loadable') {\n        return <EventsListLoadable {...props} />;\n    }\n\n    return (\n        <div className={styles.list} style={{ gridGap: `${itemsGap}px` }}>\n            <EventsListItems {...props} />\n        </div>\n    );\n};\n\nconst EventsListLoadable: React.FC<LoadableProps> = props => {\n    const { itemsGap = DEFAULT_ITEMS_GAP } = props;\n    const loadMoreRef = useRef<HTMLDivElement | null>(null);\n\n    const [events, hasMore, loadMore] = usePaginatedList({\n        items: props.items,\n        hasMore: props.hasMore,\n        loadMore: props.loadMore,\n        pageSize: props.pageSize,\n    });\n\n    useInfiniteScroll({\n        ref: loadMoreRef,\n        isLoading: props.isLoadingMore,\n        hasMore,\n        loadMore,\n        threshold: 200,\n    });\n\n    return (\n        <div className={styles.list} style={{ gridGap: `${itemsGap}px` }}>\n            <EventsListItems {...props} items={events} />\n            {props.isLoadingMore && props.skeleton}\n            <div ref={loadMoreRef} />\n        </div>\n    );\n};\n\nconst EventsListItems: React.FC<BaseProps> = props => {\n    return (\n        <>\n            {props.items.map((actualEvent, index) => {\n                if (!actualEvent) {\n                    return null;\n                }\n\n                return <props.component key={index} event={actualEvent} onClick={props.onItemClick} />;\n            })}\n        </>\n    );\n};\n\nexport default EventsList;\n","import { useCallback, useMemo, useState } from 'react';\n\ntype PaginatedListOptions<T> = {\n    items: T[];\n    hasMore: boolean;\n    loadMore: () => void;\n    pageSize: number;\n};\n\nexport function usePaginatedList<T>(options: PaginatedListOptions<T>): [T[], boolean, () => void] {\n    const { items, hasMore, loadMore, pageSize } = options;\n\n    const [limit, setLimit] = useState(pageSize);\n    const events = useMemo(() => items.slice(0, limit), [items, limit]);\n\n    const wrappedLoadMore = useCallback(() => {\n        if (items.length > limit) {\n            setLimit(limit + pageSize);\n        } else {\n            loadMore();\n        }\n    }, [loadMore, limit, pageSize, items]);\n\n    const wrappedHasMore = hasMore || limit < items.length;\n\n    return [events, wrappedHasMore, wrappedLoadMore];\n}\n","import React, { memo } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport { getEventUrl } from '../../lib/url-builder';\nimport { ActualEvent } from '../../lib/api/fragments/actual-event';\n\nimport Image from '../Image';\nimport PriceLabel from '../PriceLabel';\n\nimport styles from './style.module.css';\n\nexport type Props = {\n    event: ActualEvent;\n    onClick?: () => void;\n};\n\nconst EventCard: React.FC<Props> = props => {\n    const { id, title, argument, image, tickets } = props.event.eventPreview;\n    const ticket = tickets && tickets[0];\n\n    return (\n        <Link to={getEventUrl(id)} className={styles.card} onClick={props.onClick}>\n            <div className={styles['image-wrapper']}>\n                {image && image.eventListCard ? (\n                    <Image\n                        className={styles.image}\n                        alt={title}\n                        src={image.eventListCard}\n                        src2x={image.eventListCard2x}\n                        bgColor={image.bgColor}\n                    />\n                ) : (\n                    <div className={styles.preview} />\n                )}\n                {ticket && <PriceLabel ticket={ticket} position={'left'} />}\n                {image && <div className={styles['image-overlay']} />}\n            </div>\n            <div className={styles.description}>\n                <div className={styles.title}>{title}</div>\n                <div className={styles.annotation}>{argument}</div>\n            </div>\n        </Link>\n    );\n};\n\nexport default memo(EventCard);\n","import React from 'react';\n\nimport { Ticket } from '../../lib/api/fragments/ticket';\nimport TicketPrice from '../TicketPrice';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    ticket: Ticket;\n    position?: 'left' | 'right';\n};\n\nconst PriceLabel: React.FC<Props> = props => (\n    <div className={[styles.price, styles[props.position || 'left']].join(' ')}>\n        <TicketPrice ticket={props.ticket} />\n    </div>\n);\n\nexport default PriceLabel;\n","import React from 'react';\n\nimport { Ticket } from '../../lib/api/fragments/ticket';\nimport { getCurrencySymbol } from '../../lib/price';\n\ntype Props = {\n    ticket: Ticket;\n    exact?: boolean;\n};\n\nconst space = '\\u00A0';\n\nconst TicketPrice: React.FC<Props> = ({ ticket, exact }) => {\n    if (!ticket.price || !ticket.price.min) {\n        return null;\n    }\n\n    const text = [\n        exact ? '' : `от${space}`,\n        (ticket.price.min || 0) / 100,\n        space,\n        getCurrencySymbol(ticket.price.currency),\n    ].filter(Boolean).join(space);\n\n    return <>{text}</>;\n};\n\nexport default TicketPrice;\n","import React, { ButtonHTMLAttributes, forwardRef, ReactNode } from 'react';\n\nimport styles from './styles.module.css';\n\nexport type Props = {\n    type?: ButtonHTMLAttributes<HTMLButtonElement>['type'];\n    className?: string;\n    disabled?: boolean;\n    formInvalid?: boolean;\n    onClick?: () => void;\n    children: ReactNode;\n};\nconst ActionButton = forwardRef<HTMLButtonElement, Props>(\n    ({ type, className, disabled, formInvalid, children, onClick }, ref) => {\n        const cls = [styles.action, className, formInvalid && styles.invalid].filter(Boolean).join(' ');\n        return (\n            <button ref={ref} type={type} className={cls} onClick={onClick} disabled={disabled}>\n                {children}\n            </button>\n        );\n    }\n);\n\nexport default ActionButton;\n","import React from 'react';\n\nimport { Rect } from '../../Skeletons';\n\nimport styles from './styles.module.css';\n\nconst EventCardMainSkeleton: React.FC = () => {\n    return <Rect className={styles.card} />;\n};\n\nexport default EventCardMainSkeleton;\n","import React from 'react';\n\nimport { Rect } from '../../Skeletons';\n\nimport styles from './styles.module.css';\n\nconst SelectionListSkeleton: React.FC<{ className?: string }> = ({ className }) => {\n    return (\n        <div className={[styles.block, className].filter(Boolean).join(' ')}>\n            {Array(5)\n                .fill(0)\n                .map((_, index) => (\n                    <Rect key={index} className={styles.item} />\n                ))}\n        </div>\n    );\n};\n\nexport default SelectionListSkeleton;\n","import { Currency } from './api/fragments/ticket';\n\nconst currencySymbol: { [key in Currency]: string } = {\n    rub: '₽',\n    usd: '$',\n};\n\nexport function getCurrencySymbol(currency: Currency) {\n    return currencySymbol[currency];\n}\n","import { AppError, AppErrorCode } from '../error';\nimport { callJsApi } from './utils';\n\nexport enum YandexProfileField {\n    Name = 'name',\n    Email = 'email',\n    Phone = 'phone',\n    Address = 'address',\n}\n\nexport type YandexProfileData = {\n    firstName: string;\n    lastName: string;\n    middleName: string;\n    phoneNumber: string;\n    email: string;\n    streetAddress: string;\n};\n\nexport async function getProfileData(profileFields: Array<YandexProfileField>): Promise<YandexProfileData> {\n    try {\n        return await callJsApi({\n            name: 'window.yandex.autofill.getProfileData',\n            args: [profileFields],\n            scope: window?.yandex?.autofill,\n            method: 'getProfileData',\n        });\n    } catch (err) {\n        const { code } = err;\n\n        if (code === 'denied') {\n            throw new AppError(AppErrorCode.JsApiDenied, 'Autofill denied.');\n        }\n\n        throw err;\n    }\n}\n","import { getProfileData as jsApiGetProfileData, YandexProfileData, YandexProfileField } from './js-api/autofill';\n\nconst AUTOFILL_SDK = 'https://yastatic.net/s3/passport-sdk/autofill/v1/sdk-latest.js';\n\nconst autofillReadyPromise = new Promise<void>((resolve, reject) => {\n    if (window.yandex?.autofill?.getProfileData) {\n        return resolve();\n    }\n\n    // Загружаем скрипт для автоматического заполнения полей\n    const script = document.createElement('script');\n    const firstScript = document.getElementsByTagName('script')[0];\n\n    script.src = AUTOFILL_SDK;\n    script.async = true;\n    script.onload = () => resolve();\n    script.onerror = () => reject();\n\n    firstScript.parentNode?.insertBefore(script, firstScript);\n});\n\nexport async function getProfileData(): Promise<YandexProfileData> {\n    await autofillReadyPromise;\n\n    return jsApiGetProfileData([\n        YandexProfileField.Name,\n        YandexProfileField.Phone,\n        YandexProfileField.Email,\n        YandexProfileField.Address,\n    ]);\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { UserInfo } from '../../lib/api/types';\nimport { AppErrorCode } from '../../lib/error';\nimport { getProfileData } from '../../lib/autofill';\nimport { AppThunk, RootState } from '..';\n\ntype AutofillState = {\n    user?: UserInfo;\n};\n\nconst initialState: AutofillState = {};\n\nconst slice = createSlice({\n    name: 'autofill',\n    initialState,\n    reducers: {\n        setAutofilledUser(state, action: PayloadAction<UserInfo>) {\n            state.user = action.payload;\n        },\n    },\n});\n\nconst { setAutofilledUser } = slice.actions;\n\nexport const isAutofilledSelector = (state: RootState) => Boolean(state.autofill.user);\nexport const autofilledUserSelector = (state: RootState) => state.autofill.user;\n\nexport const autofill = (): AppThunk => async dispatch => {\n    try {\n        const {\n            email,\n            lastName,\n            firstName,\n            middleName,\n            phoneNumber: phone,\n            streetAddress: address,\n        } = await getProfileData();\n\n        const name = [lastName, firstName, middleName].filter(Boolean).join(' ');\n\n        dispatch(setAutofilledUser({ name, phone, email, address }));\n    } catch (err) {\n        const { code } = err;\n\n        if ([AppErrorCode.JsApiDenied, AppErrorCode.JsApiMethodNotAvailable].includes(code)) {\n            return console.warn(err);\n        }\n\n        console.error(err);\n    }\n};\n\nexport default slice.reducer;\n","import React from 'react';\n\nimport { Rect, Text } from '../../Skeletons';\n\nimport styles from './styles.module.css';\n\nexport const EventCardVerticalSkeleton: React.FC = () => (\n    <div className={styles.card}>\n        <Rect className={styles.image} />\n        <Text className={styles.title} />\n        <Text className={styles.description} />\n    </div>\n);\n","import React from 'react';\n\nimport { Text } from '../../../../../components/Skeletons';\nimport { EventCardVerticalSkeleton } from '../../../../../components/EventCardVertical/Skeleton';\n\nimport styles from './styles.module.css';\n\nexport const EventsFeedSkeleton: React.FC = () => (\n    <div className={styles.feed}>\n        <Text className={styles.title} />\n        <div className={styles.events}>\n            <div className={styles.item}>\n                <EventCardVerticalSkeleton />\n            </div>\n            <div className={styles.item}>\n                <EventCardVerticalSkeleton />\n            </div>\n            <div className={styles.item}>\n                <EventCardVerticalSkeleton />\n            </div>\n        </div>\n    </div>\n);\n","import React from 'react';\n\nimport { EventsFeedSkeleton } from '../../EventsFeed/Skeleton';\n\nconst RecommendedEventsSkeleton: React.FC = () => {\n    return (\n        <>\n            <EventsFeedSkeleton />\n            <EventsFeedSkeleton />\n            <EventsFeedSkeleton />\n            <EventsFeedSkeleton />\n        </>\n    );\n};\n\nexport default RecommendedEventsSkeleton;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"clear\":\"styles_clear__ZHIHN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"events\":\"styles_events__3RaZ8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"styles_card__1j4tU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"styles_input__2gjR5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"styles_input__1gPFI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"styles_title__354Bd\"};","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { fetchCityInfo, MOSCOW } from '../../lib/api';\nimport { getCurrentPosition } from '../../lib/geolocation';\nimport { getPersistConfig } from '../helpers/persist';\n\nimport { AppThunk } from '../index';\n\nimport { setItems as setMenuItems } from './menu';\n\nexport type City = {\n    useGeolocation: boolean;\n    isFetchingLocation: boolean;\n    currentCity: {\n        name: string;\n        geoid: number;\n        longitude: number;\n        latitude: number;\n    };\n};\n\nconst initialState: City = {\n    useGeolocation: true,\n    isFetchingLocation: false,\n    currentCity: MOSCOW,\n};\n\nconst city = createSlice({\n    name: 'city',\n    initialState,\n    reducers: {\n        setCity(state, action: PayloadAction<City['currentCity']>) {\n            state.currentCity = action.payload;\n        },\n        setGeolocation(state, action: PayloadAction<boolean>) {\n            state.useGeolocation = action.payload;\n        },\n        locationFetchStart(state) {\n            state.isFetchingLocation = true;\n        },\n        locationFetchSuccess(state) {\n            state.isFetchingLocation = false;\n        },\n        locationFetchFailed(state, action: PayloadAction<boolean>) {\n            state.isFetchingLocation = false;\n            state.useGeolocation = false;\n\n            if (action.payload) {\n                alert('Не удалось получить вашу геолокацию!');\n            }\n        },\n    },\n});\n\nexport const { setCity, setGeolocation, locationFetchStart, locationFetchSuccess, locationFetchFailed } = city.actions;\n\nexport const loadCityInfoByLocation = (showError: boolean): AppThunk => async dispatch => {\n    dispatch(locationFetchStart());\n\n    try {\n        const coords = await getCurrentPosition();\n\n        const options = {\n            longitude: coords.longitude,\n            latitude: coords.latitude,\n        };\n\n        const { cityInfo } = await fetchCityInfo(options);\n\n        dispatch(\n            setCity({\n                name: cityInfo.name,\n                geoid: cityInfo.geoid,\n                longitude: cityInfo.longitude,\n                latitude: cityInfo.latitude,\n            })\n        );\n\n        dispatch(setMenuItems(cityInfo.eventsMenu));\n        dispatch(locationFetchSuccess());\n    } catch (err) {\n        console.error(err);\n        dispatch(locationFetchFailed(showError));\n    }\n};\n\nexport const loadCityInfo = (): AppThunk => async(dispatch, getState) => {\n    const cityState = getState().city;\n\n    try {\n        if (cityState.useGeolocation) {\n            dispatch(loadCityInfoByLocation(false));\n\n            return;\n        }\n\n        const { cityInfo } = await fetchCityInfo({\n            longitude: cityState.currentCity.longitude,\n            latitude: cityState.currentCity.latitude,\n        });\n\n        dispatch(setMenuItems(cityInfo.eventsMenu));\n    } catch (err) {\n        console.error(err);\n    }\n};\n\nexport const toggleGeolocation = (isActive: boolean): AppThunk => async dispatch => {\n    if (isActive) {\n        dispatch(loadCityInfoByLocation(true));\n    }\n\n    dispatch(setGeolocation(isActive));\n};\n\nconst persistConfig = getPersistConfig<City>('city');\nexport default persistReducer(persistConfig, city.reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer } from 'redux-persist';\n\nimport { fetchCityList } from '../../lib/api';\nimport { getPersistConfig } from '../helpers/persist';\n\nimport { City } from '../../lib/api/fragments/city';\nimport { AppThunk } from '../index';\n\nexport type CityListState = {\n    isLoading: boolean;\n    items: City[];\n};\n\nconst initialState: CityListState = {\n    isLoading: false,\n    items: [],\n};\n\nconst cityList = createSlice({\n    name: 'city-list',\n    initialState,\n    reducers: {\n        setLoading(state, action: PayloadAction<boolean>) {\n            state.isLoading = action.payload;\n        },\n        setCityListResult(state, action: PayloadAction<CityListState['items']>) {\n            state.items = action.payload;\n        },\n    },\n});\n\nexport const { setLoading, setCityListResult } = cityList.actions;\n\nexport const loadCityList = (): AppThunk => async dispatch => {\n    dispatch(setLoading(true));\n\n    try {\n        const { cities } = await fetchCityList();\n        dispatch(setCityListResult(cities));\n    } catch (err) {\n        console.error(err);\n    }\n\n    dispatch(setLoading(false));\n};\n\nconst persistConfig = getPersistConfig<CityListState>('city-list', {\n    blacklist: ['isLoading'],\n});\nexport default persistReducer(persistConfig, cityList.reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { persistReducer, createTransform } from 'redux-persist';\n\nimport { fetchActualEvents, fetchSuggest } from '../../lib/api';\n\nimport { Document, Groups } from '../../lib/api/fragments/suggest';\nimport { ActualEvent } from '../../lib/api/fragments/actual-event';\nimport { AppThunk } from '../index';\nimport { getPersistConfig, getTransformUIPersistance } from '../helpers/persist';\n\ntype SearchState = {\n    data: {\n        results: {\n            groups: Array<{\n                code: string;\n                title: string | null;\n                events: ActualEvent[];\n            }>;\n        };\n        popularEvents: {\n            events: Array<ActualEvent | null>;\n\n            updatedAt: number;\n        };\n    };\n    ui: {\n        results: { isLoading: boolean };\n        popularEvents: { isLoading: boolean; isUpdating: boolean };\n    };\n};\n\nconst initialState: SearchState = {\n    data: {\n        results: {\n            groups: [],\n        },\n        popularEvents: {\n            events: [],\n            updatedAt: 0,\n        },\n    },\n    ui: {\n        popularEvents: {\n            isLoading: false,\n            isUpdating: false,\n        },\n        results: { isLoading: false },\n    },\n};\n\nconst updateInterval = 900 * 1000;\n\nconst search = createSlice({\n    name: 'search',\n    initialState,\n    reducers: {\n        fetchPopularStart(state) {\n            if (state.data.popularEvents.events.length > 0) {\n                state.ui.popularEvents.isUpdating = true;\n            } else {\n                state.ui.popularEvents.isLoading = true;\n            }\n        },\n        fetchPopularSuccess(state, action: PayloadAction<SearchState['data']['popularEvents']['events']>) {\n            state.data.popularEvents.events = action.payload;\n            state.data.popularEvents.updatedAt = Date.now();\n            state.ui.popularEvents.isLoading = false;\n            state.ui.popularEvents.isUpdating = false;\n        },\n        fetchPopularError(state) {\n            state.ui.popularEvents.isLoading = false;\n            state.ui.popularEvents.isUpdating = false;\n        },\n        searchStart(state) {\n            state.ui.results.isLoading = true;\n            state.data.results.groups = [];\n        },\n        searchSuccess(state, action: PayloadAction<Groups[]>) {\n            state.ui.results.isLoading = false;\n            state.data.results.groups = action.payload.map(group => {\n                return {\n                    code: group.code,\n                    title: group.title,\n                    events: group.documents.map(doc => transformSearchDocumentToList(doc)),\n                };\n            });\n        },\n        searchError(state) {\n            state.ui.results.isLoading = false;\n        },\n        resetResults(state) {\n            if (state.data.results.groups.length > 0) {\n                state.data.results.groups = [];\n            }\n        },\n    },\n});\n\nexport const {\n    fetchPopularStart,\n    fetchPopularSuccess,\n    fetchPopularError,\n    searchStart,\n    searchSuccess,\n    searchError,\n    resetResults,\n} = search.actions;\n\nexport const loadPopularEvents = (): AppThunk => async(dispatch, getState) => {\n    const events = getState().search.data.popularEvents;\n\n    if (events && events.updatedAt + updateInterval > Date.now()) {\n        return;\n    }\n\n    dispatch(fetchPopularStart());\n\n    try {\n        const { geoid } = getState().city.currentCity;\n        const actualEvents = await fetchActualEvents({ limit: 15, geoid });\n        dispatch(fetchPopularSuccess(actualEvents.events.items));\n    } catch (err) {\n        console.error(err);\n        dispatch(fetchPopularError());\n    }\n};\n\nlet activeRequest: AbortController | null = null;\n\nfunction filterGroupsByText(text: string, groups: Groups[]) {\n    return groups\n        .map<Groups>(group => ({\n            ...group,\n            documents: group.documents.filter(({ object }) =>\n                object.title.toLowerCase().includes(text.trim().toLowerCase())\n            ),\n        }))\n        .filter(group => group.documents.length);\n}\nexport const loadSearchResults = (text: string): AppThunk => async(dispatch, getState) => {\n    if (activeRequest) {\n        activeRequest.abort();\n    }\n\n    activeRequest = new AbortController();\n\n    // Избегаем лишней перерисовки при наборе запроса\n    if (!getState().search.ui.results.isLoading) {\n        dispatch(searchStart());\n    }\n\n    try {\n        const { geoid } = getState().city.currentCity;\n        const {\n            suggest: { groups },\n        } = await fetchSuggest(text, geoid, activeRequest.signal);\n\n        dispatch(searchSuccess(filterGroupsByText(text, groups)));\n\n        activeRequest = null;\n    } catch (err) {\n        if (err.name === 'AbortError') {\n            return;\n        }\n\n        console.error(err);\n        dispatch(searchError());\n    }\n};\n\nconst persistConfig = getPersistConfig<SearchState>('search', {\n    transforms: [\n        createTransform(\n            (inboundState: SearchState[keyof SearchState], key: keyof SearchState): SearchState[keyof SearchState] => {\n                if (key === 'data') {\n                    const { results, ...rest } = inboundState as SearchState['data'];\n\n                    return { ...rest, results: { groups: [] } };\n                }\n\n                return inboundState;\n            }\n        ),\n        getTransformUIPersistance<SearchState['ui']>(initialState.ui),\n    ],\n});\nexport default persistReducer(persistConfig, search.reducer);\n\nexport function transformSearchDocumentToList(document: Document): ActualEvent {\n    const { id, title, argument, image, type, minPrice } = document.object;\n\n    return {\n        eventPreview: {\n            id,\n            title,\n            argument,\n            image,\n            type,\n            tags: [],\n            contentRating: null,\n            tickets: minPrice ?\n                [\n                    {\n                        id: null,\n                        price: { min: minPrice.value, currency: minPrice.currency, max: null },\n                    },\n                ] :\n                [],\n            userRating: null,\n        },\n        scheduleInfo: {\n            placesTotal: null,\n            preview: null,\n        },\n    };\n}\n","import { configureStore, Action, getDefaultMiddleware, combineReducers } from '@reduxjs/toolkit';\nimport { ThunkAction } from 'redux-thunk';\nimport { persistStore } from 'redux-persist';\nimport * as PERSIST_CONTSTANS from 'redux-persist/lib/constants';\n\nimport eventReducer from './slices/event';\nimport autofillReducer from './slices/autofill';\nimport actualEventsReducer from './slices/actual-events';\nimport rubricEventsReducer from './slices/rubric-events';\nimport selectionsReducer from './slices/selections';\nimport selectionEventsReducer from './slices/selection-events';\nimport cityReducer from './slices/city';\nimport cityListReducer from './slices/city-list';\nimport searchReducer from './slices/search';\nimport menuReducer from './slices/menu';\nimport dateFilterReducer from './slices/date-filter';\nimport recommendedReducer from './slices/recommended-events';\nimport userReducer from './slices/user';\nimport orderReducer from './slices/order';\n\nconst PERSIST_ACTIONS = [\n    PERSIST_CONTSTANS.FLUSH,\n    PERSIST_CONTSTANS.REHYDRATE,\n    PERSIST_CONTSTANS.PAUSE,\n    PERSIST_CONTSTANS.PERSIST,\n    PERSIST_CONTSTANS.PURGE,\n    PERSIST_CONTSTANS.REGISTER,\n];\nconst rootReducer = combineReducers({\n    event: eventReducer,\n    autofill: autofillReducer,\n    actualEvents: actualEventsReducer,\n    rubricEvents: rubricEventsReducer,\n    selections: selectionsReducer,\n    selectionEvents: selectionEventsReducer,\n    city: cityReducer,\n    cityList: cityListReducer,\n    search: searchReducer,\n    menu: menuReducer,\n    dateFilter: dateFilterReducer,\n    recommendedEvents: recommendedReducer,\n    user: userReducer,\n    order: orderReducer,\n});\nconst store = configureStore({\n    reducer: rootReducer,\n    middleware: getDefaultMiddleware({\n        serializableCheck: {\n            ignoredActions: PERSIST_ACTIONS,\n        },\n    }),\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\nexport type AppThunk = ThunkAction<void, RootState, null, Action<string>>;\n\nexport const persistor = persistStore(store);\n\nexport default store;\n","import React from 'react';\n\nimport { Rect } from '../../Skeletons';\n\nimport styles from './styles.module.css';\n\nconst DateFilterSkeleton: React.FC = () => (\n    <div className={styles.block}>\n        {Array(2)\n            .fill(0)\n            .map((_, index) => (\n                <Rect key={index} className={styles.filter} />\n            ))}\n    </div>\n);\n\nexport default DateFilterSkeleton;\n","import React from 'react';\n\nimport { Text } from '../../../components/Skeletons';\nimport DateFilterSkeleton from '../../../components/DateFilter/Skeleton';\nimport EventsListSkeleton from '../../../components/EventsList/Skeleton';\nimport EventCardMainSkeleton from '../../../components/EventCardMain/Skeleton';\nimport SelectionListSkeleton from '../../../components/SelectionList/Skeleton';\n\nimport styles from './styles.module.css';\n\nconst MainScreenSkeleton: React.FC = () => (\n    <div>\n        <DateFilterSkeleton />\n        <div className={styles.content}>\n            <Text className={styles.title} />\n            <EventsListSkeleton itemsGap={8} count={5} card={EventCardMainSkeleton} />\n            <Text className={styles.title} />\n            <SelectionListSkeleton />\n        </div>\n    </div>\n);\n\nexport default MainScreenSkeleton;\n","import React, { useEffect, Suspense } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { lazyDeferred } from '../../lib/lazy';\nimport { RootState } from '../../redux';\nimport { loadActualEvents } from '../../redux/slices/actual-events';\nimport { loadSelections } from '../../redux/slices/selections';\n\nimport PageHeader from '../../components/PageHeader';\n\nimport MainScreenSkeleton from './Skeleton';\n\nconst Component = lazyDeferred(() =>\n    import(\n        /* webpackChunkName: \"main-screen\" */\n        './Component'\n    )\n);\n\nconst MainScreen: React.FC = () => {\n    const dispatch = useDispatch();\n    const date = useSelector((state: RootState) => state.dateFilter);\n    const { geoid } = useSelector((state: RootState) => state.city.currentCity);\n\n    useEffect(() => {\n        dispatch(loadActualEvents(date, geoid));\n        dispatch(loadSelections(date, geoid));\n    }, [dispatch, date, geoid]);\n\n    return (\n        <>\n            <PageHeader hasLogo hasMenu />\n            <Suspense fallback={<MainScreenSkeleton />}>\n                <Component />\n            </Suspense>\n        </>\n    );\n};\n\nexport default MainScreen;\n","import React from 'react';\n\nimport { Rect, Text } from '../../../components/Skeletons';\nimport RecommendedEventsSkeleton from '../components/RecommendedEvents/Skeleton';\n\nimport styles from './styles.module.css';\n\nconst EventSkeleton: React.FC = () => (\n    <div className={styles.container}>\n        <div className={styles.image} />\n\n        <div className={styles['button-wrapper']}>\n            <Rect className={styles.button} />\n        </div>\n\n        <Text className={styles['date-1']} />\n        <Text className={styles['date-2']} />\n\n        <Rect className={styles.map} />\n\n        <Text className={styles['place-1']} />\n        <Text className={styles['place-2']} />\n\n        <div className={styles.gallery}>\n            <Text className={styles['gallery-header']} />\n            <div className={styles['gallery-content']}>\n                <Rect className={styles['gallery-card']} />\n                <Rect className={styles['gallery-card']} />\n                <Rect className={styles['gallery-card']} />\n            </div>\n        </div>\n\n        <div className={styles.description}>\n            {Array(5)\n                .fill(0)\n                .map((_, index) => (\n                    <Text key={index} className={styles[`description-line-${index + 1}`]} />\n                ))}\n        </div>\n\n        <div className={styles.recommended}>\n            <RecommendedEventsSkeleton />\n        </div>\n    </div>\n);\nexport default EventSkeleton;\n","import React, { useEffect, Suspense } from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { lazyDeferred } from '../../lib/lazy';\nimport { loadEvent } from '../../redux/slices/event';\nimport { loadRecommendedEvents } from '../../redux/slices/recommended-events';\n\nimport EventSkeleton from './Skeleton';\n\nconst Component = lazyDeferred(() =>\n    import(\n        /* webpackChunkName: \"event-screen\" */\n        './Component'\n    )\n);\n\nconst EventScreen: React.FC<{ id: string }> = ({ id }) => {\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        dispatch(loadEvent(id));\n        dispatch(loadRecommendedEvents());\n    }, [dispatch, id]);\n\n    return (\n        <>\n            <Suspense fallback={<EventSkeleton />}>\n                <Component id={id} skeleton={<EventSkeleton />} />\n            </Suspense>\n        </>\n    );\n};\n\nexport default EventScreen;\n","import React from 'react';\n\nimport { Text } from '../../../components/Skeletons';\nimport DateFilterSkeleton from '../../../components/DateFilter/Skeleton';\nimport EventsListSkeleton from '../../../components/EventsList/Skeleton';\nimport EventCardSkeleton from '../../../components/EventCard/Skeleton';\n\nimport styles from './styles.module.css';\n\nconst SelectionScreenSkeleton: React.FC = () => (\n    <div>\n        <DateFilterSkeleton />\n        <div className={styles.content}>\n            <Text className={styles.title} />\n            <EventsListSkeleton count={10} card={EventCardSkeleton} />\n        </div>\n    </div>\n);\n\nexport default SelectionScreenSkeleton;\n","import React, { useEffect, Suspense } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { lazyDeferred } from '../../lib/lazy';\nimport { RootState } from '../../redux';\nimport { loadRubricEvents } from '../../redux/slices/rubric-events';\n\nimport PageHeader from '../../components/PageHeader';\nimport SelectionScreenSkeleton from '../SelectionScreen/Skeleton';\n\nconst Component = lazyDeferred(() =>\n    import(\n        /* webpackChunkName: \"rubric-screen\" */\n        './Component'\n    )\n);\n\nconst RubricScreen: React.FC<{ code: string }> = ({ code }) => {\n    const dispatch = useDispatch();\n    const date = useSelector((state: RootState) => state.dateFilter);\n\n    useEffect(() => {\n        dispatch(loadRubricEvents(code, date));\n    }, [dispatch, code, date]);\n\n    return (\n        <>\n            <PageHeader hasLogo hasMenu />\n            <Suspense fallback={<SelectionScreenSkeleton />}>\n                <Component code={code} />\n            </Suspense>\n        </>\n    );\n};\n\nexport default RubricScreen;\n","import React, { useEffect, Suspense } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { lazyDeferred } from '../../lib/lazy';\nimport { RootState } from '../../redux';\nimport { loadSelectionEvents } from '../../redux/slices/selection-events';\n\nimport PageHeader from '../../components/PageHeader';\n\nimport SelectionScreenSkeleton from './Skeleton';\n\nconst Component = lazyDeferred(() =>\n    import(\n        /* webpackChunkName: \"selection-screen\" */\n        './Component'\n    )\n);\n\nconst SelectionScreen: React.FC<{ code: string }> = ({ code }) => {\n    const dispatch = useDispatch();\n    const date = useSelector((state: RootState) => state.dateFilter);\n\n    useEffect(() => {\n        dispatch(loadSelectionEvents(code, date));\n    }, [dispatch, code, date]);\n\n    return (\n        <>\n            <PageHeader hasLogo hasMenu />\n            <Suspense fallback={<SelectionScreenSkeleton />}>\n                <Component code={code} />\n            </Suspense>\n        </>\n    );\n};\n\nexport default SelectionScreen;\n","import React, { ChangeEvent, useCallback, useEffect, useState, useRef } from 'react';\n\nimport TextInput from '../../../components/TextInput';\n\nimport styles from './styles.module.css';\n\nconst SuggestInput: React.FC<{ onChange: (value: string) => void }> = props => {\n    const inputRef = useRef<HTMLInputElement | null>(null);\n    const [value, setValue] = useState('');\n    const onChange = useCallback(\n        (e: ChangeEvent<HTMLInputElement>) => {\n            const { value } = e.target;\n\n            props.onChange(value);\n            setValue(value);\n        },\n        [setValue, props]\n    );\n\n    useEffect(() => {\n        if (inputRef.current) {\n            inputRef.current.focus();\n        }\n    }, [inputRef]);\n\n    return (\n        <TextInput\n            ref={inputRef}\n            className={styles.input}\n            defaultValue={value}\n            placeholder=\"Поиск по событиям\"\n            onChange={onChange}\n        />\n    );\n};\n\nexport default SuggestInput;\n","import React from 'react';\n\nimport { Text } from '../../../../components/Skeletons';\nimport EventsListSkeleton from '../../../../components/EventsList/Skeleton';\nimport EventCardSkeleton from '../../../../components/EventCard/Skeleton';\n\nimport styles from './styles.module.css';\n\nconst SearchResultSkeleton: React.FC = () => (\n    <>\n        {Array(3)\n            .fill(0)\n            .map((_, index) => (\n                <div key={index}>\n                    <Text className={styles.title} />\n\n                    <EventsListSkeleton count={3} card={EventCardSkeleton} />\n                </div>\n            ))}\n    </>\n);\n\nexport default SearchResultSkeleton;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { RootState } from '../../../redux';\n\nimport EventsList from '../../../components/EventsList';\nimport EventCard from '../../../components/EventCard';\nimport { useThrottleLoading } from '../../../hooks/useThrottleLoading';\n\nimport SearchResultSkeleton from './Skeleton';\nimport styles from './styles.module.css';\n\ntype Props = {\n    onItemClick: () => void;\n};\n\nconst SKELETON_THROTTLE_MS = 250;\n\nconst SearchResult: React.FC<Props> = ({ onItemClick }) => {\n    const { groups } = useSelector((state: RootState) => state.search.data.results);\n    const { isLoading } = useSelector((state: RootState) => state.search.ui.results);\n\n    const isThrottleLoading = useThrottleLoading(isLoading, SKELETON_THROTTLE_MS);\n\n    if (isThrottleLoading) {\n        return <SearchResultSkeleton />;\n    }\n\n    if (groups.length === 0 && !isLoading && !isThrottleLoading) {\n        return <div className={styles.notFound}>Ничего не найдено</div>;\n    }\n\n    return (\n        <>\n            {groups.map(({ code, title, events }) => (\n                <section key={code}>\n                    <h2 className={styles.title}>{title}</h2>\n                    <EventsList items={events} component={EventCard} onItemClick={onItemClick} />\n                </section>\n            ))}\n        </>\n    );\n};\n\nexport default SearchResult;\n","import { useEffect, useState } from 'react';\n\nexport function useThrottleLoading(isLoading: boolean, time: number) {\n    const [isThrottleLoading, setThrottleLoading] = useState(false);\n\n    // Задерживаем отрисовку на некоторое время после начала загрузки данных.\n    // Тем самым исключим моргание между заглушкой и рендером основного компонента\n    useEffect(() => {\n        if (isLoading) {\n            const newTimerId = window.setTimeout(() => setThrottleLoading(true), time);\n\n            return () => clearTimeout(newTimerId);\n        }\n\n        setThrottleLoading(false);\n    }, [isLoading, time]);\n\n    return isThrottleLoading;\n}\n","import React from 'react';\n\nimport { Text } from '../../../../components/Skeletons';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    showTitle?: boolean;\n};\n\nconst PopularResultSkeleton: React.FC<Props> = ({ showTitle }) => (\n    <>\n        {showTitle && <Text className={styles.title} />}\n\n        <div>\n            {Array(15)\n                .fill(0)\n                .map((_, index) => (\n                    <Text className={styles.event} key={index} />\n                ))}\n        </div>\n    </>\n);\n\nexport default PopularResultSkeleton;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\n\nimport { getEventUrl } from '../../../lib/url-builder';\nimport { RootState } from '../../../redux';\n\nimport PopularResultSkeleton from './Skeleton';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    onLinkClick: () => void;\n};\nconst Index: React.FC<Props> = ({ onLinkClick }) => {\n    const { events } = useSelector((state: RootState) => state.search.data.popularEvents);\n    const { isLoading } = useSelector((state: RootState) => state.search.ui.popularEvents);\n\n    return (\n        <section>\n            <div className={styles.title}>Популярные запросы</div>\n            {isLoading && <PopularResultSkeleton />}\n            <ul className={styles.events}>\n                {events.map((actualEvent, i) => {\n                    if (!actualEvent) {\n                        return null;\n                    }\n\n                    const { id, title } = actualEvent.eventPreview;\n\n                    return (\n                        <li key={i} className={styles.event}>\n                            <Link onClick={onLinkClick} className={styles.link} to={getEventUrl(id)}>\n                                {title}\n                            </Link>\n                        </li>\n                    );\n                })}\n            </ul>\n        </section>\n    );\n};\n\nexport default Index;\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { throttle } from 'throttle-debounce';\n\nimport { loadPopularEvents, loadSearchResults, resetResults } from '../../redux/slices/search';\n\nimport BackwardButton from '../../components/BackwardButton';\nimport { useMetrikaHit } from '../../hooks/useMetrikaHit';\n\nimport SuggestInput from './Input';\nimport SearchResult from './SearchResult';\nimport PopularResult from './PopularResult';\n\nimport styles from './styles.module.css';\n\nconst INPUT_THROTTLE = 500;\n\nconst SearchScreen: React.FC = () => {\n    const [hasQuery, setHasQuery] = useState(false);\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        dispatch(loadPopularEvents());\n    }, [dispatch]);\n\n    useMetrikaHit();\n\n    const onInputChange = useMemo(() => {\n        return throttle(INPUT_THROTTLE, (text: string) => {\n            text = text.trim();\n\n            setHasQuery(Boolean(text));\n\n            if (!text) {\n                dispatch(resetResults());\n                return;\n            }\n\n            dispatch(loadSearchResults(text));\n        });\n    }, [dispatch]);\n\n    const onSearchClose = useCallback(() => {\n        dispatch(resetResults());\n    }, [dispatch]);\n\n    return (\n        <>\n            <div className={styles.header}>\n                <BackwardButton fill={'black'} />\n                <SuggestInput onChange={onInputChange} />\n            </div>\n            <div className={styles.content}>\n                {hasQuery ? (\n                    <SearchResult onItemClick={onSearchClose} />\n                ) : (\n                    <PopularResult onLinkClick={onSearchClose} />\n                )}\n            </div>\n        </>\n    );\n};\n\nexport default SearchScreen;\n","import React from 'react';\n\nimport { Rect, Text } from '../../../../components/Skeletons';\n\nimport styles from './styles.module.css';\n\nconst OrderSkeleton: React.FC = () => {\n    return (\n        <div className={styles.card}>\n            <Rect className={styles.image} />\n            <div className={styles.content}>\n                <Text size={20} className={styles.text} />\n                <Text size={16} className={styles.short} />\n                <Text size={16} className={styles.short} />\n            </div>\n            <div className={styles.right}>\n                <Text size={20} className={styles.short} />\n                <Text size={16} className={styles.text} />\n            </div>\n        </div>\n    );\n};\n\nexport default OrderSkeleton;\n","import React from 'react';\n\nimport OrderSkeleton from '../Order/Skeleton';\n\nimport EventsListSkeleton from '../../../components/EventsList/Skeleton';\n\nconst OrdersScreenSkeleton: React.FC = () => {\n    return <EventsListSkeleton count={10} card={OrderSkeleton} />;\n};\n\nexport default OrdersScreenSkeleton;\n","import React, { Suspense, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { lazyDeferred } from '../../lib/lazy';\nimport { loadEvent } from '../../redux/slices/event';\nimport { fetchOrders, orderEventIdsSelector } from '../../redux/slices/order';\n\nimport PageHeader from '../../components/PageHeader';\n\nimport OrdersScreenSkeleton from './Skeleton';\n\nconst Component = lazyDeferred(() =>\n    import(\n        /* webpackChunkName: \"orders-screen\" */\n        './Component'\n    )\n);\n\nconst OrdersScreen: React.FC = () => {\n    const dispatch = useDispatch();\n    const eventIds = useSelector(orderEventIdsSelector);\n\n    const skeleton = <OrdersScreenSkeleton />;\n\n    useEffect(() => {\n        dispatch(fetchOrders());\n    }, [dispatch]);\n\n    useEffect(() => {\n        eventIds.forEach(id => {\n            dispatch(loadEvent(id));\n        });\n    }, [eventIds, dispatch]);\n\n    return (\n        <>\n            <PageHeader\n                backward=\"black\"\n                hasLogo={false}\n                hasMenu={false}\n                text=\"Мои заказы\"\n            />\n            <Suspense fallback={skeleton}>\n                <Component skeleton={skeleton} />\n            </Suspense>\n        </>\n    );\n};\n\nexport default OrdersScreen;\n","import React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\n\nimport { getOrdersUrl, getRubricUrl } from '../../lib/url-builder';\n\nimport { MenuTag } from '../../lib/api/fragments/city';\n\nimport { isAuthenticatedSelector } from '../../redux/slices/user';\nimport { ordersSelector } from '../../redux/slices/order';\n\nimport styles from './style.module.css';\n\ntype MenuItemProps = {\n    text: string;\n    to: string;\n    onItemClick: () => void;\n};\nconst MenuItem: React.FC<MenuItemProps> = props => {\n    const { text, to, onItemClick } = props;\n    return (\n        <li className={styles.item}>\n            <NavLink\n                exact\n                onClick={onItemClick}\n                className={styles.link}\n                activeClassName={styles['active-item']}\n                to={to}\n            >\n                {text}\n            </NavLink>\n        </li>\n    );\n};\n\nexport type MenuListProps = {\n    tags: MenuTag[];\n    onItemClick: () => void;\n};\nconst MenuList: React.FC<MenuListProps> = props => {\n    const isAuthenticated = useSelector(isAuthenticatedSelector);\n    const orders = useSelector(ordersSelector);\n\n    return (\n        <ul className={styles.list}>\n            {isAuthenticated && (\n                <li className={styles.item}>\n                    <NavLink\n                        exact\n                        onClick={props.onItemClick}\n                        className={[styles.link, styles['orders-text']].join(' ')}\n                        to={getOrdersUrl()}\n                    >\n                        Мои заказы\n                    </NavLink>\n                    {orders.length > 0 && <span>{orders.length}</span>}\n                </li>\n            )}\n            <MenuItem\n                to=\"/\"\n                text=\"Главная\"\n                onItemClick={props.onItemClick}\n            />\n            {props.tags.map(tag => (\n                <MenuItem\n                    key={tag.code}\n                    to={getRubricUrl(tag.code)}\n                    text={tag.name}\n                    onItemClick={props.onItemClick}\n                />\n            ))}\n        </ul>\n    );\n};\n\nexport default MenuList;\n","import React, { useCallback } from 'react';\n\nimport { useDispatch } from 'react-redux';\n\nimport { login } from '../../redux/slices/user';\n\nimport styles from './styles.module.css';\n\nconst LoginButton: React.FC = () => {\n    const dispatch = useDispatch();\n\n    const onLoginClick = useCallback(() => {\n        dispatch(login());\n    }, [dispatch]);\n\n    return (\n        <div className={styles.container} onClick={onLoginClick}>\n            <button className={styles.button}>Войти</button>\n        </div>\n    );\n};\n\nexport default LoginButton;\n","import React, { useCallback } from 'react';\n\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { MediaImageSize } from '../../lib/api/fragments/image-size';\nimport { userSelector, isAuthenticatedSelector, isAuthorizedSelector, authorize } from '../../redux/slices/user';\n\nimport Image from '../Image';\nimport LoginButton from '../LoginButton';\n\nimport styles from './styles.module.css';\n\nconst getAvatarImage = (avatarId: string): MediaImageSize => ({\n    url: `https://avatars.yandex.net/get-yapic/${avatarId}/islands-middle`,\n    width: 42,\n    height: 42,\n});\nconst getAvatarImage2x = (avatarId: string): MediaImageSize => ({\n    url: `https://avatars.yandex.net/get-yapic/${avatarId}/islands-retina-middle`,\n    width: 84,\n    height: 84,\n});\n\nconst AuthBox: React.FC = () => {\n    const dispatch = useDispatch();\n\n    const currentUser = useSelector(userSelector);\n    const isAuthenticated = useSelector(isAuthenticatedSelector);\n    const isAuthorized = useSelector(isAuthorizedSelector);\n\n    const onClick = useCallback(() => {\n        if (!isAuthorized) {\n            dispatch(authorize());\n        }\n    }, [dispatch, isAuthorized]);\n\n    if (!isAuthenticated) {\n        return <LoginButton />;\n    }\n\n    const name = currentUser.display_name || 'Профиль';\n    const avatarId = currentUser.avatar_id || 'default';\n\n    return (\n        <div className={styles.container} onClick={onClick}>\n            <Image\n                className={styles.image}\n                alt={name}\n                src={getAvatarImage(avatarId)}\n                src2x={getAvatarImage2x(avatarId)}\n            />\n            <div className={styles.username}>{name}</div>\n        </div>\n    );\n};\n\nexport default AuthBox;\n","import React, { useCallback } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { RootState } from '../../redux';\n\nimport styles from './styles.module.css';\n\nconst MenuGeoLabel: React.FC<{\n    setCityModalVisibleCallback: (visible: boolean) => void;\n}> = ({ setCityModalVisibleCallback }) => {\n    const currentCity = useSelector((state: RootState) => state.city.currentCity);\n    const onCitySelectLabelClickHandle = useCallback(() => {\n        setCityModalVisibleCallback(true);\n    }, [setCityModalVisibleCallback]);\n\n    return (\n        <div className={styles.wrapper}>\n            <div className={styles.select} onClick={onCitySelectLabelClickHandle}>\n                {currentCity ? currentCity.name : 'Выбрать город'}\n            </div>\n        </div>\n    );\n};\n\nexport default MenuGeoLabel;\n","import React, { MouseEvent, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport MenuList from '../MenuNavigation';\nimport AuthBox from '../AuthBox';\nimport MenuGeoLabel from '../MenuGeoLabel';\n\nimport { RootState } from '../../redux';\nimport { setVisible as setMenuVisible } from '../../redux/slices/menu';\nimport { psuidSelector, isAuthenticatedSelector, logout } from '../../redux/slices/user';\n\nimport styles from './style.module.css';\n\nconst MenuModal: React.FC<{\n    setCityModalVisibleCallback: (visible: boolean) => void;\n}> = ({ setCityModalVisibleCallback }) => {\n    const dispatch = useDispatch();\n\n    const { visible, items } = useSelector((state: RootState) => state.menu);\n    const isAuthenticated = useSelector(isAuthenticatedSelector);\n    const psuid = useSelector(psuidSelector);\n\n    const onClose = useCallback(() => {\n        setCityModalVisibleCallback(false);\n        dispatch(setMenuVisible(false));\n    }, [dispatch, setCityModalVisibleCallback]);\n\n    const onModalContentClick = useCallback((e: MouseEvent<HTMLImageElement>) => {\n        e.stopPropagation();\n    }, []);\n\n    const onLogoutClick = useCallback(() => {\n        dispatch(logout());\n    }, [dispatch]);\n\n    const className = [styles.modal, visible ? styles.visible : styles.hidden].join(' ');\n\n    return (\n        <div className={className} onClick={onClose}>\n            <div className={styles.content} onClick={onModalContentClick}>\n                <div className={styles.body}>\n                    <div className={styles.profile}>\n                        <AuthBox />\n                    </div>\n\n                    <MenuGeoLabel setCityModalVisibleCallback={setCityModalVisibleCallback} />\n                    <MenuList tags={items} onItemClick={onClose} />\n                </div>\n\n                {isAuthenticated && (\n                    <div className={styles.footer}>\n                        {psuid && <p className={styles.psuid}>PSUID: {psuid}</p>}\n                        <div className={styles.logout} onClick={onLogoutClick}>\n                            Выйти\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default MenuModal;\n","import React from 'react';\n\nimport styles from './styles.module.css';\n\nexport type Props = JSX.IntrinsicElements['input'] & {\n    label?: string;\n};\nconst Checkbox: React.FC<Props> = ({ className, label, ...props }) => {\n    const cls = [styles.checkbox, className].filter(Boolean).join(' ');\n\n    return (\n        <label className={styles.label}>\n            <input type=\"checkbox\" className={cls} {...props} />\n            {label}\n        </label>\n    );\n};\n\nexport default Checkbox;\n","import React, { ChangeEvent } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { RootState } from '../../redux';\n\nimport Checkbox from '../Checkbox';\nimport ActionButton from '../ActionButton';\nimport { City } from '../CityModal';\n\nimport styles from './styles.module.css';\n\ntype CityChangeProps = {\n    visible: boolean;\n    wasClosed: boolean;\n    useGeolocation: boolean;\n    openCityModal: () => void;\n    onSaveClick: () => void;\n    onGeolocationChanged: (event: ChangeEvent<HTMLInputElement>) => void;\n    selectedCity: City;\n};\n\nconst CityChange: React.FC<CityChangeProps> = ({\n    visible,\n    openCityModal,\n    wasClosed,\n    onSaveClick,\n    useGeolocation,\n    onGeolocationChanged,\n    selectedCity,\n}) => {\n    const isFetchingLocation = useSelector((state: RootState) => state.city.isFetchingLocation);\n\n    const className = [\n        styles.wrapper,\n        visible || wasClosed ? styles[`wrapper-visible_${visible ? 'yes' : 'no'}`] : '',\n        isFetchingLocation && styles.wrapper_loading,\n    ].join(' ');\n\n    return (\n        <div className={className}>\n            <div className={styles.title}>Выбрать город</div>\n            <div className={styles['auto-select-box']}>\n                <Checkbox checked={useGeolocation} onChange={onGeolocationChanged} label={'Определять автоматически'} />\n            </div>\n            <div className={styles.selected}>\n                <div className={styles['selected-city-label']}>Город</div>\n                <div className={styles['selected-city-name']} onClick={openCityModal}>\n                    {selectedCity.name}\n                </div>\n            </div>\n            <ActionButton className={styles.button} onClick={onSaveClick}>\n                Сохранить\n            </ActionButton>\n        </div>\n    );\n};\n\nexport default CityChange;\n","import React, { ChangeEvent, useCallback, useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { RootState } from '../../redux';\nimport { loadCityList } from '../../redux/slices/city-list';\n\nimport { City } from '../CityModal';\nimport TextInput from '../TextInput';\n\nimport styles from './styles.module.css';\n\ntype CitySelectProps = {\n    visible: boolean;\n    wasClosed: boolean;\n    onCitySelect: (city: City) => void;\n};\n\ntype CitySelectContentProps = {\n    isLoading: boolean;\n    items: City[];\n    onCityClick: CitySelectProps['onCitySelect'];\n};\n\ntype CityOptionProps = {\n    city: City;\n    onCityClick: CitySelectContentProps['onCityClick'];\n};\n\nconst CityOption: React.FC<CityOptionProps> = props => {\n    const { city, onCityClick } = props;\n\n    const onCitySelectHandler = useCallback(() => {\n        onCityClick(city);\n    }, [onCityClick, city]);\n\n    return (\n        <li className={styles['city-item']} onClick={onCitySelectHandler}>\n            {city.name}\n        </li>\n    );\n};\n\nconst CitySelectContent: React.FC<CitySelectContentProps> = props => {\n    const { isLoading, items, onCityClick } = props;\n\n    if (isLoading) {\n        return <>loading...</>;\n    }\n\n    return (\n        <ul className={styles['city-list']}>\n            {items.map(city => {\n                if (!city) {\n                    return null;\n                }\n\n                return <CityOption key={city.geoid} city={city} onCityClick={onCityClick} />;\n            })}\n        </ul>\n    );\n};\n\nconst CitySelect: React.FC<CitySelectProps> = ({ visible, onCitySelect, wasClosed }) => {\n    const dispatch = useDispatch();\n    const { items, isLoading } = useSelector((state: RootState) => state.cityList);\n    const [suggestedItems, setItems] = useState(items);\n\n    const className = [\n        styles.wrapper,\n        visible || wasClosed ? styles[`wrapper-visible_${visible ? 'yes' : 'no'}`] : '',\n    ].join(' ');\n\n    useEffect(() => {\n        if (!items.length) {\n            dispatch(loadCityList());\n        } else {\n            setItems(items);\n        }\n    }, [dispatch, items]);\n\n    const onSuggestChangeHandler = useCallback(\n        (e: ChangeEvent<HTMLInputElement>) => {\n            const value = e.target.value.toLowerCase();\n\n            if (!value.trim()) {\n                setItems(items);\n            } else {\n                setItems(items.filter(({ name }) => name.toLowerCase().indexOf(value) !== -1));\n            }\n        },\n        [items]\n    );\n\n    return (\n        <div className={className}>\n            <TextInput className={styles.input} placeholder=\"Введите название\" onChange={onSuggestChangeHandler} />\n            <CitySelectContent isLoading={isLoading} items={suggestedItems} onCityClick={onCitySelect} />\n        </div>\n    );\n};\n\nexport default CitySelect;\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useClickAway } from 'react-use';\n\nimport { RootState } from '../../redux';\nimport { setCity as saveCity, toggleGeolocation, loadCityInfo, City as stateCity } from '../../redux/slices/city';\nimport { usePrevious } from '../../hooks/usePrevious';\n\nimport CityChange from '../CityChange';\nimport CitySelect from '../CitySelect';\n\nimport styles from './styles.module.css';\n\nexport type City = stateCity['currentCity'];\n\nconst CityModal: React.FC<{\n    visible: boolean;\n    setCityModalVisibleCallback: (visible: boolean) => void;\n}> = ({ visible: isModalVisible, setCityModalVisibleCallback: setModalVisible }) => {\n    const contentRef = useRef<HTMLDivElement>(null);\n    const dispatch = useDispatch();\n    const history = useHistory();\n\n    const currentCity = useSelector((state: RootState) => state.city.currentCity);\n    const useGeolocation = useSelector((state: RootState) => state.city.useGeolocation);\n\n    const previousCity = usePrevious<City>(currentCity);\n\n    const [selectedCity, selectCity] = useState<City>(currentCity);\n\n    const [wasClosed, setWasClosed] = useState<boolean>(false);\n    const [wasClosedModalChange, setWasClosedModalChange] = useState<boolean>(false);\n    const [wasClosedModalSelect, setWasClosedModalSelect] = useState<boolean>(false);\n    const [visibleModalChange, setVisibleModalChange] = useState<boolean>(false);\n    const [visibleModalSelect, setVisibleModalSelect] = useState<boolean>(false);\n\n    const className = [\n        styles['city-modal'],\n        isModalVisible || wasClosed ? styles[`city-modal-visible_${isModalVisible ? 'yes' : 'no'}`] : '',\n    ].join(' ');\n\n    useEffect(() => {\n        setVisibleModalChange(isModalVisible);\n    }, [setVisibleModalChange, isModalVisible]);\n\n    useEffect(() => {\n        selectCity(currentCity);\n\n        if (previousCity && previousCity.name !== currentCity.name) {\n            console.warn('Go to `/` route');\n\n            history.replace('/');\n        }\n    }, [selectCity, currentCity, previousCity, history]);\n\n    const onGeolocationChanged = useCallback(\n        e => {\n            const isChecked = e.target.checked;\n\n            dispatch(toggleGeolocation(isChecked));\n        },\n        [dispatch]\n    );\n\n    const onClose = useCallback(() => {\n        if (selectedCity.name !== currentCity.name) {\n            selectCity(currentCity);\n        }\n\n        setWasClosed(true);\n        setVisibleModalSelect(false);\n        setVisibleModalChange(false);\n        setModalVisible(false);\n    }, [\n        selectedCity,\n        currentCity,\n        selectCity,\n        setWasClosed,\n        setVisibleModalSelect,\n        setVisibleModalChange,\n        setModalVisible,\n    ]);\n\n    const onSaveClick = useCallback(() => {\n        setWasClosed(true);\n        setVisibleModalChange(false);\n        setModalVisible(false);\n\n        dispatch(saveCity(selectedCity));\n\n        if (selectedCity.name !== currentCity.name) {\n            dispatch(loadCityInfo());\n        }\n    }, [setVisibleModalChange, setModalVisible, dispatch, selectedCity, currentCity]);\n\n    const onCitySelect = useCallback(\n        (city: City) => {\n            selectCity(city);\n            setWasClosedModalSelect(true);\n            setVisibleModalSelect(false);\n            setVisibleModalChange(true);\n\n            dispatch(toggleGeolocation(false));\n        },\n        [dispatch, selectCity, setWasClosedModalSelect, setVisibleModalSelect, setVisibleModalChange]\n    );\n\n    const openCityModal = useCallback(() => {\n        setWasClosedModalChange(true);\n        setVisibleModalSelect(true);\n        setVisibleModalChange(false);\n    }, [setWasClosedModalChange, setVisibleModalSelect, setVisibleModalChange]);\n\n    useClickAway(contentRef, onClose);\n\n    return (\n        <div className={className}>\n            {isModalVisible && (\n                <div ref={contentRef}>\n                    <CityChange\n                        visible={visibleModalChange}\n                        openCityModal={openCityModal}\n                        onGeolocationChanged={onGeolocationChanged}\n                        useGeolocation={useGeolocation}\n                        wasClosed={wasClosedModalChange}\n                        selectedCity={selectedCity}\n                        onSaveClick={onSaveClick}\n                    />\n                    <CitySelect\n                        visible={visibleModalSelect}\n                        onCitySelect={onCitySelect}\n                        wasClosed={wasClosedModalSelect}\n                    />\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default CityModal;\n","import { useRef, useEffect } from 'react';\n\nexport function usePrevious<T>(value: T) {\n    const previousValue = useRef<T>();\n\n    useEffect(() => {\n        previousValue.current = value;\n    }, [value]);\n\n    return previousValue.current;\n}\n","import React, { memo, useCallback, useEffect, useState } from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { isIOS } from './lib/is-ios';\nimport { useWatchAuth } from './hooks/useWatchAuth';\nimport { loadCityInfo } from './redux/slices/city';\n\nimport MainScreen from './screens/MainScreen';\nimport EventScreen from './screens/EventScreen';\nimport RubricScreen from './screens/RubricScreen';\nimport SelectionScreen from './screens/SelectionScreen';\nimport SearchScreen from './screens/SearchScreen';\nimport OrdersScreen from './screens/OrdersScreen';\n\nimport MenuModal from './components/MenuModal';\nimport CityModal from './components/CityModal';\n\nimport { createStackNavigator } from './components/StackNavigator';\n\nconst Navigator = createStackNavigator(\n    [\n        {\n            path: '/',\n            exact: true,\n            component: memo(() => <MainScreen />),\n        },\n        {\n            path: '/event/:id',\n            exact: true,\n            component: memo(({ params: { id } }) => <EventScreen id={id} />),\n        },\n        {\n            path: '/events/:code',\n            exact: true,\n            component: memo(({ params: { code } }) => <RubricScreen code={code} />),\n        },\n        {\n            path: '/selection/:code',\n            exact: true,\n            component: memo(({ params: { code } }) => <SelectionScreen code={code} />),\n        },\n        {\n            path: '/search',\n            exact: true,\n            component: memo(() => <SearchScreen />),\n        },\n        {\n            path: '/orders',\n            exact: true,\n            component: memo(() => <OrdersScreen />),\n        },\n        {\n            path: '*',\n            component: memo(() => <div>Страница не найдена</div>),\n        },\n    ],\n    {\n        // Сохраняем в истории максимум 10 экранов\n        maxDepth: 10,\n        transitions: true,\n    }\n);\n\nconst App: React.FC = () => {\n    const dispatch = useDispatch();\n\n    const [cityModalVisible, setCityModalVisible] = useState<boolean>(false);\n\n    const setCityModalVisibleCallback = useCallback(\n        (visible: boolean) => {\n            setCityModalVisible(visible);\n        },\n        [setCityModalVisible]\n    );\n\n    useEffect(() => {\n        dispatch(loadCityInfo());\n    }, [dispatch]);\n\n    useEffect(() => {\n        if (isIOS()) {\n            document.body.style.overflow = 'auto';\n        }\n    }, []);\n\n    useWatchAuth();\n\n    return (\n        <>\n            <Navigator />\n            <MenuModal setCityModalVisibleCallback={setCityModalVisibleCallback} />\n            <CityModal setCityModalVisibleCallback={setCityModalVisibleCallback} visible={cityModalVisible} />\n        </>\n    );\n};\n\nexport default App;\n","import { useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { checkUser } from '../redux/slices/user';\n\nexport function useWatchAuth() {\n    const dispatch = useDispatch();\n\n    // Проверяем авторизацию на старте приложения\n    useEffect(() => {\n        dispatch(checkUser());\n    }, [dispatch]);\n\n    // При переключении владок браузера пользователь мог сменить логин, поэтому проверяем авторизацию\n    useEffect(() => {\n        const onVisibilityChange = () => {\n            if (document.visibilityState === 'visible') {\n                dispatch(checkUser());\n            }\n        };\n\n        document.addEventListener('visibilitychange', onVisibilityChange);\n\n        return () => document.removeEventListener('visibilitychange', onVisibilityChange);\n    }, [dispatch]);\n}\n","import React, { useEffect, useState } from 'react';\n\nimport App from './App';\n\nconst polyfillPromises: Promise<void>[] = [];\n\nif (!('IntersectionObserver' in window)) {\n    // @ts-ignore\n    polyfillPromises.push(import('intersection-observer'));\n}\n\nconst PolyfillApp: React.FC = () => {\n    const [canRender, setCanRender] = useState(Boolean(!polyfillPromises.length));\n\n    useEffect(() => {\n        if (polyfillPromises.length) {\n            Promise.all(polyfillPromises).then(() => setCanRender(true));\n        }\n    }, []);\n\n    return <>{canRender && <App />}</>;\n};\n\nexport default PolyfillApp;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { HashRouter } from 'react-router-dom';\nimport { PersistGate } from 'redux-persist/integration/react';\n\nimport { initMetrika } from './lib/metrika';\nimport store, { persistor } from './redux';\nimport App from './PolyfillApp';\n\nimport './index.css';\n\ninitMetrika();\n\nReactDOM.render(\n    <Provider store={store}>\n        <PersistGate loading={null} persistor={persistor}>\n            <HashRouter>\n                <App />\n            </HashRouter>\n        </PersistGate>\n    </Provider>,\n    document.getElementById('root')\n);\n"],"sourceRoot":""}