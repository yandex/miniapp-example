{"version":3,"sources":["components/LazyRender/index.tsx","hooks/useVisibleOnce.ts","screens/EventScreen/components/Title/index.tsx","screens/EventScreen/components/ContentBlock/index.tsx","components/GalleryModal/styles.module.css","components/Gallery/styles.module.css","components/CollapsedText/styles.module.css","screens/EventScreen/components/Title/styles.module.css","screens/EventScreen/components/ContentBlock/styles.module.css","screens/EventScreen/components/Cover/styles.module.css","screens/EventScreen/components/CheckoutModal/components/CheckoutEventInfo/styles.module.css","screens/EventScreen/components/CheckoutModal/components/CheckoutTextInput/styles.module.css","screens/EventScreen/components/CheckoutModal/styles.module.css","screens/EventScreen/components/TicketButton/styles.module.css","components/YaMapModal/styles.module.css","components/YaMapWidget/styles.module.css","screens/EventScreen/components/VenueInfo/styles.module.css","screens/EventScreen/styles.module.css","components/GalleryModal/index.tsx","components/Gallery/index.tsx","components/CollapsedText/index.tsx","hooks/useScrollEffect.ts","screens/EventScreen/components/Cover/index.tsx","screens/EventScreen/components/CheckoutModal/components/CheckoutEventInfo/index.tsx","screens/EventScreen/components/CheckoutModal/components/CheckoutTextInput/index.tsx","screens/EventScreen/components/CheckoutModal/index.tsx","screens/EventScreen/components/TicketButton/index.tsx","lib/maps.ts","components/YaMapModal/index.tsx","components/YaMapWidget/index.tsx","screens/EventScreen/components/VenueInfo/index.tsx","components/LazyBlock/index.tsx","screens/EventScreen/components/RecommendedEvents/index.tsx","screens/EventScreen/Component.tsx"],"names":["LazyRender","children","skeleton","intersectionOptions","ref","useRef","canRender","options","isVisible","setVisible","useState","useEffect","current","observer","IntersectionObserver","entry","isIntersecting","observe","disconnect","useVisibleOnce","needSkeleton","showSkeleton","Title","className","styles","title","ContentBlock","block","filter","Boolean","join","module","exports","GalleryModal","props","currentIndex","setCurrentIndex","startIndex","scroller","useLayoutEffect","index","scrollLeft","window","innerWidth","rootEl","entries","activated","reduce","max","intersectionRatio","el","target","Array","prototype","indexOf","call","parentElement","root","threshold","from","items","createPortal","modal","counter","length","close","onClick","onBackClick","carousel","map","image","i","key","large2x","url","Image","src","large","src2x","bgColor","alt","document","body","Gallery","selectedIndex","setSelectedIndex","images","useMemo","onItemClick","useCallback","e","currentTarget","container","thumbnail","thumbnail2x","CollapsedText","shortRef","fullRef","visible","shortRect","getBoundingClientRect","fullRect","height","lines","short","style","WebkitLineClamp","hidden","ClearButton","button","fullTextLabel","useScrollEffect","scrollableRef","predicateRef","predicate","value","setValue","updateValue","throttle","addEventListener","removeEventListener","Cover","event","imageRef","argument","tags","contentRating","tagLine","tag","name","cover","touchPrimary","fade","overview","CheckoutEventInfo","ticket","preview","price","TicketPrice","exact","CheckoutTextInput","label","type","onChange","onFocus","required","onInputChange","TextInput","input","CheckoutModal","onClose","dispatch","useDispatch","contentRef","formRef","setName","phone","setPhone","email","setEmail","address","setAddress","isAuthorizationRequested","setAuthorizationRequested","isAuthenticated","useSelector","isAuthenticatedSelector","isAuthorized","isAuthorizedSelector","isAutofilled","isAutofilledSelector","currentUser","userSelector","autofilledUser","autofilledUserSelector","isPaymentInProgress","paymentInProgressSelector","isOrderCreationInProgress","orderCreationInProgressSelector","useClickAway","preventDefault","onTouchStart","contains","onBuyTicket","activeElement","HTMLElement","blur","buyTicket","onInputFocus","authorize","autofill","buttonText","content","action","onSubmit","ActionButton","formInvalid","checkValidity","disabled","StickyVisibleClasses","Yes","No","Button","isElementOutOfViewport","Number","top","TicketButton","paymentButtonRef","screenRef","useScreenRef","documentRef","isIOS","stickyVisibleClass","setStickyVisibleClass","screenNode","setScreenNode","isCheckoutInProgress","checkoutInProgressSelector","onPaymentButtonClick","createOrder","onCheckoutClose","checkoutEnd","isStaticPaymentButtonVisible","tickets","static","sticky","getStaticMapUrl","params","URLSearchParams","l","Object","set","String","Map","lazy","MetroStation","station","colors","color","backgroundColor","YaMapModal","coordinates","metro","place","longitude","latitude","fallback","point","YaMapWidget","staticMapImage","size","z","pt","width","isModalOpen","setModalOpen","onMapClick","overflow","VenueInfo","schedule","oneOfPlaces","placePreview","Inner","fetchData","LazyBlock","Component","lazyDeferred","memo","isScrollAtTop","scrollY","scrollTop","id","mainImageRef","useScreenVisible","eventPage","state","data","isLoading","description","isPageHeaderClear","useMetrikaHit","logProductView","PageHeader","mods","backward","hasLogo","hasMenu","wrapper","city","text","RecommendedEvents","placeholder"],"mappings":"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","file":"static/js/event-screen.8e85450d.chunk.js","sourcesContent":["import React, { useRef, ReactElement, useState, useEffect } from 'react';\n\nimport { useVisibleOnce } from '../../hooks/useVisibleOnce';\n\ntype Props = {\n    children: ReactElement;\n    skeleton?: ReactElement;\n    intersectionOptions?: IntersectionObserverInit;\n};\n\nconst LazyRender: React.FC<Props> = ({ children, skeleton, intersectionOptions }) => {\n    const ref = useRef<HTMLDivElement | null>(null);\n    const canRender = useVisibleOnce(ref, intersectionOptions);\n    const [needSkeleton, showSkeleton] = useState(false);\n\n    useEffect(() => {\n        if (!canRender) {\n            showSkeleton(true);\n        }\n    }, [canRender]);\n\n    return <div ref={ref}>{canRender ? children : needSkeleton && skeleton}</div>;\n};\n\nexport default LazyRender;\n","import { RefObject, useEffect, useState } from 'react';\n\nexport function useVisibleOnce(ref: RefObject<HTMLElement>, options?: IntersectionObserverInit) {\n    // Пока не навешан обработчик на элемент, мы точно не можем сказать видим он или нет,\n    // поэтому начальное значение undefined\n    const [isVisible, setVisible] = useState<boolean>();\n\n    useEffect(() => {\n        if (!ref.current || isVisible) {\n            return;\n        }\n\n        const observer = new IntersectionObserver(([entry]) => {\n            setVisible(entry.isIntersecting);\n        }, options);\n\n        observer.observe(ref.current);\n\n        return () => {\n            observer.disconnect();\n        };\n    }, [ref, options, isVisible]);\n\n    return isVisible;\n}\n","import React from 'react';\n\nimport styles from './styles.module.css';\n\nconst Title: React.FC = ({ children }) => {\n    return <h2 className={styles.title}>{children}</h2>;\n};\n\nexport default Title;\n","import React from 'react';\n\nimport styles from './styles.module.css';\n\nconst ContentBlock: React.FC<{ className?: string }> = ({ children, className }) => {\n    return <div className={[styles.block, className].filter(Boolean).join(' ')}>{children}</div>;\n};\n\nexport default ContentBlock;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"styles_modal__2Q8g_\",\"carousel\":\"styles_carousel__3JHc0\",\"image\":\"styles_image__3O5qH\",\"close\":\"styles_close__4LZBs\",\"counter\":\"styles_counter__3PRwA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__3ZZwU\",\"thumbnail\":\"styles_thumbnail__20t1x\",\"image\":\"styles_image__QgQS0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"short\":\"styles_short__3k1iO\",\"hidden\":\"styles_hidden__1LiUD\",\"button\":\"styles_button__D0dDq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"styles_title__2X6Eu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"styles_block__1VDKZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cover\":\"styles_cover__13-3l\",\"image\":\"styles_image__CjVbW\",\"fade\":\"styles_fade__3F1Tn\",\"overview\":\"styles_overview__1GrfL\",\"title\":\"styles_title__3Zqkm\",\"argument\":\"styles_argument__2fOy2\",\"tags\":\"styles_tags__2NPR2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__1T1LA\",\"title\":\"styles_title__5E4fn\",\"price\":\"styles_price__31LNt\",\"image\":\"styles_image__2FjaB\",\"preview\":\"styles_preview__1Y7Wv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__23BU7\",\"label\":\"styles_label__A0D9-\",\"input\":\"styles_input__2Wcu3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"styles_modal__3ZOE-\",\"content\":\"styles_content__2-xA9\",\"visible\":\"styles_visible__mfrBL\",\"hidden\":\"styles_hidden__3bzBj\",\"title\":\"styles_title__pU2ia\",\"event\":\"styles_event__2u5Bc\",\"input\":\"styles_input__gGp1k\",\"total\":\"styles_total__2Y-X-\",\"button\":\"styles_button__2SSOt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"static\":\"styles_static__2-03C\",\"sticky\":\"styles_sticky__1Rl75\",\"sticky-visible_yes\":\"styles_sticky-visible_yes__2Dqcw\",\"slideUp\":\"styles_slideUp__39hv4\",\"sticky-visible_no\":\"styles_sticky-visible_no__pKDDZ\",\"slideDown\":\"styles_slideDown__2oDJ0\",\"button\":\"styles_button__1odxN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"styles_modal__3Zspv\",\"close\":\"styles_close__Yequy\",\"close-button\":\"styles_close-button__1pQas\",\"metro-containter\":\"styles_metro-containter__13P1B\",\"station\":\"styles_station__3UP2f\",\"metro-point\":\"styles_metro-point__1HHJ4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"map\":\"styles_map__1AUAZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"styles_title__1_HWs\",\"address\":\"styles_address__Of4nL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"styles_wrapper__1GA7u\",\"city\":\"styles_city__18Nw2\",\"schedule\":\"styles_schedule__2bK7D\",\"description\":\"styles_description__1TgUA\",\"placeholder\":\"styles_placeholder__2Dhd8\"};","import React, { useState, useEffect, useRef, MouseEvent, useLayoutEffect } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { GalleryImage } from '../../lib/api/fragments/gallery-image';\n\nimport Image from '../Image';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    items: GalleryImage[];\n    onBackClick: (e: MouseEvent<HTMLButtonElement>) => void;\n    startIndex?: number;\n};\n\n// Можно попробовать pinch-zoom\n// https://github.com/GoogleChromeLabs/pinch-zoom\n\nconst GalleryModal: React.FC<Props> = props => {\n    const [currentIndex, setCurrentIndex] = useState(props.startIndex || 0);\n    const scroller = useRef<HTMLDivElement | null>(null);\n\n    useLayoutEffect(() => {\n        if (!props.startIndex) {\n            return;\n        }\n\n        scroller.current!.scrollLeft = getScrollPosition(props.startIndex);\n    }, [props.startIndex]);\n\n    useEffect(() => {\n        const rootEl = scroller.current!;\n\n        const observer = new IntersectionObserver(\n            entries => {\n                // find the entry with the largest intersection ratio\n                const activated = entries.reduce((max, entry) => {\n                    return entry.intersectionRatio > max.intersectionRatio ? entry : max;\n                });\n\n                if (activated.intersectionRatio > 0) {\n                    const el = activated.target;\n                    const index = Array.prototype.indexOf.call(el.parentElement!.children, el);\n\n                    setCurrentIndex(index);\n                }\n            },\n            {\n                root: scroller.current,\n                threshold: 0.5,\n            }\n        );\n\n        for (const el of Array.from(rootEl.children)) {\n            observer.observe(el);\n        }\n\n        return () => {\n            observer.disconnect();\n        };\n    }, [props.items, props.startIndex]);\n\n    return createPortal(\n        <div className={styles.modal}>\n            <div className={styles.counter}>\n                {currentIndex + 1} из {props.items.length}\n            </div>\n            <button className={styles.close} onClick={props.onBackClick}>\n                Назад\n            </button>\n\n            <div className={styles.carousel} ref={scroller}>\n                {props.items.map((image, i) => {\n                    return (\n                        <div className={styles.image} key={image.large2x.url}>\n                            <Image\n                                src={image.large}\n                                src2x={image.large2x}\n                                bgColor={image.bgColor}\n                                alt={`Фотография ${i + 1}`}\n                            />\n                        </div>\n                    );\n                })}\n            </div>\n        </div>,\n        document.body\n    );\n};\n\nfunction getScrollPosition(index: number) {\n    const itemsMargin = 20;\n\n    return (window.innerWidth + itemsMargin) * index;\n}\n\nexport default GalleryModal;\n","import React, { useCallback, useState, MouseEvent, useMemo } from 'react';\n\nimport { GalleryImage } from '../../lib/api/fragments/gallery-image';\n\nimport GalleryModal from '../GalleryModal';\nimport Image from '../Image';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    items: Array<GalleryImage | null>;\n};\n\nconst Gallery: React.FC<Props> = props => {\n    const [selectedIndex, setSelectedIndex] = useState(-1);\n\n    const images = useMemo(() => {\n        return props.items.filter(Boolean);\n    }, [props.items]) as GalleryImage[];\n\n    const onItemClick = useCallback((e: MouseEvent<HTMLImageElement>) => {\n        const el = e.currentTarget;\n        const index = Array.prototype.indexOf.call(el.parentElement!.children, el);\n        setSelectedIndex(index);\n    }, []);\n\n    const onBackClick = useCallback(() => {\n        setSelectedIndex(-1);\n    }, []);\n\n    return (\n        <>\n            <div className={styles.container}>\n                {images.map((image, i) => {\n                    return (\n                        <div className={styles.thumbnail} key={image.thumbnail2x.url} onClick={onItemClick}>\n                            <Image\n                                className={styles.image}\n                                src={image.thumbnail}\n                                src2x={image.thumbnail2x}\n                                bgColor={image.bgColor}\n                                alt={`Фотография ${i + 1}`}\n                            />\n                        </div>\n                    );\n                })}\n            </div>\n            {selectedIndex !== -1 && (\n                <GalleryModal items={images} onBackClick={onBackClick} startIndex={selectedIndex} />\n            )}\n        </>\n    );\n};\n\nexport default Gallery;\n","import React, { useEffect, useRef, useState, useCallback } from 'react';\n\nimport ClearButton from '../ClearButton';\n\nimport styles from './styles.module.css';\n\nexport type ContentProps = {\n    className?: string;\n    lines: number;\n    fullTextLabel: string;\n};\n\nconst CollapsedText: React.FC<ContentProps> = props => {\n    const shortRef = useRef<HTMLDivElement | null>(null);\n    const fullRef = useRef<HTMLDivElement | null>(null);\n    const [visible, setVisible] = useState(false);\n\n    useEffect(() => {\n        if (!shortRef.current || !fullRef.current) {\n            return;\n        }\n\n        const shortRect = shortRef.current.getBoundingClientRect();\n        const fullRect = fullRef.current.getBoundingClientRect();\n\n        if (shortRect.height === fullRect.height) {\n            setVisible(true);\n        }\n    }, [shortRef, fullRef, props.lines]);\n\n    const onClick = useCallback(() => setVisible(true), [setVisible]);\n\n    return (\n        <>\n            {!visible && (\n                <div\n                    ref={shortRef}\n                    className={[props.className, styles.short].filter(Boolean).join(' ')}\n                    style={{ WebkitLineClamp: props.lines }}\n                >\n                    {props.children}\n                </div>\n            )}\n            <div className={[props.className, !visible && styles.hidden].filter(Boolean).join(' ')} ref={fullRef}>\n                {props.children}\n            </div>\n            {!visible && (\n                <ClearButton className={styles.button} onClick={onClick}>\n                    {props.fullTextLabel}\n                </ClearButton>\n            )}\n        </>\n    );\n};\n\nexport default CollapsedText;\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { throttle } from 'throttle-debounce';\n\nconst SCROLL_THROTTLE_INTERVAL = 50;\n\nexport const useScrollEffect = <TScrollEventTarget extends EventTarget, TPredicateElement extends Element>(\n    scrollableRef: React.MutableRefObject<TScrollEventTarget | null>,\n    predicateRef: React.MutableRefObject<TPredicateElement | null>,\n    predicate: (predicateRef: React.MutableRefObject<TPredicateElement | null>) => boolean\n) => {\n    const [value, setValue] = useState<boolean>(() => predicate(predicateRef));\n    const updateValue = useCallback(\n        throttle(SCROLL_THROTTLE_INTERVAL, () => {\n            setValue(predicate(predicateRef));\n        }),\n        [setValue, scrollableRef, predicateRef, predicate]\n    );\n\n    useEffect(() => {\n        const { current } = scrollableRef;\n\n        current?.addEventListener('scroll', updateValue);\n\n        return () => {\n            current?.removeEventListener('scroll', updateValue);\n        };\n    }, [scrollableRef, predicateRef, updateValue]);\n\n    useEffect(() => {\n        updateValue();\n    }, [updateValue, scrollableRef, predicateRef]);\n\n    return value;\n};\n","import React from 'react';\n\nimport { Event } from '../../../../redux/slices/event';\n\nimport Image from '../../../../components/Image';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    event: Partial<Event>;\n    imageRef: React.Ref<HTMLDivElement>;\n};\n\nconst Cover: React.FC<Props> = ({ event, imageRef }) => {\n    const { title, argument, image, tags, contentRating } = event;\n\n    const tagLine = [...(tags || []).map(tag => tag.name), contentRating].filter(Boolean).join('  •  ');\n\n    return (\n        <div className={styles.cover} ref={imageRef}>\n            {image && <Image className={styles.image} src={image.touchPrimary} bgColor={image.bgColor} />}\n            <div className={styles.fade} />\n            <div className={styles.overview}>\n                <h1 className={styles.title}>{title}</h1>\n                <div className={styles.argument}>{argument}</div>\n                <div className={styles.tags}>{tagLine}</div>\n            </div>\n        </div>\n    );\n};\n\nexport default Cover;\n","import React from 'react';\n\nimport { Ticket } from '../../../../../../lib/api/fragments/ticket';\nimport { Event } from '../../../../../../redux/slices/event';\n\nimport Image from '../../../../../../components/Image';\nimport TicketPrice from '../../../../../../components/TicketPrice';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    className: string;\n    event: Event;\n    ticket: Ticket;\n};\n\nconst CheckoutEventInfo: React.FC<Props> = ({ className, event, ticket }) => {\n    const { title, image } = event;\n\n    return (\n        <div className={[styles.container, className].join(' ')}>\n            {image && image.touchPrimary ? (\n                <Image className={styles.image} alt={title} src={image.touchPrimary} bgColor={image.bgColor} />\n            ) : (\n                <div className={styles.preview} />\n            )}\n            <div className={styles.title}>{title}</div>\n            <div className={styles.price}>\n                <TicketPrice ticket={ticket} exact />\n            </div>\n        </div>\n    );\n};\n\nexport default CheckoutEventInfo;\n","import React, { useCallback } from 'react';\n\nimport TextInput from '../../../../../../components/TextInput';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    className: string;\n    label: string;\n    type?: string;\n    name?: string;\n    value: string;\n    onChange: (value: string) => void;\n    onFocus?: () => void;\n    required?: boolean;\n};\n\nconst CheckoutTextInput: React.FC<Props> = props => {\n    const { className, label, type, name, value, onChange, onFocus, required } = props;\n    const onInputChange = useCallback(\n        (e: React.ChangeEvent<HTMLInputElement>) => {\n            onChange(e.target.value);\n        },\n        [onChange]\n    );\n\n    return (\n        <label className={[styles.container, className].join(' ')}>\n            <div className={styles.label}>{label}</div>\n            <TextInput\n                className={styles.input}\n                type={type}\n                name={name}\n                value={value}\n                onChange={onInputChange}\n                onFocus={onFocus}\n                required={required}\n            />\n        </label>\n    );\n};\n\nexport default CheckoutTextInput;\n","import React, { useCallback, useRef, TouchEvent, useState, useEffect, FormEvent } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useClickAway } from 'react-use';\n\nimport { Ticket } from '../../../../lib/api/fragments/ticket';\n\nimport { Event } from '../../../../redux/slices/event';\nimport { autofill, isAutofilledSelector, autofilledUserSelector } from '../../../../redux/slices/autofill';\nimport { buyTicket, paymentInProgressSelector, orderCreationInProgressSelector } from '../../../../redux/slices/order';\nimport { authorize, userSelector, isAuthorizedSelector, isAuthenticatedSelector } from '../../../../redux/slices/user';\n\nimport ActionButton from '../../../../components/ActionButton';\n\nimport CheckoutEventInfo from './components/CheckoutEventInfo';\nimport CheckoutTextInput from './components/CheckoutTextInput';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    event: Event;\n    ticket: Ticket;\n    visible: boolean;\n    onClose: () => void;\n};\n\nconst CheckoutModal: React.FC<Props> = ({ event, ticket, visible, onClose }) => {\n    const dispatch = useDispatch();\n\n    const contentRef = useRef<HTMLDivElement>(null);\n    const formRef = useRef<HTMLFormElement>(null);\n\n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [address, setAddress] = useState('');\n    const [isAuthorizationRequested, setAuthorizationRequested] = useState(false);\n\n    const isAuthenticated = useSelector(isAuthenticatedSelector);\n    const isAuthorized = useSelector(isAuthorizedSelector);\n    const isAutofilled = useSelector(isAutofilledSelector);\n    const currentUser = useSelector(userSelector);\n    const autofilledUser = useSelector(autofilledUserSelector);\n    const isPaymentInProgress = useSelector(paymentInProgressSelector);\n    const isOrderCreationInProgress = useSelector(orderCreationInProgressSelector);\n\n    const className = [styles.modal, visible ? styles.visible : styles.hidden].join(' ');\n\n    useClickAway(\n        contentRef,\n        e => {\n            if (!visible) {\n                return;\n            }\n\n            e.preventDefault();\n            onClose();\n        },\n        ['touchend']\n    );\n\n    const onTouchStart = useCallback(\n        (e: TouchEvent) => {\n            if (!contentRef.current || !visible) {\n                return;\n            }\n\n            const isInsideModal = contentRef.current.contains(e.target as Element);\n            if (!isInsideModal) {\n                e.preventDefault();\n            }\n        },\n        [visible, contentRef]\n    );\n\n    const onBuyTicket = useCallback(\n        (e: FormEvent) => {\n            e.preventDefault();\n\n            if (document.activeElement instanceof HTMLElement) {\n                document.activeElement.blur();\n            }\n\n            dispatch(\n                buyTicket(event, {\n                    name,\n                    phone,\n                    email,\n                    address,\n                })\n            );\n        },\n        [dispatch, event, name, email, phone, address]\n    );\n\n    const onInputFocus = useCallback(() => {\n        if (isAuthenticated && !isAutofilled && !isAuthorized && !isAuthorizationRequested) {\n            setAuthorizationRequested(true);\n\n            dispatch(authorize());\n        }\n    }, [dispatch, isAuthenticated, isAutofilled, isAuthorized, isAuthorizationRequested]);\n\n    useEffect(() => {\n        if (visible && !isAutofilled) {\n            dispatch(autofill());\n        }\n    }, [dispatch, visible, isAutofilled]);\n\n    useEffect(() => {\n        setName(value => value || autofilledUser?.name || currentUser.name || '');\n        setPhone(value => value || autofilledUser?.phone || '');\n        setEmail(value => value || autofilledUser?.email || currentUser.email || '');\n        setAddress(value => value || autofilledUser?.address || '');\n    }, [visible, currentUser, autofilledUser]);\n\n    useEffect(() => {\n        if (!visible) {\n            if (document.activeElement instanceof HTMLElement) {\n                document.activeElement.blur();\n            }\n        }\n    }, [visible]);\n\n    let buttonText = 'Перейти к оплате';\n    if (!name) {\n        buttonText = 'Укажите имя';\n    } else if (!phone) {\n        buttonText = 'Укажите телефон';\n    } else if (!email) {\n        buttonText = 'Укажите email';\n    } else if (!address) {\n        buttonText = 'Укажите адрес доставки';\n    } else if (isPaymentInProgress) {\n        buttonText = 'Оплата…';\n    }\n\n    return (\n        <div className={className} onTouchStart={onTouchStart}>\n            <div ref={contentRef} className={styles.content}>\n                <div className={styles.title}>Заказ билетов с доставкой</div>\n                <CheckoutEventInfo className={styles.event} event={event} ticket={ticket} />\n                <form ref={formRef} action=\"\" onSubmit={onBuyTicket}>\n                    <CheckoutTextInput\n                        className={styles.input}\n                        label=\"Имя и фамилия\"\n                        name=\"full_name\"\n                        value={name}\n                        onChange={setName}\n                        onFocus={onInputFocus}\n                        required\n                    />\n                    <CheckoutTextInput\n                        className={styles.input}\n                        label=\"Телефон\"\n                        type=\"tel\"\n                        value={phone}\n                        onChange={setPhone}\n                        required\n                    />\n                    <CheckoutTextInput\n                        className={styles.input}\n                        label=\"Email адрес\"\n                        type=\"email\"\n                        value={email}\n                        onChange={setEmail}\n                        onFocus={onInputFocus}\n                        required\n                    />\n                    <CheckoutTextInput\n                        className={styles.input}\n                        label=\"Адрес доставки\"\n                        type=\"address\"\n                        value={address}\n                        onChange={setAddress}\n                        onFocus={onInputFocus}\n                        required\n                    />\n                    <ActionButton\n                        type=\"submit\"\n                        className={styles.button}\n                        formInvalid={!formRef.current?.checkValidity()}\n                        disabled={isPaymentInProgress || isOrderCreationInProgress}\n                    >\n                        {buttonText}\n                    </ActionButton>\n                </form>\n            </div>\n        </div>\n    );\n};\n\nexport default CheckoutModal;\n","import React, { useCallback, useRef, useState, useEffect, MutableRefObject } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createPortal } from 'react-dom';\n\nimport { Ticket } from '../../../../lib/api/fragments/ticket';\nimport { isIOS } from '../../../../lib/is-ios';\n\nimport { Event } from '../../../../redux/slices/event';\nimport { checkoutEnd, checkoutInProgressSelector, createOrder } from '../../../../redux/slices/order';\n\nimport ActionButton from '../../../../components/ActionButton';\nimport TicketPrice from '../../../../components/TicketPrice';\nimport { useScreenRef } from '../../../../components/StackNavigator';\n\nimport { useScrollEffect } from '../../../../hooks/useScrollEffect';\n\nimport CheckoutModal from '../CheckoutModal';\n\nimport styles from './styles.module.css';\n\nconst StickyVisibleClasses = {\n    Yes: styles['sticky-visible_yes'],\n    No: styles['sticky-visible_no'],\n};\n\ntype ButtonProps = {\n    ticket: Ticket;\n    disabled?: boolean;\n    onClick: () => void;\n};\nconst Button: React.FC<ButtonProps> = ({ ticket, disabled, onClick }) => (\n    <ActionButton className={styles.button} disabled={disabled} onClick={onClick}>\n        Билеты <TicketPrice ticket={ticket} />\n    </ActionButton>\n);\n\nconst isElementOutOfViewport = (ref: React.MutableRefObject<HTMLDivElement | null>) =>\n    Number(ref.current?.getBoundingClientRect()?.top) < 0;\n\ntype Props = {\n    event: Event;\n};\nconst TicketButton: React.FC<Props> = ({ event }) => {\n    const dispatch = useDispatch();\n\n    const paymentButtonRef = useRef<HTMLDivElement | null>(null);\n    const screenRef = useScreenRef();\n    const documentRef = useRef(document);\n    const scrollableRef: MutableRefObject<EventTarget | null> = isIOS() ? documentRef : screenRef;\n\n    const [stickyVisibleClass, setStickyVisibleClass] = useState<string>('');\n    const [screenNode, setScreenNode] = useState(screenRef.current);\n\n    const isCheckoutInProgress = useSelector(checkoutInProgressSelector);\n\n    const onPaymentButtonClick = useCallback(() => {\n        dispatch(createOrder(event));\n    }, [dispatch, event]);\n\n    const onCheckoutClose = useCallback(() => {\n        dispatch(checkoutEnd());\n    }, [dispatch]);\n\n    const isStaticPaymentButtonVisible = useScrollEffect(scrollableRef, paymentButtonRef, isElementOutOfViewport);\n    const ticket = event.tickets?.[0];\n\n    useEffect(() => {\n        if (!paymentButtonRef.current || !ticket) {\n            return;\n        }\n\n        if (!isStaticPaymentButtonVisible && stickyVisibleClass !== StickyVisibleClasses.Yes) {\n            return;\n        }\n\n        const stickyButtonVisibleClass = isStaticPaymentButtonVisible ?\n            StickyVisibleClasses.Yes :\n            StickyVisibleClasses.No;\n\n        setStickyVisibleClass(stickyButtonVisibleClass);\n    }, [paymentButtonRef, isStaticPaymentButtonVisible, ticket, stickyVisibleClass]);\n\n    useEffect(() => {\n        setScreenNode(screenRef.current);\n    }, [screenRef]);\n\n    useEffect(() => {\n        // Закрываем форму чекаута при удалении компонента.\n        return () => {\n            onCheckoutClose();\n        };\n    }, [onCheckoutClose]);\n\n    if (!ticket) {\n        return null;\n    }\n\n    return (\n        <>\n            <div className={styles.static} ref={paymentButtonRef}>\n                <Button ticket={ticket} onClick={onPaymentButtonClick} />\n            </div>\n            <div className={[styles.sticky, stickyVisibleClass].join(' ')}>\n                <Button ticket={ticket} onClick={onPaymentButtonClick} />\n            </div>\n            {screenNode &&\n                createPortal(\n                    <CheckoutModal\n                        event={event}\n                        ticket={ticket}\n                        visible={isCheckoutInProgress}\n                        onClose={onCheckoutClose}\n                    />,\n                    screenNode\n                )}\n        </>\n    );\n};\n\nexport default TicketButton;\n","type StaticMapUrlOptions = {\n    size: [number, number];\n    z: number;\n    ll?: [number, number];\n    pt?: [number, number, 'pm2rdl'];\n};\n\nexport function getStaticMapUrl(options: StaticMapUrlOptions) {\n    const params = new URLSearchParams({ l: 'map' });\n\n    for (const [key, value] of Object.entries(options)) {\n        params.set(key, String(value));\n    }\n\n    return `//static-maps.yandex.ru/1.x/?${params}`;\n}\n","import React, { Suspense, MouseEvent, useMemo, lazy } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { Coordinates } from '../../lib/api/fragments/coordinates';\nimport { Metro } from '../../lib/api/fragments/metro';\n\nimport styles from './styles.module.css';\n\nconst Map = lazy(() =>\n    import(\n        /* webpackChunkName: \"ya-map-modal\" */\n        './Map'\n    )\n);\n\ntype Props = {\n    onBackClick: (e: MouseEvent<HTMLButtonElement>) => void;\n    coordinates: Coordinates;\n    address: string | null;\n    metro: Metro[] | null;\n};\n\nconst MetroStation: React.FC<Metro> = props => {\n    return (\n        <div className={styles.station}>\n            {props.colors.map(color => {\n                return <div style={{ backgroundColor: color }} key={color} className={styles['metro-point']} />;\n            })}\n            {props.name}\n        </div>\n    );\n};\n\nconst YaMapModal: React.FC<Props> = props => {\n    const { coordinates, metro, address } = props;\n    const place = useMemo<[number, number]>(() => [coordinates.longitude, coordinates.latitude], [coordinates]);\n\n    return createPortal(\n        <div className={styles.modal}>\n            <div className={styles.close}>\n                <button className={styles['close-button']} onClick={props.onBackClick}>\n                    Назад\n                </button>\n            </div>\n            <Suspense fallback={null}>\n                <Map point={place} />\n            </Suspense>\n            {(metro || address) && (\n                <div className={styles['metro-containter']}>\n                    {metro && metro.map(station => <MetroStation key={station.name} {...station} />)}\n                    {address}\n                </div>\n            )}\n        </div>,\n        document.body\n    );\n};\n\nexport default YaMapModal;\n","import React, { useCallback, useState } from 'react';\n\nimport { Coordinates } from '../../lib/api/fragments/coordinates';\nimport { Metro } from '../../lib/api/fragments/metro';\n\nimport { getStaticMapUrl } from '../../lib/maps';\n\nimport YaMapModal from '../YaMapModal';\nimport Image from '../Image';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    coordinates: Coordinates;\n    metro: Metro[] | null;\n    address: string | null;\n};\n\nconst YaMapWidget: React.FC<Props> = props => {\n    const staticMapImage = {\n        url: getStaticMapUrl({\n            size: [650, 176],\n            z: 16,\n            pt: [props.coordinates.longitude, props.coordinates.latitude, 'pm2rdl'],\n        }),\n        width: 650,\n        height: 176,\n    };\n\n    const [isModalOpen, setModalOpen] = useState(false);\n\n    const onMapClick = useCallback(() => {\n        setModalOpen(true);\n\n        document.body.style.overflow = 'hidden';\n    }, []);\n\n    const onBackClick = useCallback(() => {\n        setModalOpen(false);\n\n        document.body.style.overflow = 'auto';\n    }, []);\n\n    return (\n        <>\n            <div onClick={onMapClick}>\n                <Image className={styles.map} src={staticMapImage} />\n            </div>\n            {isModalOpen && <YaMapModal {...props} onBackClick={onBackClick} />}\n        </>\n    );\n};\n\nexport default YaMapWidget;\n","import React from 'react';\n\nimport YaMapWidget from '../../../../components/YaMapWidget';\nimport { ScheduleInfo } from '../../../../redux/slices/event';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    schedule: Partial<ScheduleInfo>;\n};\n\nconst VenueInfo: React.FC<Props> = ({ schedule }) => {\n    const { oneOfPlaces, placePreview } = schedule;\n\n    if (!oneOfPlaces || !oneOfPlaces.coordinates) {\n        return <div className={styles.title}>{placePreview}</div>;\n    }\n\n    return (\n        <>\n            <YaMapWidget\n                coordinates={oneOfPlaces.coordinates}\n                metro={oneOfPlaces.metro}\n                address={oneOfPlaces.address}\n            />\n            <div className={styles.title}>{oneOfPlaces.title}</div>\n            <div className={styles.address}>{oneOfPlaces.address}</div>\n        </>\n    );\n};\n\nexport default VenueInfo;\n","import React, { useEffect, Suspense, ReactElement, ReactNode } from 'react';\n\nimport LazyRender from '../LazyRender';\n\ntype Props = {\n    children: ReactNode;\n    fetchData?: () => void;\n    skeleton?: ReactElement;\n};\n\nconst LazyBlock: React.FC<Props> = ({ children, skeleton, fetchData }) => {\n    return (\n        <LazyRender skeleton={skeleton}>\n            <Inner children={children} skeleton={skeleton} fetchData={fetchData} />\n        </LazyRender>\n    );\n};\n\nconst Inner: React.FC<Props> = ({ children, skeleton, fetchData }) => {\n    useEffect(() => {\n        fetchData && fetchData();\n    }, [fetchData]);\n\n    return <Suspense fallback={skeleton || null}>{children}</Suspense>;\n};\n\nexport default LazyBlock;\n","import React, { memo } from 'react';\n\nimport { lazyDeferred } from '../../../../lib/lazy';\n\nimport LazyBlock from '../../../../components/LazyBlock';\nimport RecommendedEventsSkeleton from './Skeleton';\n\nconst Component = lazyDeferred(() =>\n    import(\n        /* webpackChunkName: \"recommended-events\" */\n        './Component'\n    )\n);\n\nconst RecommendedEventsLazyBlock: React.FC = () => {\n    return (\n        <LazyBlock skeleton={<RecommendedEventsSkeleton />}>\n            <Component skeleton={<RecommendedEventsSkeleton />} />\n        </LazyBlock>\n    );\n};\n\nexport default memo(RecommendedEventsLazyBlock);\n","import React, { ReactElement, useRef, MutableRefObject, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { logProductView } from '../../lib/metrika/ecommerce';\nimport { RootState } from '../../redux';\nimport { Event, EventPage, ScheduleInfo } from '../../redux/slices/event';\n\nimport PageHeader from '../../components/PageHeader';\nimport Gallery from '../../components/Gallery';\nimport CollapsedText from '../../components/CollapsedText';\n\nimport { useScreenRef, useScreenVisible } from '../../components/StackNavigator';\nimport { useMetrikaHit } from '../../hooks/useMetrikaHit';\nimport { useScrollEffect } from '../../hooks/useScrollEffect';\nimport { isIOS } from '../../lib/is-ios';\nimport Title from './components/Title';\nimport ContentBlock from './components/ContentBlock';\nimport Cover from './components/Cover';\nimport TicketButton from './components/TicketButton';\nimport VenueInfo from './components/VenueInfo';\nimport RecommendedEventsLazyBlock from './components/RecommendedEvents';\n\nimport styles from './styles.module.css';\n\ntype Props = {\n    id: string;\n    skeleton: ReactElement;\n};\n\nconst isScrollAtTop = (ref: React.MutableRefObject<HTMLDivElement | null>) => {\n    if (isIOS()) {\n        return window.scrollY <= 0;\n    }\n\n    return !ref.current || ref.current?.scrollTop <= 0;\n};\n\nconst Component: React.FC<Props> = ({ id, skeleton }) => {\n    const mainImageRef = useRef<HTMLDivElement | null>(null);\n    const screenRef = useScreenRef();\n    const documentRef = useRef(document);\n    const scrollableRef: MutableRefObject<EventTarget | null> = isIOS() ? documentRef : screenRef;\n    const isVisible = useScreenVisible();\n\n    const eventPage: Partial<EventPage> = useSelector((state: RootState) => state.event.data[id]) || {};\n    const event = (eventPage.event || {}) as Event;\n    const schedule = (eventPage.schedule || {}) as ScheduleInfo;\n    const isLoading = !event.id;\n\n    const { images, description, type, tickets } = event;\n    const { preview } = schedule;\n    const ticket = tickets && tickets[0];\n\n    const isPageHeaderClear = useScrollEffect(scrollableRef, screenRef, isScrollAtTop);\n\n    useMetrikaHit();\n\n    useEffect(() => {\n        if (isVisible) {\n            logProductView(event);\n        }\n    }, [isVisible, event]);\n\n    if (isLoading) {\n        return skeleton;\n    }\n\n    return (\n        <>\n            <PageHeader\n                mods={isPageHeaderClear ? 'clear' : ''}\n                backward={isPageHeaderClear ? 'white' : 'black'}\n                hasLogo={false}\n                hasMenu={false}\n            />\n\n            <Cover event={event} imageRef={mainImageRef} />\n\n            <div className={styles.wrapper}>\n                <TicketButton event={event} />\n\n                {type && <div className={styles.city}>{type.name} в Москве</div>}\n                {preview && <div className={styles.schedule}>{preview.text}</div>}\n\n                <ContentBlock>\n                    <VenueInfo schedule={schedule} />\n                </ContentBlock>\n\n                {images && images.length > 0 && (\n                    <ContentBlock>\n                        <Title>Фотогалерея</Title>\n                        <Gallery items={images} />\n                    </ContentBlock>\n                )}\n\n                {description && (\n                    <ContentBlock>\n                        <Title>Описание</Title>\n                        <CollapsedText lines={5} className={styles.description} fullTextLabel={'Полное описание'}>\n                            {description}\n                        </CollapsedText>\n                    </ContentBlock>\n                )}\n\n                <RecommendedEventsLazyBlock />\n\n                {ticket && <div className={styles.placeholder} />}\n            </div>\n        </>\n    );\n};\n\nexport default Component;\n"],"sourceRoot":""}